; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23506.0 

	TITLE	C:\Users\Michel\Desktop\Source\GameServer\Source\DarkSpirit.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	??_H@YGXPAXIIP6EPAX0@Z@Z			; `vector constructor iterator'
PUBLIC	?__empty_global_delete@@YAXPAX@Z		; __empty_global_delete
PUBLIC	?__empty_global_delete@@YAXPAXI@Z		; __empty_global_delete
PUBLIC	??1OBJECTSTRUCT@@QAE@XZ				; OBJECTSTRUCT::~OBJECTSTRUCT
PUBLIC	??_EOBJECTSTRUCT@@QAEPAXI@Z			; OBJECTSTRUCT::`vector deleting destructor'
PUBLIC	??0CDarkSpirit@@QAE@XZ				; CDarkSpirit::CDarkSpirit
PUBLIC	??1CDarkSpirit@@UAE@XZ				; CDarkSpirit::~CDarkSpirit
PUBLIC	?Init@CDarkSpirit@@QAEXXZ			; CDarkSpirit::Init
PUBLIC	?Run@CDarkSpirit@@QAEXXZ			; CDarkSpirit::Run
PUBLIC	?ModeNormal@CDarkSpirit@@QAEXXZ			; CDarkSpirit::ModeNormal
PUBLIC	?ModeAttackRandom@CDarkSpirit@@QAEXXZ		; CDarkSpirit::ModeAttackRandom
PUBLIC	?ModeAttackWithMaster@CDarkSpirit@@QAEXXZ	; CDarkSpirit::ModeAttackWithMaster
PUBLIC	?ModeAttakTarget@CDarkSpirit@@QAEXXZ		; CDarkSpirit::ModeAttakTarget
PUBLIC	?SetTarget@CDarkSpirit@@QAEXH@Z			; CDarkSpirit::SetTarget
PUBLIC	?ReSetTarget@CDarkSpirit@@QAEXH@Z		; CDarkSpirit::ReSetTarget
PUBLIC	?Set@CDarkSpirit@@QAEXHPAVCItem@@@Z		; CDarkSpirit::Set
PUBLIC	?SetMode@CDarkSpirit@@QAEXW4ePetItem_Mode@1@H@Z	; CDarkSpirit::SetMode
PUBLIC	?Attack@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0PAVCMagicInf@@HH@Z ; CDarkSpirit::Attack
PUBLIC	?GetAttackDamage@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@HHHH@Z ; CDarkSpirit::GetAttackDamage
PUBLIC	?MissCheck@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0HHAAH@Z ; CDarkSpirit::MissCheck
PUBLIC	?MissCheckPvP@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0HHAAH@Z ; CDarkSpirit::MissCheckPvP
PUBLIC	?ChangeCommand@CDarkSpirit@@QAEXHH@Z		; CDarkSpirit::ChangeCommand
PUBLIC	?RangeAttack@CDarkSpirit@@QAEXHH@Z		; CDarkSpirit::RangeAttack
PUBLIC	?SendAttackMsg@CDarkSpirit@@QAEXHHHH@Z		; CDarkSpirit::SendAttackMsg
PUBLIC	?GetShieldDamage@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0H@Z ; CDarkSpirit::GetShieldDamage
PUBLIC	?SendLevelmsg@CDarkSpirit@@SAXHHHH@Z		; CDarkSpirit::SendLevelmsg
PUBLIC	??_GCDarkSpirit@@UAEPAXI@Z			; CDarkSpirit::`scalar deleting destructor'
PUBLIC	??_7CDarkSpirit@@6B@				; CDarkSpirit::`vftable'
PUBLIC	?gDarkSpirit@@3PAVCDarkSpirit@@A		; gDarkSpirit
PUBLIC	??_C@_0DL@HDCMLJGF@?$FL?$CFs?$FN?$FL?$CFs?$FN?$FLPetItemExpDown?$FN?5?$FL?$CFs?$FN?5Le@ ; `string'
PUBLIC	??_C@_0EI@EDGOCDCM@?$FL?$CFs?$FN?$FL?$CFs?$FN?5DarkSpirit?5Item?5is?5Brok@ ; `string'
PUBLIC	??_C@_0IE@HMIJIHBA@?$FLJewelOfHarmony?$FN?$FLPvP?5System?$FN?5Att@ ; `string'
PUBLIC	??_R4CDarkSpirit@@6B@				; CDarkSpirit::`RTTI Complete Object Locator'
PUBLIC	??_R0?AVCDarkSpirit@@@8				; CDarkSpirit `RTTI Type Descriptor'
PUBLIC	??_R3CDarkSpirit@@8				; CDarkSpirit::`RTTI Class Hierarchy Descriptor'
PUBLIC	??_R2CDarkSpirit@@8				; CDarkSpirit::`RTTI Base Class Array'
PUBLIC	??_R1A@?0A@EA@CDarkSpirit@@8			; CDarkSpirit::`RTTI Base Class Descriptor at (0,-1,0,64)'
PUBLIC	??_R1A@?0A@EA@CObjBaseAttack@@8			; CObjBaseAttack::`RTTI Base Class Descriptor at (0,-1,0,64)'
PUBLIC	??_R0?AVCObjBaseAttack@@@8			; CObjBaseAttack `RTTI Type Descriptor'
PUBLIC	??_R3CObjBaseAttack@@8				; CObjBaseAttack::`RTTI Class Hierarchy Descriptor'
PUBLIC	??_R2CObjBaseAttack@@8				; CObjBaseAttack::`RTTI Base Class Array'
PUBLIC	__real@00000000
PUBLIC	__real@3f800000
PUBLIC	__real@3fc00000
PUBLIC	__real@41200000
PUBLIC	__real@41a00000
PUBLIC	__real@42c80000
PUBLIC	__real@44480000
PUBLIC	__real@461c4000
EXTRN	??_L@YGXPAXIIP6EX0@Z1@Z:PROC			; `eh vector constructor iterator'
EXTRN	??_M@YGXPAXIIP6EX0@Z@Z:PROC			; `eh vector destructor iterator'
EXTRN	??3@YAXPAXI@Z:PROC				; operator delete
EXTRN	??_V@YAXPAXI@Z:PROC				; operator delete[]
EXTRN	_atexit:PROC
EXTRN	__imp__GetTickCount@0:PROC
EXTRN	_rand:PROC
EXTRN	?DecPetItemExp@CItem@@QAEHH@Z:PROC		; CItem::DecPetItemExp
EXTRN	?GetName@CItem@@QAEPADXZ:PROC			; CItem::GetName
EXTRN	?IsDinorantReduceAttackDamaege@CItem@@QAEHXZ:PROC ; CItem::IsDinorantReduceAttackDamaege
EXTRN	??1CSkillDelay@@UAE@XZ:PROC			; CSkillDelay::~CSkillDelay
EXTRN	?DataSend@@YAHHPAEK@Z:PROC			; DataSend
EXTRN	?GensMap@CGensSystem@@QAEHH@Z:PROC		; CGensSystem::GensMap
EXTRN	??1TMonsterAIAgro@@UAE@XZ:PROC			; TMonsterAIAgro::~TMonsterAIAgro
EXTRN	?IncAgro@TMonsterAIAgro@@QAEHHH@Z:PROC		; TMonsterAIAgro::IncAgro
EXTRN	?GetAttr@MapClass@@QAEEHH@Z:PROC		; MapClass::GetAttr
EXTRN	?MsgSendV2@@YAXPAUOBJECTSTRUCT@@PAEH@Z:PROC	; MsgSendV2
EXTRN	?GCDamageSend@@YAXHHHHHH@Z:PROC			; GCDamageSend
EXTRN	?GCMagicAttackNumberSend@@YAXPAUOBJECTSTRUCT@@GHE@Z:PROC ; GCMagicAttackNumberSend
EXTRN	?GCMagicCancelSend@@YAXPAUOBJECTSTRUCT@@H@Z:PROC ; GCMagicCancelSend
EXTRN	?GCReFillSend@@YAXHGEEG@Z:PROC			; GCReFillSend
EXTRN	?GCManaSend@@YAXHFEEG@Z:PROC			; GCManaSend
EXTRN	?GCItemDurSend@@YAXHEEE@Z:PROC			; GCItemDurSend
EXTRN	?GCSendEffectInfo@@YAXHE@Z:PROC			; GCSendEffectInfo
EXTRN	?gObjIsConnected@@YAHPAUOBJECTSTRUCT@@@Z:PROC	; gObjIsConnected
EXTRN	?gObjCalDistance@@YAHPAUOBJECTSTRUCT@@0@Z:PROC	; gObjCalDistance
EXTRN	?gObjAddMsgSendDelay@@YAXPAUOBJECTSTRUCT@@HHHH@Z:PROC ; gObjAddMsgSendDelay
EXTRN	?gObjAddAttackProcMsgSendDelay@@YAXPAUOBJECTSTRUCT@@HHHHH@Z:PROC ; gObjAddAttackProcMsgSendDelay
EXTRN	?gObjAttackQ@@YAHPAUOBJECTSTRUCT@@@Z:PROC	; gObjAttackQ
EXTRN	?gObjAngelSprite@@YAHPAUOBJECTSTRUCT@@@Z:PROC	; gObjAngelSprite
EXTRN	?gObjWingSprite@@YAHPAUOBJECTSTRUCT@@@Z:PROC	; gObjWingSprite
EXTRN	?gObjUniriaSprite@@YAHPAUOBJECTSTRUCT@@@Z:PROC	; gObjUniriaSprite
EXTRN	?gObjArmorRandomDurDown@@YAXPAUOBJECTSTRUCT@@0@Z:PROC ; gObjArmorRandomDurDown
EXTRN	?gObjCheckSelfDefense@@YAXPAUOBJECTSTRUCT@@H@Z:PROC ; gObjCheckSelfDefense
EXTRN	?gObjLifeCheck@@YAXPAUOBJECTSTRUCT@@0HHHHGH@Z:PROC ; gObjLifeCheck
EXTRN	?gObjTargetGuildWarCheck@@YAHPAUOBJECTSTRUCT@@0@Z:PROC ; gObjTargetGuildWarCheck
EXTRN	?gObjDuelCheck@@YAHPAUOBJECTSTRUCT@@0@Z:PROC	; gObjDuelCheck
EXTRN	?gObjGetRelationShip@@YAHPAUOBJECTSTRUCT@@0@Z:PROC ; gObjGetRelationShip
EXTRN	?gObjWeaponDurDownInCastle@@YAXPAUOBJECTSTRUCT@@0H@Z:PROC ; gObjWeaponDurDownInCastle
EXTRN	??0CObjBaseAttack@@QAE@XZ:PROC			; CObjBaseAttack::CObjBaseAttack
EXTRN	??1CObjBaseAttack@@UAE@XZ:PROC			; CObjBaseAttack::~CObjBaseAttack
EXTRN	?CheckAttackArea@CObjBaseAttack@@QAEHPAUOBJECTSTRUCT@@0@Z:PROC ; CObjBaseAttack::CheckAttackArea
EXTRN	?PkCheck@CObjBaseAttack@@QAEHPAUOBJECTSTRUCT@@0@Z:PROC ; CObjBaseAttack::PkCheck
EXTRN	?GetTargetDefense@CObjBaseAttack@@QAEHPAUOBJECTSTRUCT@@0AAH@Z:PROC ; CObjBaseAttack::GetTargetDefense
EXTRN	?MissCheck@CObjBaseAttack@@UAEHPAUOBJECTSTRUCT@@0HHHAAHE@Z:PROC ; CObjBaseAttack::MissCheck
EXTRN	??_ECDarkSpirit@@UAEPAXI@Z:PROC			; CDarkSpirit::`vector deleting destructor'
EXTRN	?GetPartyPkLevel@PartyClass@@QAEDH@Z:PROC	; PartyClass::GetPartyPkLevel
EXTRN	?GetBattleSoccerGoalMove@@YAHH@Z:PROC		; GetBattleSoccerGoalMove
EXTRN	?gObjMonsterStateProc@@YAXPAUOBJECTSTRUCT@@HHH@Z:PROC ; gObjMonsterStateProc
EXTRN	?gObjDenorantSprite@@YAHPAUOBJECTSTRUCT@@@Z:PROC ; gObjDenorantSprite
EXTRN	?gObjDarkHorse@@YAHPAUOBJECTSTRUCT@@@Z:PROC	; gObjDarkHorse
EXTRN	?GetCastleState@CCastleSiege@@QAEHXZ:PROC	; CCastleSiege::GetCastleState
EXTRN	?gObjRemoveBuffEffect@@YA_NPAUOBJECTSTRUCT@@H@Z:PROC ; gObjRemoveBuffEffect
EXTRN	?gObjCheckUsedBuffEffect@@YA_NPAUOBJECTSTRUCT@@H@Z:PROC ; gObjCheckUsedBuffEffect
EXTRN	?gObjGetValueOfBuffIndex@@YA_NPAUOBJECTSTRUCT@@HPAH1@Z:PROC ; gObjGetValueOfBuffIndex
EXTRN	?GetState@CIllusionTempleEvent@@QAEEE@Z:PROC	; CIllusionTempleEvent::GetState
EXTRN	?Is1stSkillActive@CIllusionTempleEvent@@QAEHHE@Z:PROC ; CIllusionTempleEvent::Is1stSkillActive
EXTRN	?IsAttackAbleMonster@CImperialGuardian@@QAE_NH@Z:PROC ; CImperialGuardian::IsAttackAbleMonster
EXTRN	?GetAttackRate@ClassCalc@@QAEMPAUOBJECTSTRUCT@@@Z:PROC ; ClassCalc::GetAttackRate
EXTRN	?GetDefenseRate@ClassCalc@@QAEMPAUOBJECTSTRUCT@@@Z:PROC ; ClassCalc::GetDefenseRate
EXTRN	@__security_check_cookie@4:PROC
EXTRN	___CxxFrameHandler3:PROC
EXTRN	__except_handler4:PROC
EXTRN	??_7type_info@@6B@:QWORD			; type_info::`vftable'
EXTRN	?LogAddTD@@3P6AXPADZZA:DWORD			; LogAddTD
EXTRN	?gGensSystem@@3VCGensSystem@@A:BYTE		; gGensSystem
EXTRN	?gObj@@3PAUOBJECTSTRUCT@@A:DWORD		; gObj
EXTRN	?MapC@@3PAVMapClass@@A:BYTE			; MapC
EXTRN	?gParty@@3VPartyClass@@A:BYTE			; gParty
EXTRN	?g_ShieldSystemOn@@3HA:DWORD			; g_ShieldSystemOn
EXTRN	?g_iDamageDevideToSDRate@@3HA:DWORD		; g_iDamageDevideToSDRate
EXTRN	?g_fSuccessAttackRateOption@@3MA:DWORD		; g_fSuccessAttackRateOption
EXTRN	?g_CastleSiege@@3VCCastleSiege@@A:BYTE		; g_CastleSiege
EXTRN	?g_Crywolf@@3VCCrywolf@@A:BYTE			; g_Crywolf
EXTRN	?g_IllusionTemple@@3VCIllusionTempleEvent@@A:BYTE ; g_IllusionTemple
EXTRN	?g_ImperialGuardian@@3VCImperialGuardian@@A:BYTE ; g_ImperialGuardian
EXTRN	?g_ClassCalc@@3VClassCalc@@A:BYTE		; g_ClassCalc
EXTRN	___security_cookie:DWORD
EXTRN	__fltused:DWORD
_BSS	SEGMENT
?gDarkSpirit@@3PAVCDarkSpirit@@A DB 086c40H DUP (?)	; gDarkSpirit
_BSS	ENDS
CRT$XCU	SEGMENT
?gDarkSpirit$initializer$@@3P6AXXZA DD FLAT:??__EgDarkSpirit@@YAXXZ ; gDarkSpirit$initializer$
CRT$XCU	ENDS
;	COMDAT __real@461c4000
CONST	SEGMENT
__real@461c4000 DD 0461c4000r			; 10000
CONST	ENDS
;	COMDAT __real@44480000
CONST	SEGMENT
__real@44480000 DD 044480000r			; 800
CONST	ENDS
;	COMDAT __real@42c80000
CONST	SEGMENT
__real@42c80000 DD 042c80000r			; 100
CONST	ENDS
;	COMDAT __real@41a00000
CONST	SEGMENT
__real@41a00000 DD 041a00000r			; 20
CONST	ENDS
;	COMDAT __real@41200000
CONST	SEGMENT
__real@41200000 DD 041200000r			; 10
CONST	ENDS
;	COMDAT __real@3fc00000
CONST	SEGMENT
__real@3fc00000 DD 03fc00000r			; 1.5
CONST	ENDS
;	COMDAT __real@3f800000
CONST	SEGMENT
__real@3f800000 DD 03f800000r			; 1
CONST	ENDS
;	COMDAT __real@00000000
CONST	SEGMENT
__real@00000000 DD 000000000r			; 0
CONST	ENDS
;	COMDAT ??_R2CObjBaseAttack@@8
rdata$r	SEGMENT
??_R2CObjBaseAttack@@8 DD FLAT:??_R1A@?0A@EA@CObjBaseAttack@@8 ; CObjBaseAttack::`RTTI Base Class Array'
rdata$r	ENDS
;	COMDAT ??_R3CObjBaseAttack@@8
rdata$r	SEGMENT
??_R3CObjBaseAttack@@8 DD 00H				; CObjBaseAttack::`RTTI Class Hierarchy Descriptor'
	DD	00H
	DD	01H
	DD	FLAT:??_R2CObjBaseAttack@@8
rdata$r	ENDS
;	COMDAT ??_R0?AVCObjBaseAttack@@@8
data$r	SEGMENT
??_R0?AVCObjBaseAttack@@@8 DD FLAT:??_7type_info@@6B@	; CObjBaseAttack `RTTI Type Descriptor'
	DD	00H
	DB	'.?AVCObjBaseAttack@@', 00H
data$r	ENDS
;	COMDAT ??_R1A@?0A@EA@CObjBaseAttack@@8
rdata$r	SEGMENT
??_R1A@?0A@EA@CObjBaseAttack@@8 DD FLAT:??_R0?AVCObjBaseAttack@@@8 ; CObjBaseAttack::`RTTI Base Class Descriptor at (0,-1,0,64)'
	DD	00H
	DD	00H
	DD	0ffffffffH
	DD	00H
	DD	040H
	DD	FLAT:??_R3CObjBaseAttack@@8
rdata$r	ENDS
;	COMDAT ??_R1A@?0A@EA@CDarkSpirit@@8
rdata$r	SEGMENT
??_R1A@?0A@EA@CDarkSpirit@@8 DD FLAT:??_R0?AVCDarkSpirit@@@8 ; CDarkSpirit::`RTTI Base Class Descriptor at (0,-1,0,64)'
	DD	01H
	DD	00H
	DD	0ffffffffH
	DD	00H
	DD	040H
	DD	FLAT:??_R3CDarkSpirit@@8
rdata$r	ENDS
;	COMDAT ??_R2CDarkSpirit@@8
rdata$r	SEGMENT
??_R2CDarkSpirit@@8 DD FLAT:??_R1A@?0A@EA@CDarkSpirit@@8 ; CDarkSpirit::`RTTI Base Class Array'
	DD	FLAT:??_R1A@?0A@EA@CObjBaseAttack@@8
rdata$r	ENDS
;	COMDAT ??_R3CDarkSpirit@@8
rdata$r	SEGMENT
??_R3CDarkSpirit@@8 DD 00H				; CDarkSpirit::`RTTI Class Hierarchy Descriptor'
	DD	00H
	DD	02H
	DD	FLAT:??_R2CDarkSpirit@@8
rdata$r	ENDS
;	COMDAT ??_R0?AVCDarkSpirit@@@8
data$r	SEGMENT
??_R0?AVCDarkSpirit@@@8 DD FLAT:??_7type_info@@6B@	; CDarkSpirit `RTTI Type Descriptor'
	DD	00H
	DB	'.?AVCDarkSpirit@@', 00H
data$r	ENDS
;	COMDAT ??_R4CDarkSpirit@@6B@
rdata$r	SEGMENT
??_R4CDarkSpirit@@6B@ DD 00H				; CDarkSpirit::`RTTI Complete Object Locator'
	DD	00H
	DD	00H
	DD	FLAT:??_R0?AVCDarkSpirit@@@8
	DD	FLAT:??_R3CDarkSpirit@@8
rdata$r	ENDS
;	COMDAT ??_C@_0IE@HMIJIHBA@?$FLJewelOfHarmony?$FN?$FLPvP?5System?$FN?5Att@
CONST	SEGMENT
??_C@_0IE@HMIJIHBA@?$FLJewelOfHarmony?$FN?$FLPvP?5System?$FN?5Att@ DB '[J'
	DB	'ewelOfHarmony][PvP System] Attacker:[%s][%s]-SD Decrease[%d] '
	DB	'SD Ignore[%d] Defender:[%s][%s] SD Increase Option[%d] - SD R'
	DB	'ate[%d]', 00H				; `string'
CONST	ENDS
;	COMDAT ??_C@_0EI@EDGOCDCM@?$FL?$CFs?$FN?$FL?$CFs?$FN?5DarkSpirit?5Item?5is?5Brok@
CONST	SEGMENT
??_C@_0EI@EDGOCDCM@?$FL?$CFs?$FN?$FL?$CFs?$FN?5DarkSpirit?5Item?5is?5Brok@ DB '['
	DB	'%s][%s] DarkSpirit Item is Broken because durability is exhau'
	DB	'sted [%d]', 00H				; `string'
CONST	ENDS
;	COMDAT ??_C@_0DL@HDCMLJGF@?$FL?$CFs?$FN?$FL?$CFs?$FN?$FLPetItemExpDown?$FN?5?$FL?$CFs?$FN?5Le@
CONST	SEGMENT
??_C@_0DL@HDCMLJGF@?$FL?$CFs?$FN?$FL?$CFs?$FN?$FLPetItemExpDown?$FN?5?$FL?$CFs?$FN?5Le@ DB '['
	DB	'%s][%s][PetItemExpDown] [%s] Level:[%d]Exp:[%d]DecExp[%d]', 00H ; `string'
CONST	ENDS
;	COMDAT ??_7CDarkSpirit@@6B@
CONST	SEGMENT
??_7CDarkSpirit@@6B@ DD FLAT:??_R4CDarkSpirit@@6B@	; CDarkSpirit::`vftable'
	DD	FLAT:??_ECDarkSpirit@@UAEPAXI@Z
	DD	FLAT:?MissCheck@CObjBaseAttack@@UAEHPAUOBJECTSTRUCT@@0HHHAAHE@Z
CONST	ENDS
;	COMDAT xdata$x
xdata$x	SEGMENT
__sehtable$?MissCheck@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0HHAAH@Z DD 0fffffffeH
	DD	00H
	DD	0ffffffd4H
	DD	00H
	DD	0fffffffeH
	DD	FLAT:$LN26@MissCheck
	DD	FLAT:$LN18@MissCheck
xdata$x	ENDS
;	COMDAT xdata$x
xdata$x	SEGMENT
__ehfuncinfo$??_EOBJECTSTRUCT@@QAEPAXI@Z DD 019930522H
	DD	00H
	DD	00H
	DD	2 DUP(00H)
	DD	2 DUP(00H)
	DD	00H
	DD	05H
xdata$x	ENDS
; Function compile flags: /Ogtp
;	COMDAT ??__FgDarkSpirit@@YAXXZ
text$yd	SEGMENT
??__FgDarkSpirit@@YAXXZ PROC				; `dynamic atexit destructor for 'gDarkSpirit'', COMDAT
  00000	68 00 00 00 00	 push	 OFFSET ??1CDarkSpirit@@UAE@XZ ; CDarkSpirit::~CDarkSpirit
  00005	68 ec 2c 00 00	 push	 11500			; 00002cecH
  0000a	6a 30		 push	 48			; 00000030H
  0000c	68 00 00 00 00	 push	 OFFSET ?gDarkSpirit@@3PAVCDarkSpirit@@A ; gDarkSpirit
  00011	e8 00 00 00 00	 call	 ??_M@YGXPAXIIP6EX0@Z@Z
  00016	c3		 ret	 0
??__FgDarkSpirit@@YAXXZ ENDP				; `dynamic atexit destructor for 'gDarkSpirit''
text$yd	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
;	COMDAT ??__EgDarkSpirit@@YAXXZ
text$di	SEGMENT
??__EgDarkSpirit@@YAXXZ PROC				; `dynamic initializer for 'gDarkSpirit'', COMDAT

; 26   : CDarkSpirit gDarkSpirit[OBJMAX];

  00000	68 00 00 00 00	 push	 OFFSET ??1CDarkSpirit@@UAE@XZ ; CDarkSpirit::~CDarkSpirit
  00005	68 00 00 00 00	 push	 OFFSET ??0CDarkSpirit@@QAE@XZ ; CDarkSpirit::CDarkSpirit
  0000a	68 ec 2c 00 00	 push	 11500			; 00002cecH
  0000f	6a 30		 push	 48			; 00000030H
  00011	68 00 00 00 00	 push	 OFFSET ?gDarkSpirit@@3PAVCDarkSpirit@@A ; gDarkSpirit
  00016	e8 00 00 00 00	 call	 ??_L@YGXPAXIIP6EX0@Z1@Z
  0001b	68 00 00 00 00	 push	 OFFSET ??__FgDarkSpirit@@YAXXZ ; `dynamic atexit destructor for 'gDarkSpirit''
  00020	e8 00 00 00 00	 call	 _atexit
  00025	59		 pop	 ecx
  00026	c3		 ret	 0
??__EgDarkSpirit@@YAXXZ ENDP				; `dynamic initializer for 'gDarkSpirit''
text$di	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h
;	COMDAT ?GetPetSuccessAttackRateStart@ClassCalc@@QAEHXZ
_TEXT	SEGMENT
?GetPetSuccessAttackRateStart@ClassCalc@@QAEHXZ PROC	; ClassCalc::GetPetSuccessAttackRateStart, COMDAT
; _this$ = ecx

; 122  : 		return this->m_Data[CLASS_DARKLORD].PetSuccessAttackRateStart;

  00000	0f b7 81 dc 01
	00 00		 movzx	 eax, WORD PTR [ecx+476]

; 123  : 	};

  00007	c3		 ret	 0
?GetPetSuccessAttackRateStart@ClassCalc@@QAEHXZ ENDP	; ClassCalc::GetPetSuccessAttackRateStart
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h
;	COMDAT ?GetPetSuccessAttackRateDiv@ClassCalc@@QAEHXZ
_TEXT	SEGMENT
?GetPetSuccessAttackRateDiv@ClassCalc@@QAEHXZ PROC	; ClassCalc::GetPetSuccessAttackRateDiv, COMDAT
; _this$ = ecx

; 118  : 		return this->m_Data[CLASS_DARKLORD].PetSuccessAttackRateDiv;

  00000	0f b7 81 da 01
	00 00		 movzx	 eax, WORD PTR [ecx+474]

; 119  : 	};

  00007	c3		 ret	 0
?GetPetSuccessAttackRateDiv@ClassCalc@@QAEHXZ ENDP	; ClassCalc::GetPetSuccessAttackRateDiv
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h
;	COMDAT ?GetPetAttackSpeedStart@ClassCalc@@QAEHXZ
_TEXT	SEGMENT
?GetPetAttackSpeedStart@ClassCalc@@QAEHXZ PROC		; ClassCalc::GetPetAttackSpeedStart, COMDAT
; _this$ = ecx

; 114  : 		return this->m_Data[CLASS_DARKLORD].PetAttackSpeedStart;

  00000	0f b7 81 d8 01
	00 00		 movzx	 eax, WORD PTR [ecx+472]

; 115  : 	};

  00007	c3		 ret	 0
?GetPetAttackSpeedStart@ClassCalc@@QAEHXZ ENDP		; ClassCalc::GetPetAttackSpeedStart
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h
;	COMDAT ?GetPetAttackSpeedDiv2@ClassCalc@@QAEHXZ
_TEXT	SEGMENT
?GetPetAttackSpeedDiv2@ClassCalc@@QAEHXZ PROC		; ClassCalc::GetPetAttackSpeedDiv2, COMDAT
; _this$ = ecx

; 110  : 		return this->m_Data[CLASS_DARKLORD].PetAttackSpeedDiv2;

  00000	0f b7 81 d6 01
	00 00		 movzx	 eax, WORD PTR [ecx+470]

; 111  : 	};

  00007	c3		 ret	 0
?GetPetAttackSpeedDiv2@ClassCalc@@QAEHXZ ENDP		; ClassCalc::GetPetAttackSpeedDiv2
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h
;	COMDAT ?GetPetAttackSpeedDiv1@ClassCalc@@QAEHXZ
_TEXT	SEGMENT
?GetPetAttackSpeedDiv1@ClassCalc@@QAEHXZ PROC		; ClassCalc::GetPetAttackSpeedDiv1, COMDAT
; _this$ = ecx

; 106  : 		return this->m_Data[CLASS_DARKLORD].PetAttackSpeedDiv1;

  00000	0f b7 81 d4 01
	00 00		 movzx	 eax, WORD PTR [ecx+468]

; 107  : 	};

  00007	c3		 ret	 0
?GetPetAttackSpeedDiv1@ClassCalc@@QAEHXZ ENDP		; ClassCalc::GetPetAttackSpeedDiv1
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h
;	COMDAT ?GetPetAttackSpeedFact@ClassCalc@@QAEHXZ
_TEXT	SEGMENT
?GetPetAttackSpeedFact@ClassCalc@@QAEHXZ PROC		; ClassCalc::GetPetAttackSpeedFact, COMDAT
; _this$ = ecx

; 102  : 		return this->m_Data[CLASS_DARKLORD].PetAttackSpeedFact;

  00000	0f b7 81 d2 01
	00 00		 movzx	 eax, WORD PTR [ecx+466]

; 103  : 	};

  00007	c3		 ret	 0
?GetPetAttackSpeedFact@ClassCalc@@QAEHXZ ENDP		; ClassCalc::GetPetAttackSpeedFact
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h
;	COMDAT ?GetPetCriticalAttackRate@ClassCalc@@QAEHXZ
_TEXT	SEGMENT
?GetPetCriticalAttackRate@ClassCalc@@QAEHXZ PROC	; ClassCalc::GetPetCriticalAttackRate, COMDAT
; _this$ = ecx

; 98   : 		return this->m_Data[CLASS_DARKLORD].PetCriticalAttackRate;

  00000	0f b7 81 d0 01
	00 00		 movzx	 eax, WORD PTR [ecx+464]

; 99   : 	};

  00007	c3		 ret	 0
?GetPetCriticalAttackRate@ClassCalc@@QAEHXZ ENDP	; ClassCalc::GetPetCriticalAttackRate
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h
;	COMDAT ?GetPetAttackDamageMaxStart@ClassCalc@@QAEHXZ
_TEXT	SEGMENT
?GetPetAttackDamageMaxStart@ClassCalc@@QAEHXZ PROC	; ClassCalc::GetPetAttackDamageMaxStart, COMDAT
; _this$ = ecx

; 94   : 		return this->m_Data[CLASS_DARKLORD].PetAttackDamageMaxStart;

  00000	0f b7 81 ce 01
	00 00		 movzx	 eax, WORD PTR [ecx+462]

; 95   : 	};

  00007	c3		 ret	 0
?GetPetAttackDamageMaxStart@ClassCalc@@QAEHXZ ENDP	; ClassCalc::GetPetAttackDamageMaxStart
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h
;	COMDAT ?GetPetAttackDamageMaxDiv@ClassCalc@@QAEHXZ
_TEXT	SEGMENT
?GetPetAttackDamageMaxDiv@ClassCalc@@QAEHXZ PROC	; ClassCalc::GetPetAttackDamageMaxDiv, COMDAT
; _this$ = ecx

; 90   : 		return this->m_Data[CLASS_DARKLORD].PetAttackDamageMaxDiv;

  00000	0f b7 81 cc 01
	00 00		 movzx	 eax, WORD PTR [ecx+460]

; 91   : 	};

  00007	c3		 ret	 0
?GetPetAttackDamageMaxDiv@ClassCalc@@QAEHXZ ENDP	; ClassCalc::GetPetAttackDamageMaxDiv
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h
;	COMDAT ?GetPetAttackDamageMaxFact@ClassCalc@@QAEHXZ
_TEXT	SEGMENT
?GetPetAttackDamageMaxFact@ClassCalc@@QAEHXZ PROC	; ClassCalc::GetPetAttackDamageMaxFact, COMDAT
; _this$ = ecx

; 86   : 		return this->m_Data[CLASS_DARKLORD].PetAttackDamageMaxFact;

  00000	0f b7 81 ca 01
	00 00		 movzx	 eax, WORD PTR [ecx+458]

; 87   : 	}

  00007	c3		 ret	 0
?GetPetAttackDamageMaxFact@ClassCalc@@QAEHXZ ENDP	; ClassCalc::GetPetAttackDamageMaxFact
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h
;	COMDAT ?GetPetAttackDamageMinStart@ClassCalc@@QAEHXZ
_TEXT	SEGMENT
?GetPetAttackDamageMinStart@ClassCalc@@QAEHXZ PROC	; ClassCalc::GetPetAttackDamageMinStart, COMDAT
; _this$ = ecx

; 82   : 		return this->m_Data[CLASS_DARKLORD].PetAttackDamageMinStart;

  00000	0f b7 81 c8 01
	00 00		 movzx	 eax, WORD PTR [ecx+456]

; 83   : 	};

  00007	c3		 ret	 0
?GetPetAttackDamageMinStart@ClassCalc@@QAEHXZ ENDP	; ClassCalc::GetPetAttackDamageMinStart
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h
;	COMDAT ?GetPetAttackDamageMinDiv@ClassCalc@@QAEHXZ
_TEXT	SEGMENT
?GetPetAttackDamageMinDiv@ClassCalc@@QAEHXZ PROC	; ClassCalc::GetPetAttackDamageMinDiv, COMDAT
; _this$ = ecx

; 78   : 		return this->m_Data[CLASS_DARKLORD].PetAttackDamageMinDiv;

  00000	0f b7 81 c6 01
	00 00		 movzx	 eax, WORD PTR [ecx+454]

; 79   : 	};

  00007	c3		 ret	 0
?GetPetAttackDamageMinDiv@ClassCalc@@QAEHXZ ENDP	; ClassCalc::GetPetAttackDamageMinDiv
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h
;	COMDAT ?GetPetAttackDamageMinFact@ClassCalc@@QAEHXZ
_TEXT	SEGMENT
?GetPetAttackDamageMinFact@ClassCalc@@QAEHXZ PROC	; ClassCalc::GetPetAttackDamageMinFact, COMDAT
; _this$ = ecx

; 74   : 		return this->m_Data[CLASS_DARKLORD].PetAttackDamageMinFact;

  00000	0f b7 81 c4 01
	00 00		 movzx	 eax, WORD PTR [ecx+452]

; 75   : 	};

  00007	c3		 ret	 0
?GetPetAttackDamageMinFact@ClassCalc@@QAEHXZ ENDP	; ClassCalc::GetPetAttackDamageMinFact
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\crywolf.h
;	COMDAT ?GetCrywolfState@CCrywolf@@QAEHXZ
_TEXT	SEGMENT
?GetCrywolfState@CCrywolf@@QAEHXZ PROC			; CCrywolf::GetCrywolfState, COMDAT
; _this$ = ecx

; 92   : 	int GetCrywolfState(){return this->m_iCrywolfState;}

  00000	8b 81 8c a8 0f
	00		 mov	 eax, DWORD PTR [ecx+1026188]
  00006	c3		 ret	 0
?GetCrywolfState@CCrywolf@@QAEHXZ ENDP			; CCrywolf::GetCrywolfState
_TEXT	ENDS
; Function compile flags: /Ogtp
;	COMDAT ??_GCDarkSpirit@@UAEPAXI@Z
_TEXT	SEGMENT
___flags$ = 8						; size = 4
??_GCDarkSpirit@@UAEPAXI@Z PROC				; CDarkSpirit::`scalar deleting destructor', COMDAT
; _this$ = ecx
  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	56		 push	 esi
  00004	8b f1		 mov	 esi, ecx
  00006	e8 00 00 00 00	 call	 ??1CDarkSpirit@@UAE@XZ	; CDarkSpirit::~CDarkSpirit
  0000b	f6 45 08 01	 test	 BYTE PTR ___flags$[ebp], 1
  0000f	74 0b		 je	 SHORT $LN4@scalar
  00011	6a 30		 push	 48			; 00000030H
  00013	56		 push	 esi
  00014	e8 00 00 00 00	 call	 ??3@YAXPAXI@Z		; operator delete
  00019	83 c4 08	 add	 esp, 8
$LN4@scalar:
  0001c	8b c6		 mov	 eax, esi
  0001e	5e		 pop	 esi
  0001f	5d		 pop	 ebp
  00020	c2 04 00	 ret	 4
??_GCDarkSpirit@@UAEPAXI@Z ENDP				; CDarkSpirit::`scalar deleting destructor'
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
; File c:\users\michel\desktop\source\gameserver\include\prodef.h
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
;	COMDAT ?SendLevelmsg@CDarkSpirit@@SAXHHHH@Z
_TEXT	SEGMENT
_pMsg$ = -20						; size = 16
__$ArrayPad$ = -4					; size = 4
_aIndex$ = 8						; size = 4
_nPos$ = 12						; size = 4
_PetType$ = 16						; size = 4
_InvenType$ = 20					; size = 4
?SendLevelmsg@CDarkSpirit@@SAXHHHH@Z PROC		; CDarkSpirit::SendLevelmsg, COMDAT

; 1778 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 14	 sub	 esp, 20			; 00000014H
  00006	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000b	33 c5		 xor	 eax, ebp
  0000d	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax

; 1779 : 	PMSG_SEND_PET_ITEMINFO pMsg;
; 1780 : 
; 1781 : 	pMsg.h.set((LPBYTE)&pMsg, 0xA9, sizeof(pMsg));
; 1782 : 	pMsg.PetType = PetType;

  00010	8a 45 10	 mov	 al, BYTE PTR _PetType$[ebp]

; 1785 : 	pMsg.Level = gObj[aIndex].pInventory[nPos].m_PetItem_Level;

  00013	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00019	8b 4d 0c	 mov	 ecx, DWORD PTR _nPos$[ebp]
  0001c	56		 push	 esi
  0001d	57		 push	 edi
  0001e	8b 7d 08	 mov	 edi, DWORD PTR _aIndex$[ebp]
  00021	88 45 ef	 mov	 BYTE PTR _pMsg$[ebp+3], al
  00024	8a 45 14	 mov	 al, BYTE PTR _InvenType$[ebp]
  00027	88 4d f1	 mov	 BYTE PTR _pMsg$[ebp+5], cl
  0002a	69 f7 40 27 00
	00		 imul	 esi, edi, 10048
  00030	88 45 f0	 mov	 BYTE PTR _pMsg$[ebp+4], al
; File c:\users\michel\desktop\source\gameserver\include\prodef.h

; 86   : 		lpBuf[0] = 0xC1;

  00033	66 c7 45 ec c1
	10		 mov	 WORD PTR _pMsg$[ebp], 4289 ; 000010c1H

; 87   : 		lpBuf[1] = size;
; 88   : 		lpBuf[2] = head;

  00039	c6 45 ee a9	 mov	 BYTE PTR _pMsg$[ebp+2], 169 ; 000000a9H
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp

; 1785 : 	pMsg.Level = gObj[aIndex].pInventory[nPos].m_PetItem_Level;

  0003d	69 c9 d4 00 00
	00		 imul	 ecx, ecx, 212

; 1786 : 	pMsg.Exp = gObj[aIndex].pInventory[nPos].m_PetItem_Exp;
; 1787 : 	pMsg.Life = (BYTE)gObj[aIndex].pInventory[nPos].m_Durability;
; 1788 : 
; 1789 : 	DataSend(aIndex, (LPBYTE)&pMsg, pMsg.h.size);

  00043	6a 10		 push	 16			; 00000010H
  00045	8b 84 16 c0 11
	00 00		 mov	 eax, DWORD PTR [esi+edx+4544]
  0004c	0f b6 84 08 b8
	00 00 00	 movzx	 eax, BYTE PTR [eax+ecx+184]
  00054	88 45 f2	 mov	 BYTE PTR _pMsg$[ebp+6], al
  00057	8b 84 16 c0 11
	00 00		 mov	 eax, DWORD PTR [esi+edx+4544]
  0005e	8b 84 08 bc 00
	00 00		 mov	 eax, DWORD PTR [eax+ecx+188]
  00065	89 45 f4	 mov	 DWORD PTR _pMsg$[ebp+8], eax
  00068	8b 84 16 c0 11
	00 00		 mov	 eax, DWORD PTR [esi+edx+4544]
  0006f	f3 0f 2c 44 08
	24		 cvttss2si eax, DWORD PTR [eax+ecx+36]
  00075	88 45 f8	 mov	 BYTE PTR _pMsg$[ebp+12], al
  00078	8d 45 ec	 lea	 eax, DWORD PTR _pMsg$[ebp]
  0007b	50		 push	 eax
  0007c	57		 push	 edi
  0007d	e8 00 00 00 00	 call	 ?DataSend@@YAHHPAEK@Z	; DataSend

; 1790 : }

  00082	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  00085	83 c4 0c	 add	 esp, 12			; 0000000cH
  00088	33 cd		 xor	 ecx, ebp
  0008a	5f		 pop	 edi
  0008b	5e		 pop	 esi
  0008c	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00091	8b e5		 mov	 esp, ebp
  00093	5d		 pop	 ebp
  00094	c3		 ret	 0
?SendLevelmsg@CDarkSpirit@@SAXHHHH@Z ENDP		; CDarkSpirit::SendLevelmsg
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
;	COMDAT ?GetShieldDamage@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0H@Z
_TEXT	SEGMENT
tv280 = 8						; size = 4
_lpObj$ = 8						; size = 4
_lpTargetObj$ = 12					; size = 4
_iAttackDamage$ = 16					; size = 4
?GetShieldDamage@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0H@Z PROC ; CDarkSpirit::GetShieldDamage, COMDAT
; _this$ = ecx

; 1795 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 1796 : 	int iShieldDamage = 0;
; 1797 : 
; 1798 : 	if ( g_ShieldSystemOn == FALSE )

  00003	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?g_ShieldSystemOn@@3HA, 0 ; g_ShieldSystemOn
  0000a	75 06		 jne	 SHORT $LN2@GetShieldD

; 1799 : 		return 0;

  0000c	33 c0		 xor	 eax, eax

; 1866 : }

  0000e	5d		 pop	 ebp
  0000f	c2 0c 00	 ret	 12			; 0000000cH
$LN2@GetShieldD:
  00012	53		 push	 ebx

; 1800 : 
; 1801 : 	if ( iAttackDamage <= 0 )

  00013	8b 5d 10	 mov	 ebx, DWORD PTR _iAttackDamage$[ebp]
  00016	85 db		 test	 ebx, ebx
  00018	7f 07		 jg	 SHORT $LN3@GetShieldD

; 1802 : 		return 0;

  0001a	33 c0		 xor	 eax, eax
  0001c	5b		 pop	 ebx

; 1866 : }

  0001d	5d		 pop	 ebp
  0001e	c2 0c 00	 ret	 12			; 0000000cH
$LN3@GetShieldD:

; 1803 : 
; 1804 : 	int iReduceLife = 0;
; 1805 : 	int iReduceShield = 0;
; 1806 : 	int iReduceLifeForEffect = 0; 
; 1807 : 	bool bReduceShieldGage = 0;
; 1808 : 	int iDamageDevideToSDRate = g_iDamageDevideToSDRate;
; 1809 : 	iDamageDevideToSDRate -= lpObj->m_JewelOfHarmonyEffect.HJOpDecreaseSDRate;

  00021	8b 4d 08	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  00024	56		 push	 esi
  00025	57		 push	 edi

; 1810 : 	iDamageDevideToSDRate += lpTargetObj->m_JewelOfHarmonyEffect.HJOpAddSDRate;

  00026	8b 7d 0c	 mov	 edi, DWORD PTR _lpTargetObj$[ebp]
  00029	0f bf 81 3c 24
	00 00		 movsx	 eax, WORD PTR [ecx+9276]
  00030	0f bf b7 50 24
	00 00		 movsx	 esi, WORD PTR [edi+9296]
  00037	2b f0		 sub	 esi, eax

; 1811 : 
; 1812 : 	if ( iDamageDevideToSDRate < 0 )

  00039	b8 64 00 00 00	 mov	 eax, 100		; 00000064H
  0003e	03 35 00 00 00
	00		 add	 esi, DWORD PTR ?g_iDamageDevideToSDRate@@3HA ; g_iDamageDevideToSDRate
  00044	79 04		 jns	 SHORT $LN4@GetShieldD

; 1813 : 		iDamageDevideToSDRate = 0;

  00046	33 f6		 xor	 esi, esi

; 1814 : 
; 1815 : 	if ( iDamageDevideToSDRate > 100 )

  00048	eb 05		 jmp	 SHORT $LN5@GetShieldD
$LN4@GetShieldD:
  0004a	3b f0		 cmp	 esi, eax
  0004c	0f 4f f0	 cmovg	 esi, eax
$LN5@GetShieldD:

; 1816 : 		iDamageDevideToSDRate = 100;
; 1817 : 
; 1818 : 	if ( lpObj->m_JewelOfHarmonyEffect.HJOpAddIgnoreSDRate > 0 )

  0004f	0f b7 91 3e 24
	00 00		 movzx	 edx, WORD PTR [ecx+9278]
  00056	66 85 d2	 test	 dx, dx
  00059	7e 2c		 jle	 SHORT $LN7@GetShieldD

; 1819 : 	{
; 1820 : 		int iRand = rand()%100;

  0005b	e8 00 00 00 00	 call	 _rand
  00060	99		 cdq
  00061	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  00066	f7 f9		 idiv	 ecx

; 1821 : 
; 1822 : 		if ( iRand < lpObj->m_JewelOfHarmonyEffect.HJOpAddIgnoreSDRate )

  00068	8b 4d 08	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  0006b	c7 45 08 00 00
	00 00		 mov	 DWORD PTR tv280[ebp], 0
  00072	0f b7 81 3e 24
	00 00		 movzx	 eax, WORD PTR [ecx+9278]
  00079	98		 cwde
  0007a	3b d0		 cmp	 edx, eax
  0007c	0f b7 91 3e 24
	00 00		 movzx	 edx, WORD PTR [ecx+9278]
  00083	0f 4c 75 08	 cmovl	 esi, DWORD PTR tv280[ebp]
$LN7@GetShieldD:

; 1823 : 		{
; 1824 : 			iDamageDevideToSDRate = 0;
; 1825 : 		}
; 1826 : 	}
; 1827 : 
; 1828 : 	if ( lpObj->m_JewelOfHarmonyEffect.HJOpDecreaseSDRate ||
; 1829 : 		 lpTargetObj->m_JewelOfHarmonyEffect.HJOpAddSDRate ||

  00087	0f b7 81 3c 24
	00 00		 movzx	 eax, WORD PTR [ecx+9276]
  0008e	66 85 c0	 test	 ax, ax
  00091	75 0e		 jne	 SHORT $LN9@GetShieldD
  00093	66 39 87 50 24
	00 00		 cmp	 WORD PTR [edi+9296], ax
  0009a	75 05		 jne	 SHORT $LN9@GetShieldD
  0009c	66 85 d2	 test	 dx, dx
  0009f	74 34		 je	 SHORT $LN8@GetShieldD
$LN9@GetShieldD:

; 1830 : 		 lpObj->m_JewelOfHarmonyEffect.HJOpAddIgnoreSDRate )
; 1831 : 	{
; 1832 : 		LogAddTD("[JewelOfHarmony][PvP System] Attacker:[%s][%s]-SD Decrease[%d] SD Ignore[%d] Defender:[%s][%s] SD Increase Option[%d] - SD Rate[%d]",

  000a1	0f bf 87 50 24
	00 00		 movsx	 eax, WORD PTR [edi+9296]
  000a8	56		 push	 esi
  000a9	50		 push	 eax
  000aa	8d 47 5d	 lea	 eax, DWORD PTR [edi+93]
  000ad	50		 push	 eax
  000ae	8d 47 52	 lea	 eax, DWORD PTR [edi+82]
  000b1	50		 push	 eax
  000b2	0f bf c2	 movsx	 eax, dx
  000b5	50		 push	 eax
  000b6	0f b7 81 3c 24
	00 00		 movzx	 eax, WORD PTR [ecx+9276]
  000bd	98		 cwde
  000be	50		 push	 eax
  000bf	8d 41 5d	 lea	 eax, DWORD PTR [ecx+93]
  000c2	50		 push	 eax
  000c3	8d 41 52	 lea	 eax, DWORD PTR [ecx+82]
  000c6	50		 push	 eax
  000c7	68 00 00 00 00	 push	 OFFSET ??_C@_0IE@HMIJIHBA@?$FLJewelOfHarmony?$FN?$FLPvP?5System?$FN?5Att@
  000cc	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  000d2	83 c4 24	 add	 esp, 36			; 00000024H
$LN8@GetShieldD:

; 1833 : 			lpObj->AccountID, lpObj->Name,
; 1834 : 			lpObj->m_JewelOfHarmonyEffect.HJOpDecreaseSDRate,
; 1835 : 			lpObj->m_JewelOfHarmonyEffect.HJOpAddIgnoreSDRate,
; 1836 : 			lpTargetObj->AccountID, lpTargetObj->Name,
; 1837 : 			lpTargetObj->m_JewelOfHarmonyEffect.HJOpAddSDRate,
; 1838 : 			iDamageDevideToSDRate);
; 1839 : 	}
; 1840 : 
; 1841 : 	iReduceShield = iAttackDamage * iDamageDevideToSDRate / 100;
; 1842 : 	iReduceLife = iAttackDamage - iReduceShield;
; 1843 : 
; 1844 : 	if ( (lpTargetObj->iShield-iReduceShield) <0 )

  000d5	8b 8f 2c 01 00
	00		 mov	 ecx, DWORD PTR [edi+300]
  000db	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  000e0	0f af f3	 imul	 esi, ebx
  000e3	f7 ee		 imul	 esi
  000e5	8b c1		 mov	 eax, ecx
  000e7	c1 fa 05	 sar	 edx, 5
  000ea	8b f2		 mov	 esi, edx
  000ec	c1 ee 1f	 shr	 esi, 31			; 0000001fH
  000ef	03 f2		 add	 esi, edx
  000f1	2b de		 sub	 ebx, esi
  000f3	2b c6		 sub	 eax, esi
  000f5	79 5a		 jns	 SHORT $LN13@GetShieldD

; 1845 : 	{
; 1846 : 		iReduceLife += iReduceShield  - lpTargetObj->iShield;

  000f7	2b f1		 sub	 esi, ecx
  000f9	03 de		 add	 ebx, esi

; 1847 : 		iReduceShield = lpTargetObj->iShield;

  000fb	8b f1		 mov	 esi, ecx

; 1848 : 
; 1849 : 		if ( lpTargetObj->iShield > 0 )

  000fd	85 c9		 test	 ecx, ecx
  000ff	7e 50		 jle	 SHORT $LN13@GetShieldD

; 1850 : 		{
; 1851 : 			bReduceShieldGage = true;
; 1852 : 		}
; 1853 : 	}
; 1854 : 
; 1855 : 	iReduceLifeForEffect = (int)(( lpTargetObj->MaxLife + lpTargetObj->AddLife ) * 20.0f / 100.0f);

  00101	66 0f 6e 87 24
	01 00 00	 movd	 xmm0, DWORD PTR [edi+292]
  00109	0f 5b c0	 cvtdq2ps xmm0, xmm0
  0010c	f3 0f 58 87 dc
	00 00 00	 addss	 xmm0, DWORD PTR [edi+220]
  00114	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR __real@41a00000
  0011c	f3 0f 5e 05 00
	00 00 00	 divss	 xmm0, DWORD PTR __real@42c80000
  00124	f3 0f 2c c0	 cvttss2si eax, xmm0

; 1856 : 
; 1857 : 	if ( bReduceShieldGage == true && iReduceLife > iReduceLifeForEffect )

  00128	3b d8		 cmp	 ebx, eax
  0012a	7e 25		 jle	 SHORT $LN13@GetShieldD

; 1858 : 	{
; 1859 : 		if ( !CC_MAP_RANGE(lpTargetObj->MapNumber) )

  0012c	8a 87 23 01 00
	00		 mov	 al, BYTE PTR [edi+291]
  00132	3c 35		 cmp	 al, 53			; 00000035H
  00134	74 1b		 je	 SHORT $LN13@GetShieldD
  00136	3c 12		 cmp	 al, 18			; 00000012H
  00138	72 0b		 jb	 SHORT $LN20@GetShieldD
  0013a	b1 17		 mov	 cl, 23			; 00000017H
  0013c	3a c8		 cmp	 cl, al
  0013e	1b c0		 sbb	 eax, eax
  00140	83 c0 01	 add	 eax, 1
  00143	75 0c		 jne	 SHORT $LN13@GetShieldD
$LN20@GetShieldD:

; 1860 : 		{
; 1861 : 			GCSendEffectInfo(lpTargetObj->m_Index, 17);

  00145	6a 11		 push	 17			; 00000011H
  00147	ff 37		 push	 DWORD PTR [edi]
  00149	e8 00 00 00 00	 call	 ?GCSendEffectInfo@@YAXHE@Z ; GCSendEffectInfo
  0014e	83 c4 08	 add	 esp, 8
$LN13@GetShieldD:

; 1862 : 		}
; 1863 : 	}
; 1864 : 
; 1865 : 	return iReduceShield;

  00151	5f		 pop	 edi
  00152	8b c6		 mov	 eax, esi
  00154	5e		 pop	 esi
  00155	5b		 pop	 ebx

; 1866 : }

  00156	5d		 pop	 ebp
  00157	c2 0c 00	 ret	 12			; 0000000cH
?GetShieldDamage@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0H@Z ENDP ; CDarkSpirit::GetShieldDamage
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
; File c:\users\michel\desktop\source\gameserver\include\prodef.h
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
;	COMDAT ?SendAttackMsg@CDarkSpirit@@QAEXHHHH@Z
_TEXT	SEGMENT
_this$1$ = -24						; size = 4
tv211 = -20						; size = 4
_pMsg$ = -16						; size = 9
__$ArrayPad$ = -4					; size = 4
_aIndex$ = 8						; size = 4
_aTargetIndex$ = 12					; size = 4
_criticaldamage$ = 16					; size = 4
_iActionType$ = 20					; size = 4
?SendAttackMsg@CDarkSpirit@@QAEXHHHH@Z PROC		; CDarkSpirit::SendAttackMsg, COMDAT
; _this$ = ecx

; 462  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 18	 sub	 esp, 24			; 00000018H
  00006	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000b	33 c5		 xor	 eax, ebp
  0000d	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00010	53		 push	 ebx
  00011	8b 5d 08	 mov	 ebx, DWORD PTR _aIndex$[ebp]
  00014	56		 push	 esi

; 463  : 	PMSG_PET_ITEM_ATTACK_COMMAND pMsg;
; 464  : 
; 465  : 	if ( criticaldamage != 3 )

  00015	8b 75 14	 mov	 esi, DWORD PTR _iActionType$[ebp]
  00018	57		 push	 edi
  00019	8b 7d 10	 mov	 edi, DWORD PTR _criticaldamage$[ebp]
  0001c	89 4d e8	 mov	 DWORD PTR _this$1$[ebp], ecx
  0001f	83 ff 03	 cmp	 edi, 3
  00022	0f 84 c9 00 00
	00		 je	 $LN2@SendAttack

; 471  : 		pMsg.TargetNumberH = SET_NUMBERH(aTargetIndex);

  00028	8b 4d 0c	 mov	 ecx, DWORD PTR _aTargetIndex$[ebp]
  0002b	85 ff		 test	 edi, edi
  0002d	8b c3		 mov	 eax, ebx
; File c:\users\michel\desktop\source\gameserver\include\prodef.h

; 86   : 		lpBuf[0] = 0xC1;

  0002f	c7 45 f0 c1 09
	a8 00		 mov	 DWORD PTR _pMsg$[ebp], 11012545 ; 00a809c1H
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp

; 468  : 		pMsg.SkillType = (criticaldamage)? 0 : 1;

  00036	0f 94 45 f4	 sete	 BYTE PTR _pMsg$[ebp+4]

; 469  : 		pMsg.NumberH = SET_NUMBERH(aIndex);
; 470  : 		pMsg.NumberL = SET_NUMBERL(aIndex);

  0003a	88 5d f6	 mov	 BYTE PTR _pMsg$[ebp+6], bl
  0003d	c1 e8 08	 shr	 eax, 8
  00040	88 45 f5	 mov	 BYTE PTR _pMsg$[ebp+5], al

; 471  : 		pMsg.TargetNumberH = SET_NUMBERH(aTargetIndex);

  00043	8b c1		 mov	 eax, ecx
  00045	c1 e8 08	 shr	 eax, 8
  00048	88 45 f7	 mov	 BYTE PTR _pMsg$[ebp+7], al

; 472  : 		pMsg.TargetNumberL = SET_NUMBERL(aTargetIndex);
; 473  : 		pMsg.h.set((LPBYTE)&pMsg, 0xA8, sizeof(pMsg));
; 474  : 		
; 475  : 		DataSend(aIndex, (UCHAR*)&pMsg, pMsg.h.size);

  0004b	8d 45 f0	 lea	 eax, DWORD PTR _pMsg$[ebp]
  0004e	6a 09		 push	 9
  00050	50		 push	 eax
  00051	53		 push	 ebx
  00052	88 4d f8	 mov	 BYTE PTR _pMsg$[ebp+8], cl
  00055	e8 00 00 00 00	 call	 ?DataSend@@YAHHPAEK@Z	; DataSend

; 476  : 		MsgSendV2(&gObj[aIndex], (UCHAR*)&pMsg, pMsg.h.size);

  0005a	0f b6 45 f1	 movzx	 eax, BYTE PTR _pMsg$[ebp+1]
  0005e	50		 push	 eax
  0005f	69 cb 40 27 00
	00		 imul	 ecx, ebx, 10048
  00065	8d 45 f0	 lea	 eax, DWORD PTR _pMsg$[ebp]
  00068	50		 push	 eax
  00069	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0006e	03 c1		 add	 eax, ecx
  00070	89 4d ec	 mov	 DWORD PTR tv211[ebp], ecx
  00073	50		 push	 eax
  00074	e8 00 00 00 00	 call	 ?MsgSendV2@@YAXPAUOBJECTSTRUCT@@PAEH@Z ; MsgSendV2
  00079	83 c4 18	 add	 esp, 24			; 00000018H

; 477  : 
; 478  : 		if ( iActionType == 1 )

  0007c	83 fe 01	 cmp	 esi, 1
  0007f	75 72		 jne	 SHORT $LN3@SendAttack

; 479  : 		{
; 480  : 			criticaldamage = 0;
; 481  : 			LPOBJ lpObj = &gObj[aIndex];

  00081	8b 35 00 00 00
	00		 mov	 esi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00087	33 ff		 xor	 edi, edi

; 482  : 
; 483  : 			if ( (rand()%100) < (this->m_iCriticalSuccessRate+lpObj->m_MPSkillOpt.MpsDarkSpiritStr2) )

  00089	e8 00 00 00 00	 call	 _rand
  0008e	99		 cdq
  0008f	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  00094	f7 f9		 idiv	 ecx
  00096	8b 45 ec	 mov	 eax, DWORD PTR tv211[ebp]
  00099	f3 0f 10 84 30
	ac 07 00 00	 movss	 xmm0, DWORD PTR [eax+esi+1964]
  000a2	8b 45 e8	 mov	 eax, DWORD PTR _this$1$[ebp]
  000a5	66 0f 6e ca	 movd	 xmm1, edx
  000a9	0f 5b c9	 cvtdq2ps xmm1, xmm1
  000ac	f3 0f 58 40 14	 addss	 xmm0, DWORD PTR [eax+20]
  000b1	b8 01 00 00 00	 mov	 eax, 1
  000b6	0f 2f c1	 comiss	 xmm0, xmm1
  000b9	0f 47 f8	 cmova	 edi, eax

; 484  : 			{
; 485  : 				criticaldamage = 1;
; 486  : 			}
; 487  : 
; 488  : 			if( (rand()%100) < (this->m_iExcelentSuccessRate+lpObj->m_MPSkillOpt.MpsDarkSpiritStr3) )

  000bc	e8 00 00 00 00	 call	 _rand
  000c1	99		 cdq
  000c2	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  000c7	f7 f9		 idiv	 ecx
  000c9	8b 45 ec	 mov	 eax, DWORD PTR tv211[ebp]
  000cc	f3 0f 10 84 30
	b0 07 00 00	 movss	 xmm0, DWORD PTR [eax+esi+1968]
  000d5	8b 45 e8	 mov	 eax, DWORD PTR _this$1$[ebp]

; 491  : 			}
; 492  : 		}
; 493  : 	}
; 494  : 	else

  000d8	8b 75 14	 mov	 esi, DWORD PTR _iActionType$[ebp]
  000db	66 0f 6e ca	 movd	 xmm1, edx
  000df	0f 5b c9	 cvtdq2ps xmm1, xmm1
  000e2	f3 0f 58 40 18	 addss	 xmm0, DWORD PTR [eax+24]
  000e7	0f 2f c1	 comiss	 xmm0, xmm1
  000ea	76 07		 jbe	 SHORT $LN3@SendAttack

; 489  : 			{
; 490  : 				criticaldamage = 2;

  000ec	8d 79 9e	 lea	 edi, DWORD PTR [ecx-98]

; 491  : 			}
; 492  : 		}
; 493  : 	}
; 494  : 	else

  000ef	eb 02		 jmp	 SHORT $LN3@SendAttack
$LN2@SendAttack:

; 495  : 	{
; 496  : 		criticaldamage = 0;

  000f1	33 ff		 xor	 edi, edi
$LN3@SendAttack:

; 497  : 	}
; 498  : 
; 499  : 	gObjAddAttackProcMsgSendDelay(&gObj[aIndex], 51, aTargetIndex, 600, criticaldamage, iActionType);

  000f3	56		 push	 esi
  000f4	57		 push	 edi
  000f5	68 58 02 00 00	 push	 600			; 00000258H
  000fa	ff 75 0c	 push	 DWORD PTR _aTargetIndex$[ebp]
  000fd	69 c3 40 27 00
	00		 imul	 eax, ebx, 10048
  00103	6a 33		 push	 51			; 00000033H
  00105	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0010b	50		 push	 eax
  0010c	e8 00 00 00 00	 call	 ?gObjAddAttackProcMsgSendDelay@@YAXPAUOBJECTSTRUCT@@HHHHH@Z ; gObjAddAttackProcMsgSendDelay

; 500  : }

  00111	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  00114	83 c4 18	 add	 esp, 24			; 00000018H
  00117	33 cd		 xor	 ecx, ebp
  00119	5f		 pop	 edi
  0011a	5e		 pop	 esi
  0011b	5b		 pop	 ebx
  0011c	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00121	8b e5		 mov	 esp, ebp
  00123	5d		 pop	 ebp
  00124	c2 10 00	 ret	 16			; 00000010H
?SendAttackMsg@CDarkSpirit@@QAEXHHHH@Z ENDP		; CDarkSpirit::SendAttackMsg
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
;	COMDAT ?RangeAttack@CDarkSpirit@@QAEXHH@Z
_TEXT	SEGMENT
_this$1$ = -12						; size = 4
_HitCount$1$ = -8					; size = 4
_lpObj$1$ = -4						; size = 4
_count$1$ = 8						; size = 4
_aIndex$ = 8						; size = 4
_aTargetIndex$ = 12					; size = 4
?RangeAttack@CDarkSpirit@@QAEXHH@Z PROC			; CDarkSpirit::RangeAttack, COMDAT
; _this$ = ecx

; 360  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 0c	 sub	 esp, 12			; 0000000cH
  00006	53		 push	 ebx

; 361  : 	LPOBJ lpObj = &gObj[aIndex];

  00007	69 5d 08 40 27
	00 00		 imul	 ebx, DWORD PTR _aIndex$[ebp], 10048
  0000e	8b c1		 mov	 eax, ecx
  00010	56		 push	 esi
  00011	57		 push	 edi

; 362  : 	int StartDis = 1;
; 363  : 	int tObjNum;
; 364  : 	int count = 0;
; 365  : 	int loopcount = 0;
; 366  : 	int attackcheck;
; 367  : 	int EnableAttack;
; 368  : 	int HitCount = 0;
; 369  : 
; 370  : 	this->SendAttackMsg(lpObj->m_Index, aTargetIndex, 0, 0);

  00012	6a 00		 push	 0
  00014	6a 00		 push	 0
  00016	03 1d 00 00 00
	00		 add	 ebx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0001c	ff 75 0c	 push	 DWORD PTR _aTargetIndex$[ebp]
  0001f	89 45 f4	 mov	 DWORD PTR _this$1$[ebp], eax
  00022	89 5d fc	 mov	 DWORD PTR _lpObj$1$[ebp], ebx
  00025	ff 33		 push	 DWORD PTR [ebx]
  00027	c7 45 08 00 00
	00 00		 mov	 DWORD PTR _count$1$[ebp], 0
  0002e	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _HitCount$1$[ebp], 0
  00035	e8 00 00 00 00	 call	 ?SendAttackMsg@CDarkSpirit@@QAEXHHHH@Z ; CDarkSpirit::SendAttackMsg
  0003a	8d bb 4a 0c 00
	00		 lea	 edi, DWORD PTR [ebx+3146]
  00040	33 c0		 xor	 eax, eax
$LL2@RangeAttac:

; 371  : 
; 372  : 	while ( true )
; 373  : 	{
; 374  : 		if ( lpObj->VpPlayer2[count].state != 0 )

  00042	80 7f fe 00	 cmp	 BYTE PTR [edi-2], 0
  00046	0f 84 af 00 00
	00		 je	 $LN19@RangeAttac

; 375  : 		{
; 376  : 			tObjNum = lpObj->VpPlayer2[count].number;

  0004c	0f bf 37	 movsx	 esi, WORD PTR [edi]

; 377  : 
; 378  : 			if ( tObjNum >= 0 && aTargetIndex != tObjNum )

  0004f	85 f6		 test	 esi, esi
  00051	0f 88 a4 00 00
	00		 js	 $LN19@RangeAttac
  00057	39 75 0c	 cmp	 DWORD PTR _aTargetIndex$[ebp], esi
  0005a	0f 84 9b 00 00
	00		 je	 $LN19@RangeAttac

; 379  : 			{
; 380  : 				EnableAttack = FALSE;
; 381  : 				
; 382  : 				if ( lpObj->VpPlayer2[count].type == OBJ_MONSTER && gObj[tObjNum].m_RecallMon < 0)

  00060	80 7f 02 02	 cmp	 BYTE PTR [edi+2], 2
  00064	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0006a	75 10		 jne	 SHORT $LN6@RangeAttac
  0006c	69 de 40 27 00
	00		 imul	 ebx, esi, 10048
  00072	83 bc 0b 30 06
	00 00 00	 cmp	 DWORD PTR [ebx+ecx+1584], 0
  0007a	7c 43		 jl	 SHORT $LN29@RangeAttac
$LN6@RangeAttac:

; 383  : 				{
; 384  : 					EnableAttack = TRUE;
; 385  : 				}
; 386  : 				else if ( tObjNum == aTargetIndex )
; 387  : 				{
; 388  : 					EnableAttack = TRUE;
; 389  : 				}
; 390  : 				else
; 391  : 				{
; 392  : 					int lc10 = gObj[tObjNum].m_Index;

  0007c	69 de 40 27 00
	00		 imul	 ebx, esi, 10048

; 393  : 
; 394  : 					if ( gObj[tObjNum].Type == OBJ_MONSTER )

  00082	80 7c 0b 50 02	 cmp	 BYTE PTR [ebx+ecx+80], 2
  00087	8b 14 0b	 mov	 edx, DWORD PTR [ebx+ecx]
  0008a	75 14		 jne	 SHORT $LN11@RangeAttac

; 395  : 					{
; 396  : 						if ( gObj[tObjNum].m_RecallMon >= 0 )

  0008c	8b 84 0b 30 06
	00 00		 mov	 eax, DWORD PTR [ebx+ecx+1584]
  00093	85 c0		 test	 eax, eax
  00095	78 09		 js	 SHORT $LN11@RangeAttac

; 397  : 						{
; 398  : 							lc10 = gObj[gObj[tObjNum].m_RecallMon].m_Index;

  00097	69 c0 40 27 00
	00		 imul	 eax, eax, 10048
  0009d	8b 14 08	 mov	 edx, DWORD PTR [eax+ecx]
$LN11@RangeAttac:

; 399  : 						}
; 400  : 					}
; 401  : 
; 402  : 					if ( gObjTargetGuildWarCheck(lpObj, &gObj[lc10]) == TRUE )

  000a0	69 c2 40 27 00
	00		 imul	 eax, edx, 10048
  000a6	03 c1		 add	 eax, ecx
  000a8	50		 push	 eax
  000a9	ff 75 fc	 push	 DWORD PTR _lpObj$1$[ebp]
  000ac	e8 00 00 00 00	 call	 ?gObjTargetGuildWarCheck@@YAHPAUOBJECTSTRUCT@@0@Z ; gObjTargetGuildWarCheck
  000b1	83 c4 08	 add	 esp, 8
  000b4	83 f8 01	 cmp	 eax, 1
  000b7	75 3f		 jne	 SHORT $LN32@RangeAttac
  000b9	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
$LN29@RangeAttac:

; 403  : 					{
; 404  : 						EnableAttack = TRUE;
; 405  : 					}
; 406  : 				}
; 407  : 
; 408  : 				if ( EnableAttack != FALSE )
; 409  : 				{
; 410  : 					attackcheck = FALSE;
; 411  : 
; 412  : 					if ( loopcount == 0 )
; 413  : 					{
; 414  : 						attackcheck = TRUE;
; 415  : 					}
; 416  : 					else if ( (rand()%3) == 0 )
; 417  : 					{
; 418  : 						attackcheck = TRUE;
; 419  : 					}
; 420  : 
; 421  : 					if ( attackcheck != FALSE )
; 422  : 					{
; 423  : 						if ( gObjCalDistance(&gObj[aTargetIndex], &gObj[tObjNum]) < RAVEN_ATTACK_DISTANCE-3 )

  000bf	8d 04 0b	 lea	 eax, DWORD PTR [ebx+ecx]
  000c2	50		 push	 eax
  000c3	69 45 0c 40 27
	00 00		 imul	 eax, DWORD PTR _aTargetIndex$[ebp], 10048
  000ca	03 c1		 add	 eax, ecx
  000cc	50		 push	 eax
  000cd	e8 00 00 00 00	 call	 ?gObjCalDistance@@YAHPAUOBJECTSTRUCT@@0@Z ; gObjCalDistance
  000d2	83 c4 08	 add	 esp, 8
  000d5	83 f8 04	 cmp	 eax, 4
  000d8	7d 1e		 jge	 SHORT $LN32@RangeAttac

; 424  : 						{
; 425  : 							this->SendAttackMsg(lpObj->m_Index, tObjNum, 2, 0);

  000da	8b 45 fc	 mov	 eax, DWORD PTR _lpObj$1$[ebp]
  000dd	8b 4d f4	 mov	 ecx, DWORD PTR _this$1$[ebp]
  000e0	6a 00		 push	 0
  000e2	6a 02		 push	 2
  000e4	56		 push	 esi
  000e5	ff 30		 push	 DWORD PTR [eax]
  000e7	e8 00 00 00 00	 call	 ?SendAttackMsg@CDarkSpirit@@QAEXHHHH@Z ; CDarkSpirit::SendAttackMsg

; 426  : 							HitCount++;

  000ec	8b 5d f8	 mov	 ebx, DWORD PTR _HitCount$1$[ebp]
  000ef	43		 inc	 ebx
  000f0	89 5d f8	 mov	 DWORD PTR _HitCount$1$[ebp], ebx

; 427  : 
; 428  : 							if ( HitCount > 3 )

  000f3	83 fb 03	 cmp	 ebx, 3
  000f6	7f 13		 jg	 SHORT $LN24@RangeAttac
$LN32@RangeAttac:
  000f8	8b 45 08	 mov	 eax, DWORD PTR _count$1$[ebp]
$LN19@RangeAttac:

; 429  : 							{
; 430  : 								break;
; 431  : 							}
; 432  : 						}
; 433  : 					}
; 434  : 				}
; 435  : 			}				
; 436  : 		}
; 437  : 
; 438  : 		count++;

  000fb	40		 inc	 eax
  000fc	83 c7 0c	 add	 edi, 12			; 0000000cH
  000ff	89 45 08	 mov	 DWORD PTR _count$1$[ebp], eax

; 439  : 
; 440  : 		if ( count > MAX_VIEWPORT-1 )

  00102	83 f8 4a	 cmp	 eax, 74			; 0000004aH
  00105	0f 8e 37 ff ff
	ff		 jle	 $LL2@RangeAttac
$LN24@RangeAttac:
  0010b	5f		 pop	 edi
  0010c	5e		 pop	 esi
  0010d	5b		 pop	 ebx

; 441  : 		{
; 442  : 			break;
; 443  : 		}
; 444  : 	}
; 445  : }

  0010e	8b e5		 mov	 esp, ebp
  00110	5d		 pop	 ebp
  00111	c2 08 00	 ret	 8
?RangeAttack@CDarkSpirit@@QAEXHH@Z ENDP			; CDarkSpirit::RangeAttack
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
;	COMDAT ?ChangeCommand@CDarkSpirit@@QAEXHH@Z
_TEXT	SEGMENT
_command$ = 8						; size = 4
_targetindex$ = 12					; size = 4
?ChangeCommand@CDarkSpirit@@QAEXHH@Z PROC		; CDarkSpirit::ChangeCommand, COMDAT
; _this$ = ecx

; 1753 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 1754 : 	CDarkSpirit::ePetItem_Mode setmode = PetItem_Mode_Normal;
; 1755 : 
; 1756 : 	if ( command == PetItem_Mode_Normal )

  00003	8b 55 08	 mov	 edx, DWORD PTR _command$[ebp]
  00006	33 c0		 xor	 eax, eax
  00008	85 d2		 test	 edx, edx
  0000a	75 09		 jne	 SHORT $LN2@ChangeComm

; 1769 : 	{
; 1770 : 		setmode = PetItem_Mode_Attack_Target;
; 1771 : 	}
; 1772 : 
; 1773 : 	this->SetMode(setmode, targetindex);

  0000c	89 45 08	 mov	 DWORD PTR _command$[ebp], eax

; 1774 : }

  0000f	5d		 pop	 ebp

; 1769 : 	{
; 1770 : 		setmode = PetItem_Mode_Attack_Target;
; 1771 : 	}
; 1772 : 
; 1773 : 	this->SetMode(setmode, targetindex);

  00010	e9 00 00 00 00	 jmp	 ?SetMode@CDarkSpirit@@QAEXW4ePetItem_Mode@1@H@Z ; CDarkSpirit::SetMode
$LN2@ChangeComm:

; 1757 : 	{
; 1758 : 		setmode = PetItem_Mode_Normal;
; 1759 : 	}
; 1760 : 	else if ( command == PetItem_Mode_Attack_Random )

  00015	83 fa 01	 cmp	 edx, 1
  00018	75 0b		 jne	 SHORT $LN4@ChangeComm

; 1761 : 	{
; 1762 : 		setmode = PetItem_Mode_Attack_Random;

  0001a	8b c2		 mov	 eax, edx

; 1769 : 	{
; 1770 : 		setmode = PetItem_Mode_Attack_Target;
; 1771 : 	}
; 1772 : 
; 1773 : 	this->SetMode(setmode, targetindex);

  0001c	89 45 08	 mov	 DWORD PTR _command$[ebp], eax

; 1774 : }

  0001f	5d		 pop	 ebp

; 1769 : 	{
; 1770 : 		setmode = PetItem_Mode_Attack_Target;
; 1771 : 	}
; 1772 : 
; 1773 : 	this->SetMode(setmode, targetindex);

  00020	e9 00 00 00 00	 jmp	 ?SetMode@CDarkSpirit@@QAEXW4ePetItem_Mode@1@H@Z ; CDarkSpirit::SetMode
$LN4@ChangeComm:

; 1763 : 	}
; 1764 : 	else if ( command == PetItem_Mode_Attack_WithMaster )

  00025	83 fa 02	 cmp	 edx, 2
  00028	75 0b		 jne	 SHORT $LN6@ChangeComm

; 1765 : 	{
; 1766 : 		setmode = PetItem_Mode_Attack_WithMaster;

  0002a	8b c2		 mov	 eax, edx

; 1769 : 	{
; 1770 : 		setmode = PetItem_Mode_Attack_Target;
; 1771 : 	}
; 1772 : 
; 1773 : 	this->SetMode(setmode, targetindex);

  0002c	89 45 08	 mov	 DWORD PTR _command$[ebp], eax

; 1774 : }

  0002f	5d		 pop	 ebp

; 1769 : 	{
; 1770 : 		setmode = PetItem_Mode_Attack_Target;
; 1771 : 	}
; 1772 : 
; 1773 : 	this->SetMode(setmode, targetindex);

  00030	e9 00 00 00 00	 jmp	 ?SetMode@CDarkSpirit@@QAEXW4ePetItem_Mode@1@H@Z ; CDarkSpirit::SetMode
$LN6@ChangeComm:
  00035	56		 push	 esi

; 1767 : 	}
; 1768 : 	else if ( command == PetItem_Mode_Attack_Target )

  00036	be 03 00 00 00	 mov	 esi, 3
  0003b	3b d6		 cmp	 edx, esi
  0003d	0f 44 c6	 cmove	 eax, esi
  00040	5e		 pop	 esi

; 1769 : 	{
; 1770 : 		setmode = PetItem_Mode_Attack_Target;
; 1771 : 	}
; 1772 : 
; 1773 : 	this->SetMode(setmode, targetindex);

  00041	89 45 08	 mov	 DWORD PTR _command$[ebp], eax

; 1774 : }

  00044	5d		 pop	 ebp

; 1769 : 	{
; 1770 : 		setmode = PetItem_Mode_Attack_Target;
; 1771 : 	}
; 1772 : 
; 1773 : 	this->SetMode(setmode, targetindex);

  00045	e9 00 00 00 00	 jmp	 ?SetMode@CDarkSpirit@@QAEXW4ePetItem_Mode@1@H@Z ; CDarkSpirit::SetMode
?ChangeCommand@CDarkSpirit@@QAEXHH@Z ENDP		; CDarkSpirit::ChangeCommand
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
;	COMDAT ?MissCheckPvP@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0HHAAH@Z
_TEXT	SEGMENT
_Level$1$ = -8						; size = 4
_TargetLevel$1$ = -4					; size = 4
_iAttackRate$ = 8					; size = 4
_lpObj$ = 8						; size = 4
_iDefenseRate$ = 12					; size = 4
_lpTargetObj$ = 12					; size = 4
_skill$ = 16						; size = 4
_skillSuccess$ = 20					; size = 4
_bAllMiss$ = 24						; size = 4
?MissCheckPvP@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0HHAAH@Z PROC ; CDarkSpirit::MissCheckPvP, COMDAT
; _this$ = ecx

; 1612 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 08	 sub	 esp, 8
  00006	53		 push	 ebx

; 1613 : 	float iAttackRate = 0;
; 1614 : 	float iDefenseRate = 0;
; 1615 : 	int iAttackSuccessRate = 0;
; 1616 : 
; 1617 : 	if ( IT_MAP_RANGE(lpTargetObj->MapNumber) && g_IllusionTemple.GetState(lpTargetObj->MapNumber) == 2 )

  00007	8b 5d 08	 mov	 ebx, DWORD PTR _lpObj$[ebp]
  0000a	56		 push	 esi
  0000b	8b 75 0c	 mov	 esi, DWORD PTR _lpTargetObj$[ebp]
  0000e	8a 8e 23 01 00
	00		 mov	 cl, BYTE PTR [esi+291]
  00014	80 f9 2d	 cmp	 cl, 45			; 0000002dH
  00017	0f 82 8b 00 00
	00		 jb	 $LN5@MissCheckP
  0001d	b8 32 00 00 00	 mov	 eax, 50			; 00000032H
  00022	3a c1		 cmp	 al, cl
  00024	1b c0		 sbb	 eax, eax
  00026	83 c0 01	 add	 eax, 1
  00029	74 7d		 je	 SHORT $LN5@MissCheckP
  0002b	51		 push	 ecx
  0002c	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_IllusionTemple@@3VCIllusionTempleEvent@@A ; g_IllusionTemple
  00031	e8 00 00 00 00	 call	 ?GetState@CIllusionTempleEvent@@QAEEE@Z ; CIllusionTempleEvent::GetState
  00036	3c 02		 cmp	 al, 2
  00038	75 6e		 jne	 SHORT $LN5@MissCheckP

; 1618 : 	{
; 1619 : 		if( lpTargetObj->Type == OBJ_USER )

  0003a	80 7e 50 01	 cmp	 BYTE PTR [esi+80], 1
  0003e	75 3c		 jne	 SHORT $LN4@MissCheckP

; 1620 : 		{
; 1621 : 			if( g_IllusionTemple.Is1stSkillActive(lpTargetObj->iTempleIndex,lpTargetObj->MapNumber) )

  00040	0f b6 86 23 01
	00 00		 movzx	 eax, BYTE PTR [esi+291]
  00047	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_IllusionTemple@@3VCIllusionTempleEvent@@A ; g_IllusionTemple
  0004c	50		 push	 eax
  0004d	ff b6 78 24 00
	00		 push	 DWORD PTR [esi+9336]
  00053	e8 00 00 00 00	 call	 ?Is1stSkillActive@CIllusionTempleEvent@@QAEHHE@Z ; CIllusionTempleEvent::Is1stSkillActive
  00058	85 c0		 test	 eax, eax
  0005a	74 20		 je	 SHORT $LN4@MissCheckP

; 1622 : 			{
; 1623 : 				GCDamageSend(lpObj->m_Index, lpTargetObj->m_Index, 0, 0, 0, 0);

  0005c	6a 00		 push	 0
  0005e	6a 00		 push	 0
  00060	6a 00		 push	 0
  00062	6a 00		 push	 0
  00064	ff 36		 push	 DWORD PTR [esi]
  00066	8b c3		 mov	 eax, ebx
  00068	ff 30		 push	 DWORD PTR [eax]
  0006a	e8 00 00 00 00	 call	 ?GCDamageSend@@YAXHHHHHH@Z ; GCDamageSend
  0006f	83 c4 18	 add	 esp, 24			; 00000018H

; 1624 : 				return FALSE;

  00072	33 c0		 xor	 eax, eax
  00074	5e		 pop	 esi
  00075	5b		 pop	 ebx

; 1747 : }

  00076	8b e5		 mov	 esp, ebp
  00078	5d		 pop	 ebp
  00079	c2 14 00	 ret	 20			; 00000014H
$LN4@MissCheckP:

; 1625 : 			}
; 1626 : 		}
; 1627 : 
; 1628 : 		if( lpObj->PartyNumber == lpTargetObj->PartyNumber )

  0007c	8b 83 0c 06 00
	00		 mov	 eax, DWORD PTR [ebx+1548]
  00082	3b 86 0c 06 00
	00		 cmp	 eax, DWORD PTR [esi+1548]
  00088	75 1e		 jne	 SHORT $LN5@MissCheckP

; 1629 : 		{
; 1630 : 			GCDamageSend(lpObj->m_Index, lpTargetObj->m_Index, 0, 0, 0, 0);

  0008a	6a 00		 push	 0
  0008c	6a 00		 push	 0
  0008e	6a 00		 push	 0
  00090	6a 00		 push	 0
  00092	ff 36		 push	 DWORD PTR [esi]
  00094	ff 33		 push	 DWORD PTR [ebx]
  00096	e8 00 00 00 00	 call	 ?GCDamageSend@@YAXHHHHHH@Z ; GCDamageSend
  0009b	83 c4 18	 add	 esp, 24			; 00000018H

; 1631 : 			return FALSE;

  0009e	33 c0		 xor	 eax, eax
  000a0	5e		 pop	 esi
  000a1	5b		 pop	 ebx

; 1747 : }

  000a2	8b e5		 mov	 esp, ebp
  000a4	5d		 pop	 ebp
  000a5	c2 14 00	 ret	 20			; 00000014H
$LN5@MissCheckP:

; 1632 : 		}
; 1633 : 	}
; 1634 : 
; 1635 : 	int Level = lpObj->Level + lpObj->MasterLevel;

  000a8	0f bf 83 96 00
	00 00		 movsx	 eax, WORD PTR [ebx+150]

; 1636 : 
; 1637 : #if (ENABLE_CUSTOM_CLASSCALC == 1)
; 1638 : 	iAttackRate = g_ClassCalc.GetAttackRate(lpObj);

  000af	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_ClassCalc@@3VClassCalc@@A ; g_ClassCalc
  000b4	57		 push	 edi
  000b5	0f bf bb a8 00
	00 00		 movsx	 edi, WORD PTR [ebx+168]
  000bc	03 f8		 add	 edi, eax
  000be	53		 push	 ebx
  000bf	89 7d f8	 mov	 DWORD PTR _Level$1$[ebp], edi
  000c2	e8 00 00 00 00	 call	 ?GetAttackRate@ClassCalc@@QAEMPAUOBJECTSTRUCT@@@Z ; ClassCalc::GetAttackRate

; 1639 : #else
; 1640 : 	if ( lpObj->Class == CLASS_KNIGHT )
; 1641 : 	{
; 1642 : 		iAttackRate = (float)(Level * 3 + ( lpObj->Dexterity * 45) / 10);	// #formula
; 1643 : 	}
; 1644 : 	else if ( lpObj->Class == CLASS_DARKLORD )
; 1645 : 	{
; 1646 : 		iAttackRate = (float)(Level * 3 + ( lpObj->Dexterity * 4 ));	// #formula
; 1647 : 	}
; 1648 : 	else if ( lpObj->Class == CLASS_ELF )
; 1649 : 	{
; 1650 : 		iAttackRate = (float)(Level * 3 + ( lpObj->Dexterity * 6 ) / 10);	// #formula
; 1651 : 	}
; 1652 : 	else if ( lpObj->Class == CLASS_MAGUMSA )
; 1653 : 	{
; 1654 : 		iAttackRate = (float)(Level * 3 + ( lpObj->Dexterity * 35 ) / 10);	// #formula
; 1655 : 	}
; 1656 : 	else if ( lpObj->Class == CLASS_WIZARD )
; 1657 : 	{
; 1658 : 		iAttackRate = (float)(Level * 3 + ( lpObj->Dexterity * 4 ));	// #formula
; 1659 : 	}
; 1660 : 	else if( lpObj->Class == CLASS_SUMMONER )
; 1661 : 	{
; 1662 : 		iAttackRate = (float)(Level * 3 + ( lpObj->Dexterity * 35 ) / 10);	// #formula
; 1663 : 	}
; 1664 : 	else if( lpObj->Class == CLASS_FIGHTER )
; 1665 : 	{
; 1666 : 		iAttackRate = (float)(Level * 2.6 + ( lpObj->Dexterity * 36 ) / 10);	// #formula
; 1667 : 	}
; 1668 : #endif
; 1669 : 
; 1670 : 	int TargetLevel = lpTargetObj->Level + lpTargetObj->MasterLevel;

  000c7	0f bf 96 a8 00
	00 00		 movsx	 edx, WORD PTR [esi+168]

; 1671 : 
; 1672 : #if (ENABLE_CUSTOM_CLASSCALC == 1)
; 1673 : 	iDefenseRate = g_ClassCalc.GetDefenseRate(lpTargetObj);

  000ce	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_ClassCalc@@3VClassCalc@@A ; g_ClassCalc
  000d3	0f bf 86 96 00
	00 00		 movsx	 eax, WORD PTR [esi+150]
  000da	03 d0		 add	 edx, eax
  000dc	d9 5d 08	 fstp	 DWORD PTR _iAttackRate$[ebp]
  000df	56		 push	 esi
  000e0	89 55 fc	 mov	 DWORD PTR _TargetLevel$1$[ebp], edx
  000e3	e8 00 00 00 00	 call	 ?GetDefenseRate@ClassCalc@@QAEMPAUOBJECTSTRUCT@@@Z ; ClassCalc::GetDefenseRate

; 1674 : #else
; 1675 : 	if ( lpTargetObj->Class == CLASS_KNIGHT )
; 1676 : 	{
; 1677 : 		iDefenseRate = (float)(TargetLevel * 2 + lpTargetObj->Dexterity / 2);	// #formula
; 1678 : 	}
; 1679 : 	else if ( lpTargetObj->Class == CLASS_DARKLORD )
; 1680 : 	{
; 1681 : 		iDefenseRate = (float)(TargetLevel * 2 + lpTargetObj->Dexterity / 2);	// #formula
; 1682 : 	}
; 1683 : 	else if ( lpTargetObj->Class == CLASS_ELF )
; 1684 : 	{
; 1685 : 		iDefenseRate = (float)(TargetLevel * 2 + lpTargetObj->Dexterity / 10);	// #formula
; 1686 : 	}
; 1687 : 	else if ( lpTargetObj->Class == CLASS_MAGUMSA )
; 1688 : 	{
; 1689 : 		iDefenseRate = (float)(TargetLevel * 2 + lpTargetObj->Dexterity / 4);	// #formula
; 1690 : 	}
; 1691 : 	else if ( lpTargetObj->Class == CLASS_WIZARD )
; 1692 : 	{
; 1693 : 		iDefenseRate = (float)(TargetLevel * 2 + lpTargetObj->Dexterity / 4);	// #formula
; 1694 : 	}
; 1695 : 	else if ( lpTargetObj->Class == CLASS_SUMMONER )
; 1696 : 	{
; 1697 : 		iDefenseRate = (float)(TargetLevel * 2 + lpTargetObj->Dexterity / 2);	// #formula
; 1698 : 	}
; 1699 : 	else if ( lpTargetObj->Class == CLASS_FIGHTER )
; 1700 : 	{
; 1701 : 		iDefenseRate = (float)(TargetLevel*1.5f + lpTargetObj->Dexterity / 5);
; 1702 : 	}
; 1703 : #endif
; 1704 : 
; 1705 : 	if ( iAttackRate <= 0.0f || iDefenseRate <= 0.0f || lpObj->Level <= 0 || lpTargetObj->Level <= 0 )

  000e8	f3 0f 10 4d 08	 movss	 xmm1, DWORD PTR _iAttackRate$[ebp]
  000ed	0f 57 c0	 xorps	 xmm0, xmm0
  000f0	0f 2f c1	 comiss	 xmm0, xmm1
  000f3	d9 5d 0c	 fstp	 DWORD PTR _iDefenseRate$[ebp]
  000f6	0f 83 1f 01 00
	00		 jae	 $LN7@MissCheckP
  000fc	f3 0f 10 6d 0c	 movss	 xmm5, DWORD PTR _iDefenseRate$[ebp]
  00101	0f 2f c5	 comiss	 xmm0, xmm5
  00104	0f 83 11 01 00
	00		 jae	 $LN7@MissCheckP
  0010a	66 83 bb 96 00
	00 00 00	 cmp	 WORD PTR [ebx+150], 0
  00112	0f 8e 03 01 00
	00		 jle	 $LN7@MissCheckP
  00118	66 83 be 96 00
	00 00 00	 cmp	 WORD PTR [esi+150], 0
  00120	0f 8e f5 00 00
	00		 jle	 $LN7@MissCheckP

; 1707 : 
; 1708 : 	iAttackRate += (float)(lpObj->m_ItemOptionExFor380.OpAddAttackSuccessRatePVP);
; 1709 : 	iDefenseRate += (float)(lpTargetObj->m_ItemOptionExFor380.OpAddDefenseSuccessRatePvP);
; 1710 : 
; 1711 : 	iAttackRate += (float)(lpObj->m_JewelOfHarmonyEffect.HJOpAddAttackSuccessRatePVP);
; 1712 : 	iDefenseRate += (float)(lpTargetObj->m_JewelOfHarmonyEffect.HJOpAddDefenseSuccessRatePvP);
; 1713 : 
; 1714 : 	iAttackRate += lpObj->m_MPSkillOpt.MpsPVPAttackDmgRate;

  00126	0f bf 83 52 24
	00 00		 movsx	 eax, WORD PTR [ebx+9298]

; 1715 : 	iDefenseRate += lpTargetObj->m_MPSkillOpt.MpsPVPBlockingRate;
; 1716 : 
; 1717 : 	float iExpressionA = ( iAttackRate * 10000.0f ) / ( iAttackRate + iDefenseRate );	// #formula

  0012d	f3 0f 10 1d 00
	00 00 00	 movss	 xmm3, DWORD PTR __real@461c4000

; 1718 : 	float iExpressionB = ( Level * 10000.0f ) / ( Level + TargetLevel );	// #formula

  00135	8b 4d fc	 mov	 ecx, DWORD PTR _TargetLevel$1$[ebp]
  00138	66 0f 6e d0	 movd	 xmm2, eax
  0013c	0f bf 83 3a 24
	00 00		 movsx	 eax, WORD PTR [ebx+9274]
  00143	0f 5b d2	 cvtdq2ps xmm2, xmm2
  00146	66 0f 6e c0	 movd	 xmm0, eax

; 1719 : 
; 1720 : 	iExpressionA /= 10000.0f;
; 1721 : 	iExpressionB /= 10000.0f;
; 1722 : 
; 1723 : 	iAttackSuccessRate = (int)(100.0f * iExpressionA * g_fSuccessAttackRateOption * iExpressionB);

  0014a	0f bf 86 56 24
	00 00		 movsx	 eax, WORD PTR [esi+9302]
  00151	f3 0f 58 d1	 addss	 xmm2, xmm1
  00155	0f 5b c0	 cvtdq2ps xmm0, xmm0
  00158	66 0f 6e c8	 movd	 xmm1, eax
  0015c	0f bf 86 4c 24
	00 00		 movsx	 eax, WORD PTR [esi+9292]
  00163	f3 0f 58 d0	 addss	 xmm2, xmm0
  00167	0f 5b c9	 cvtdq2ps xmm1, xmm1
  0016a	66 0f 6e c0	 movd	 xmm0, eax
  0016e	8d 04 39	 lea	 eax, DWORD PTR [ecx+edi]
  00171	f3 0f 58 93 c0
	06 00 00	 addss	 xmm2, DWORD PTR [ebx+1728]
  00179	f3 0f 58 cd	 addss	 xmm1, xmm5

; 1724 : 
; 1725 : 	if ( (TargetLevel - Level) >= 100 )

  0017d	2b 4d f8	 sub	 ecx, DWORD PTR _Level$1$[ebp]
  00180	0f 5b c0	 cvtdq2ps xmm0, xmm0
  00183	0f 28 e2	 movaps	 xmm4, xmm2
  00186	f3 0f 59 e3	 mulss	 xmm4, xmm3
  0018a	f3 0f 58 c8	 addss	 xmm1, xmm0
  0018e	66 0f 6e c0	 movd	 xmm0, eax
  00192	0f 5b c0	 cvtdq2ps xmm0, xmm0
  00195	f3 0f 58 8e c4
	06 00 00	 addss	 xmm1, DWORD PTR [esi+1732]
  0019d	f3 0f 58 ca	 addss	 xmm1, xmm2
  001a1	f3 0f 5e e1	 divss	 xmm4, xmm1
  001a5	66 0f 6e cf	 movd	 xmm1, edi
  001a9	0f 5b c9	 cvtdq2ps xmm1, xmm1
  001ac	f3 0f 5e e3	 divss	 xmm4, xmm3
  001b0	f3 0f 59 cb	 mulss	 xmm1, xmm3
  001b4	f3 0f 59 25 00
	00 00 00	 mulss	 xmm4, DWORD PTR __real@42c80000
  001bc	f3 0f 5e c8	 divss	 xmm1, xmm0
  001c0	f3 0f 59 25 00
	00 00 00	 mulss	 xmm4, DWORD PTR ?g_fSuccessAttackRateOption@@3MA
  001c8	f3 0f 5e cb	 divss	 xmm1, xmm3
  001cc	f3 0f 59 e1	 mulss	 xmm4, xmm1
  001d0	f3 0f 2c fc	 cvttss2si edi, xmm4
  001d4	83 f9 64	 cmp	 ecx, 100		; 00000064H
  001d7	7c 05		 jl	 SHORT $LN8@MissCheckP

; 1726 : 	{
; 1727 : 		iAttackSuccessRate -= 5;

  001d9	83 ef 05	 sub	 edi, 5
  001dc	eb 18		 jmp	 SHORT $LN12@MissCheckP
$LN8@MissCheckP:

; 1728 : 	}
; 1729 : 	else if ( (TargetLevel - Level) >= 200 )

  001de	81 f9 c8 00 00
	00		 cmp	 ecx, 200		; 000000c8H
  001e4	7c 05		 jl	 SHORT $LN10@MissCheckP

; 1730 : 	{
; 1731 : 		iAttackSuccessRate -= 10;

  001e6	83 ef 0a	 sub	 edi, 10			; 0000000aH
  001e9	eb 0b		 jmp	 SHORT $LN12@MissCheckP
$LN10@MissCheckP:

; 1732 : 	}
; 1733 : 	else if ( (TargetLevel - Level) >= 300 )

  001eb	81 f9 2c 01 00
	00		 cmp	 ecx, 300		; 0000012cH
  001f1	7c 03		 jl	 SHORT $LN12@MissCheckP

; 1734 : 	{
; 1735 : 		iAttackSuccessRate -= 15;

  001f3	83 ef 0f	 sub	 edi, 15			; 0000000fH
$LN12@MissCheckP:

; 1736 : 	}
; 1737 : 
; 1738 : 	int iRate = rand() % 100;

  001f6	e8 00 00 00 00	 call	 _rand
  001fb	99		 cdq
  001fc	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  00201	f7 f9		 idiv	 ecx

; 1739 : 
; 1740 : 	if ( iRate > iAttackSuccessRate )

  00203	3b d7		 cmp	 edx, edi
  00205	7e 1f		 jle	 SHORT $LN13@MissCheckP

; 1741 : 	{
; 1742 : 		GCDamageSend(lpObj->m_Index, lpTargetObj->m_Index, 0, 0, 0, 0);

  00207	6a 00		 push	 0
  00209	6a 00		 push	 0
  0020b	6a 00		 push	 0
  0020d	6a 00		 push	 0
  0020f	ff 36		 push	 DWORD PTR [esi]
  00211	ff 33		 push	 DWORD PTR [ebx]
  00213	e8 00 00 00 00	 call	 ?GCDamageSend@@YAXHHHHHH@Z ; GCDamageSend
  00218	83 c4 18	 add	 esp, 24			; 00000018H
$LN7@MissCheckP:

; 1706 : 		return FALSE;

  0021b	5f		 pop	 edi
  0021c	5e		 pop	 esi
  0021d	33 c0		 xor	 eax, eax
  0021f	5b		 pop	 ebx

; 1747 : }

  00220	8b e5		 mov	 esp, ebp
  00222	5d		 pop	 ebp
  00223	c2 14 00	 ret	 20			; 00000014H
$LN13@MissCheckP:
  00226	5f		 pop	 edi
  00227	5e		 pop	 esi

; 1743 : 		return FALSE;
; 1744 : 	}
; 1745 : 
; 1746 : 	return TRUE;

  00228	b8 01 00 00 00	 mov	 eax, 1
  0022d	5b		 pop	 ebx

; 1747 : }

  0022e	8b e5		 mov	 esp, ebp
  00230	5d		 pop	 ebp
  00231	c2 14 00	 ret	 20			; 00000014H
?MissCheckPvP@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0HHAAH@Z ENDP ; CDarkSpirit::MissCheckPvP
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
;	COMDAT ?MissCheck@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0HHAAH@Z
_TEXT	SEGMENT
_this$1$ = -28						; size = 4
__$SEHRec$ = -24					; size = 24
_lpObj$ = 8						; size = 4
_TargetSuccessfulBlocking$1$ = 12			; size = 4
_lpTargetObj$ = 12					; size = 4
_skill$ = 16						; size = 4
_skillSuccess$ = 20					; size = 4
_bAllMiss$ = 24						; size = 4
?MissCheck@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0HHAAH@Z PROC ; CDarkSpirit::MissCheck, COMDAT
; _this$ = ecx

; 1543 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	6a fe		 push	 -2			; fffffffeH
  00005	68 00 00 00 00	 push	 OFFSET __sehtable$?MissCheck@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0HHAAH@Z
  0000a	68 00 00 00 00	 push	 OFFSET __except_handler4
  0000f	64 a1 00 00 00
	00		 mov	 eax, DWORD PTR fs:0
  00015	50		 push	 eax
  00016	83 ec 0c	 sub	 esp, 12			; 0000000cH
  00019	53		 push	 ebx
  0001a	56		 push	 esi
  0001b	57		 push	 edi
  0001c	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  00021	31 45 f8	 xor	 DWORD PTR __$SEHRec$[ebp+16], eax
  00024	33 c5		 xor	 eax, ebp
  00026	50		 push	 eax
  00027	8d 45 f0	 lea	 eax, DWORD PTR __$SEHRec$[ebp+8]
  0002a	64 a3 00 00 00
	00		 mov	 DWORD PTR fs:0, eax
  00030	89 65 e8	 mov	 DWORD PTR __$SEHRec$[ebp], esp
  00033	8b c1		 mov	 eax, ecx
  00035	89 45 e4	 mov	 DWORD PTR _this$1$[ebp], eax

; 1544 : #if(__NOVUS__==1)
; 1545 : 	if( lpObj->Type == OBJ_MONSTER && lpTargetObj->Type == OBJ_USER )
; 1546 : 	{
; 1547 : 		if( g_SoulSystem.IsMap(lpTargetObj->MapNumber) && !g_SoulSystem.WithSoul(lpTargetObj) )
; 1548 : 		{
; 1549 : 			LogAddC(2, "[DEBUG] [SoulSystem] [%s] Miss ignored", lpTargetObj->Name);
; 1550 : 			return 1;
; 1551 : 		}
; 1552 : 	}
; 1553 : #endif
; 1554 : 	__try

  00038	9b		 fwait
  00039	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR __$SEHRec$[ebp+20], 0

; 1555 : 	{
; 1556 : 		int SuccessAttackRate = 0;
; 1557 : 		int TargetSuccessfulBlocking = lpTargetObj->m_SuccessfulBlocking;

  00040	8b 75 0c	 mov	 esi, DWORD PTR _lpTargetObj$[ebp]
  00043	8b 8e 7c 06 00
	00		 mov	 ecx, DWORD PTR [esi+1660]
  00049	89 4d 0c	 mov	 DWORD PTR _TargetSuccessfulBlocking$1$[ebp], ecx

; 1563 : 		{
; 1564 : 			bAllMiss = TRUE;

  0004c	8b 5d 18	 mov	 ebx, DWORD PTR _bAllMiss$[ebp]

; 1558 : 		int MsgDamage = 0;
; 1559 : 
; 1560 : 		SuccessAttackRate += lpObj->m_MPSkillOpt.MpsAttackSuccessRate;
; 1561 : 
; 1562 : 		if ( this->m_SuccessAttackRate < TargetSuccessfulBlocking )

  0004f	39 48 10	 cmp	 DWORD PTR [eax+16], ecx
  00052	7d 06		 jge	 SHORT $LN3@MissCheck

; 1563 : 		{
; 1564 : 			bAllMiss = TRUE;

  00054	c7 03 01 00 00
	00		 mov	 DWORD PTR [ebx], 1
$LN3@MissCheck:

; 1565 : 		}
; 1566 : 
; 1567 : 		if ( IT_MAP_RANGE(lpTargetObj->MapNumber) && g_IllusionTemple.GetState(lpTargetObj->MapNumber) == 2 )

  0005a	8a 8e 23 01 00
	00		 mov	 cl, BYTE PTR [esi+291]
  00060	80 f9 2d	 cmp	 cl, 45			; 0000002dH
  00063	72 7f		 jb	 SHORT $LN22@MissCheck
  00065	b0 32		 mov	 al, 50			; 00000032H
  00067	3a c1		 cmp	 al, cl
  00069	1b c0		 sbb	 eax, eax
  0006b	83 c0 01	 add	 eax, 1
  0006e	74 74		 je	 SHORT $LN22@MissCheck
  00070	51		 push	 ecx
  00071	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_IllusionTemple@@3VCIllusionTempleEvent@@A ; g_IllusionTemple
  00076	e8 00 00 00 00	 call	 ?GetState@CIllusionTempleEvent@@QAEEE@Z ; CIllusionTempleEvent::GetState
  0007b	3c 02		 cmp	 al, 2
  0007d	75 65		 jne	 SHORT $LN22@MissCheck

; 1568 : 		{
; 1569 : 			if( lpTargetObj->Type == OBJ_USER )

  0007f	80 7e 50 01	 cmp	 BYTE PTR [esi+80], 1
  00083	75 38		 jne	 SHORT $LN6@MissCheck

; 1570 : 			{
; 1571 : 				if( g_IllusionTemple.Is1stSkillActive(lpTargetObj->iTempleIndex,lpTargetObj->MapNumber) )

  00085	0f b6 86 23 01
	00 00		 movzx	 eax, BYTE PTR [esi+291]
  0008c	50		 push	 eax
  0008d	ff b6 78 24 00
	00		 push	 DWORD PTR [esi+9336]
  00093	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_IllusionTemple@@3VCIllusionTempleEvent@@A ; g_IllusionTemple
  00098	e8 00 00 00 00	 call	 ?Is1stSkillActive@CIllusionTempleEvent@@QAEHHE@Z ; CIllusionTempleEvent::Is1stSkillActive
  0009d	85 c0		 test	 eax, eax
  0009f	74 1c		 je	 SHORT $LN6@MissCheck

; 1572 : 				{
; 1573 : 					GCDamageSend(lpObj->m_Index, lpTargetObj->m_Index, 0, 0, 0, 0);

  000a1	6a 00		 push	 0
  000a3	6a 00		 push	 0
  000a5	6a 00		 push	 0
  000a7	6a 00		 push	 0
  000a9	ff 36		 push	 DWORD PTR [esi]
  000ab	8b 45 08	 mov	 eax, DWORD PTR _lpObj$[ebp]
  000ae	ff 30		 push	 DWORD PTR [eax]
  000b0	e8 00 00 00 00	 call	 ?GCDamageSend@@YAXHHHHHH@Z ; GCDamageSend
  000b5	83 c4 18	 add	 esp, 24			; 00000018H

; 1574 : 					return FALSE;

  000b8	e9 96 00 00 00	 jmp	 $LN24@MissCheck
$LN6@MissCheck:

; 1575 : 				}
; 1576 : 			}
; 1577 : 
; 1578 : 			if( lpObj->PartyNumber == lpTargetObj->PartyNumber )

  000bd	8b 7d 08	 mov	 edi, DWORD PTR _lpObj$[ebp]
  000c0	8b 87 0c 06 00
	00		 mov	 eax, DWORD PTR [edi+1548]
  000c6	3b 86 0c 06 00
	00		 cmp	 eax, DWORD PTR [esi+1548]
  000cc	75 19		 jne	 SHORT $LN7@MissCheck
$LN25@MissCheck:

; 1579 : 			{
; 1580 : 				GCDamageSend(lpObj->m_Index, lpTargetObj->m_Index, 0, 0, 0, 0);

  000ce	6a 00		 push	 0
  000d0	6a 00		 push	 0
  000d2	6a 00		 push	 0
  000d4	6a 00		 push	 0
  000d6	ff 36		 push	 DWORD PTR [esi]
  000d8	ff 37		 push	 DWORD PTR [edi]
  000da	e8 00 00 00 00	 call	 ?GCDamageSend@@YAXHHHHHH@Z ; GCDamageSend
  000df	83 c4 18	 add	 esp, 24			; 00000018H

; 1581 : 				return FALSE;

  000e2	eb 6f		 jmp	 SHORT $LN24@MissCheck
$LN22@MissCheck:
  000e4	8b 7d 08	 mov	 edi, DWORD PTR _lpObj$[ebp]
$LN7@MissCheck:

; 1582 : 			}
; 1583 : 		}
; 1584 : 
; 1585 : 		if ( bAllMiss != FALSE )

  000e7	83 3b 00	 cmp	 DWORD PTR [ebx], 0
  000ea	74 28		 je	 SHORT $LN8@MissCheck

; 1586 : 		{
; 1587 : 			if ( (rand()%100) >= 5 )

  000ec	e8 00 00 00 00	 call	 _rand
  000f1	99		 cdq
  000f2	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  000f7	f7 f9		 idiv	 ecx
  000f9	83 fa 05	 cmp	 edx, 5
  000fc	7c 2d		 jl	 SHORT $LN12@MissCheck

; 1588 : 			{
; 1589 : 				GCDamageSend(lpObj->m_Index, lpTargetObj->m_Index, 0, 0, MsgDamage, 0);

  000fe	6a 00		 push	 0
  00100	6a 00		 push	 0
  00102	6a 00		 push	 0
  00104	6a 00		 push	 0
  00106	ff 36		 push	 DWORD PTR [esi]
  00108	ff 37		 push	 DWORD PTR [edi]
  0010a	e8 00 00 00 00	 call	 ?GCDamageSend@@YAXHHHHHH@Z ; GCDamageSend
  0010f	83 c4 18	 add	 esp, 24			; 00000018H

; 1590 : 				return FALSE;

  00112	eb 3f		 jmp	 SHORT $LN24@MissCheck
$LN8@MissCheck:

; 1591 : 			}
; 1592 : 		}
; 1593 : 		else if ( this->m_SuccessAttackRate )

  00114	8b 5d e4	 mov	 ebx, DWORD PTR _this$1$[ebp]
  00117	83 7b 10 00	 cmp	 DWORD PTR [ebx+16], 0
  0011b	74 0e		 je	 SHORT $LN12@MissCheck

; 1594 : 		{
; 1595 : 			if ( (rand()%this->m_SuccessAttackRate) < TargetSuccessfulBlocking)

  0011d	e8 00 00 00 00	 call	 _rand
  00122	99		 cdq
  00123	f7 7b 10	 idiv	 DWORD PTR [ebx+16]
  00126	3b 55 0c	 cmp	 edx, DWORD PTR _TargetSuccessfulBlocking$1$[ebp]
  00129	7c a3		 jl	 SHORT $LN25@MissCheck
$LN12@MissCheck:

; 1596 : 			{
; 1597 : 				GCDamageSend(lpObj->m_Index, lpTargetObj->m_Index, 0, 0, MsgDamage, 0);
; 1598 : 				return FALSE;
; 1599 : 			}
; 1600 : 		}
; 1601 : 	}

  0012b	9b		 fwait
  0012c	c7 45 fc fe ff
	ff ff		 mov	 DWORD PTR __$SEHRec$[ebp+20], -2 ; fffffffeH

; 1605 : 	}
; 1606 : 	return TRUE;

  00133	b8 01 00 00 00	 mov	 eax, 1

; 1607 : }

  00138	8b 4d f0	 mov	 ecx, DWORD PTR __$SEHRec$[ebp+8]
  0013b	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  00142	59		 pop	 ecx
  00143	5f		 pop	 edi
  00144	5e		 pop	 esi
  00145	5b		 pop	 ebx
  00146	8b e5		 mov	 esp, ebp
  00148	5d		 pop	 ebp
  00149	c2 14 00	 ret	 20			; 00000014H
$LN17@MissCheck:
$LN26@MissCheck:

; 1602 : 	__except (this->ModeNormal(),-1)

  0014c	83 c8 ff	 or	 eax, -1
$LN23@MissCheck:
$LN19@MissCheck:
  0014f	c3		 ret	 0
$LN18@MissCheck:
  00150	8b 65 e8	 mov	 esp, DWORD PTR __$SEHRec$[ebp]
$LN24@MissCheck:

; 1603 : 	{
; 1604 : 		return FALSE;

  00153	9b		 fwait
  00154	c7 45 fc fe ff
	ff ff		 mov	 DWORD PTR __$SEHRec$[ebp+20], -2 ; fffffffeH
  0015b	33 c0		 xor	 eax, eax

; 1607 : }

  0015d	8b 4d f0	 mov	 ecx, DWORD PTR __$SEHRec$[ebp+8]
  00160	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  00167	59		 pop	 ecx
  00168	5f		 pop	 edi
  00169	5e		 pop	 esi
  0016a	5b		 pop	 ebx
  0016b	8b e5		 mov	 esp, ebp
  0016d	5d		 pop	 ebp
  0016e	c2 14 00	 ret	 20			; 00000014H
?MissCheck@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0HHAAH@Z ENDP ; CDarkSpirit::MissCheck
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
;	COMDAT ?GetAttackDamage@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@HHHH@Z
_TEXT	SEGMENT
_lpObj$ = 8						; size = 4
_targetDefense$ = 12					; size = 4
_bIsOnDuel$ = 16					; size = 4
_crititcaldamage$ = 20					; size = 4
_excellentdamage$ = 24					; size = 4
?GetAttackDamage@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@HHHH@Z PROC ; CDarkSpirit::GetAttackDamage, COMDAT
; _this$ = ecx

; 1475 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 1476 : 	if ( g_ShieldSystemOn == TRUE )

  00003	83 3d 00 00 00
	00 01		 cmp	 DWORD PTR ?g_ShieldSystemOn@@3HA, 1 ; g_ShieldSystemOn
  0000a	53		 push	 ebx
  0000b	56		 push	 esi
  0000c	57		 push	 edi

; 1477 : 	{
; 1478 : 		if ( bIsOnDuel == TRUE )

  0000d	8b 7d 10	 mov	 edi, DWORD PTR _bIsOnDuel$[ebp]
  00010	8b d9		 mov	 ebx, ecx
  00012	75 08		 jne	 SHORT $LN3@GetAttackD
  00014	33 c0		 xor	 eax, eax
  00016	83 ff 01	 cmp	 edi, 1
  00019	0f 44 f8	 cmove	 edi, eax
$LN3@GetAttackD:

; 1479 : 		{
; 1480 : 			bIsOnDuel = FALSE;
; 1481 : 		}
; 1482 : 	}
; 1483 : 
; 1484 : 	int ad;
; 1485 : 	int sub = this->m_AttackDamageMax - this->m_AttackDamageMin;

  0001c	8b 73 08	 mov	 esi, DWORD PTR [ebx+8]
  0001f	8b 43 04	 mov	 eax, DWORD PTR [ebx+4]
  00022	2b f0		 sub	 esi, eax

; 1486 : 	int AttackDamage;
; 1487 : 
; 1488 : 	if ( crititcaldamage )

  00024	83 7d 14 00	 cmp	 DWORD PTR _crititcaldamage$[ebp], 0
  00028	74 04		 je	 SHORT $LN4@GetAttackD

; 1489 : 	{
; 1490 : 		AttackDamage = this->m_AttackDamageMin + sub;

  0002a	03 f0		 add	 esi, eax

; 1491 : 	}
; 1492 : 	else

  0002c	eb 10		 jmp	 SHORT $LN5@GetAttackD
$LN4@GetAttackD:

; 1493 : 	{
; 1494 : 		AttackDamage = this->m_AttackDamageMin + (rand()%(sub+1));

  0002e	e8 00 00 00 00	 call	 _rand
  00033	8d 4e 01	 lea	 ecx, DWORD PTR [esi+1]
  00036	99		 cdq
  00037	f7 f9		 idiv	 ecx
  00039	8b f2		 mov	 esi, edx
  0003b	03 73 04	 add	 esi, DWORD PTR [ebx+4]
$LN5@GetAttackD:

; 1495 : 	}
; 1496 : 
; 1497 : 	if( excellentdamage )

  0003e	83 7d 18 00	 cmp	 DWORD PTR _excellentdamage$[ebp], 0
  00042	74 19		 je	 SHORT $LN6@GetAttackD

; 1498 : 	{
; 1499 : 		AttackDamage += AttackDamage*20/100;

  00044	8d 0c b6	 lea	 ecx, DWORD PTR [esi+esi*4]
  00047	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  0004c	c1 e1 02	 shl	 ecx, 2
  0004f	f7 e9		 imul	 ecx
  00051	c1 fa 05	 sar	 edx, 5
  00054	8b c2		 mov	 eax, edx
  00056	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  00059	03 c2		 add	 eax, edx
  0005b	03 f0		 add	 esi, eax
$LN6@GetAttackD:

; 1500 : 	}
; 1501 : 
; 1502 : 	if ( ( lpObj->pInventory[0].m_Type >= ITEMGET(2,8) && lpObj->pInventory[0].m_Type <= ITEMGET(2,12) ) ||
; 1503 : 		   lpObj->pInventory[0].m_Type == ITEMGET(2,13) ||
; 1504 : 		   lpObj->pInventory[0].m_Type == ITEMGET(2,14) ||
; 1505 : 		   lpObj->pInventory[0].m_Type == ITEMGET(2,15) ||
; 1506 : 		   lpObj->pInventory[0].m_Type == ITEMGET(2,17) ||
; 1507 : 		   lpObj->pInventory[0].m_Type == ITEMGET(2,18) ||

  0005d	8b 5d 08	 mov	 ebx, DWORD PTR _lpObj$[ebp]
  00060	b9 08 04 00 00	 mov	 ecx, 1032		; 00000408H
  00065	8b 93 c0 11 00
	00		 mov	 edx, DWORD PTR [ebx+4544]
  0006b	0f b7 42 06	 movzx	 eax, WORD PTR [edx+6]
  0006f	66 3b c1	 cmp	 ax, cx
  00072	7c 0a		 jl	 SHORT $LN9@GetAttackD
  00074	b9 0c 04 00 00	 mov	 ecx, 1036		; 0000040cH
  00079	66 3b c1	 cmp	 ax, cx
  0007c	7e 3c		 jle	 SHORT $LN8@GetAttackD
$LN9@GetAttackD:
  0007e	b9 0d 04 00 00	 mov	 ecx, 1037		; 0000040dH
  00083	66 3b c1	 cmp	 ax, cx
  00086	74 32		 je	 SHORT $LN8@GetAttackD
  00088	b9 0e 04 00 00	 mov	 ecx, 1038		; 0000040eH
  0008d	66 3b c1	 cmp	 ax, cx
  00090	74 28		 je	 SHORT $LN8@GetAttackD
  00092	b9 0f 04 00 00	 mov	 ecx, 1039		; 0000040fH
  00097	66 3b c1	 cmp	 ax, cx
  0009a	74 1e		 je	 SHORT $LN8@GetAttackD
  0009c	b9 11 04 00 00	 mov	 ecx, 1041		; 00000411H
  000a1	66 3b c1	 cmp	 ax, cx
  000a4	74 14		 je	 SHORT $LN8@GetAttackD
  000a6	b9 12 04 00 00	 mov	 ecx, 1042		; 00000412H
  000ab	66 3b c1	 cmp	 ax, cx
  000ae	74 0a		 je	 SHORT $LN8@GetAttackD
  000b0	b9 13 04 00 00	 mov	 ecx, 1043		; 00000413H
  000b5	66 3b c1	 cmp	 ax, cx
  000b8	75 31		 jne	 SHORT $LN7@GetAttackD
$LN8@GetAttackD:

; 1508 : 		   lpObj->pInventory[0].m_Type == ITEMGET(2,19) )
; 1509 : 	{
; 1510 : 		int damage = lpObj->pInventory[0].m_Magic / 2;

  000ba	0f b7 4a 20	 movzx	 ecx, WORD PTR [edx+32]
  000be	d1 e9		 shr	 ecx, 1
  000c0	66 0f 6e c1	 movd	 xmm0, ecx

; 1511 : 		damage -= (int)(damage * lpObj->pInventory[0].m_CurrentDurabilityState);

  000c4	0f 5b c0	 cvtdq2ps xmm0, xmm0
  000c7	f3 0f 59 82 a4
	00 00 00	 mulss	 xmm0, DWORD PTR [edx+164]
  000cf	f3 0f 2c c0	 cvttss2si eax, xmm0
  000d3	2b c8		 sub	 ecx, eax

; 1512 : 		damage = AttackDamage * damage / 100;

  000d5	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  000da	0f af ce	 imul	 ecx, esi
  000dd	f7 e9		 imul	 ecx
  000df	c1 fa 05	 sar	 edx, 5
  000e2	8b c2		 mov	 eax, edx
  000e4	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  000e7	03 c2		 add	 eax, edx

; 1513 : 		AttackDamage += damage;

  000e9	03 f0		 add	 esi, eax
$LN7@GetAttackD:

; 1514 : 	}
; 1515 : 
; 1516 : 	if ( bIsOnDuel )

  000eb	85 ff		 test	 edi, edi
  000ed	74 1b		 je	 SHORT $LN10@GetAttackD

; 1517 : 	{
; 1518 : 		ad = AttackDamage * 60 / 100 - targetDefense;

  000ef	8b ce		 mov	 ecx, esi
  000f1	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  000f6	c1 e1 04	 shl	 ecx, 4
  000f9	2b ce		 sub	 ecx, esi
  000fb	c1 e1 02	 shl	 ecx, 2
  000fe	f7 e9		 imul	 ecx
  00100	c1 fa 05	 sar	 edx, 5
  00103	8b f2		 mov	 esi, edx
  00105	c1 ee 1f	 shr	 esi, 31			; 0000001fH
  00108	03 f2		 add	 esi, edx
$LN10@GetAttackD:

; 1519 : 	}
; 1520 : 	else
; 1521 : 	{
; 1522 : 		ad = AttackDamage - targetDefense;
; 1523 : 	}
; 1524 : 
; 1525 : 	if( lpObj->m_MPSkillOpt.MpsDarkSpiritStr1 > 0.0f )

  0010a	f3 0f 10 8b a8
	07 00 00	 movss	 xmm1, DWORD PTR [ebx+1960]
  00112	0f 57 d2	 xorps	 xmm2, xmm2
  00115	2b 75 0c	 sub	 esi, DWORD PTR _targetDefense$[ebp]
  00118	0f 2f ca	 comiss	 xmm1, xmm2
  0011b	76 0f		 jbe	 SHORT $LN12@GetAttackD

; 1526 : 	{
; 1527 : 		ad+= lpObj->m_MPSkillOpt.MpsDarkSpiritStr1;

  0011d	66 0f 6e c6	 movd	 xmm0, esi
  00121	0f 5b c0	 cvtdq2ps xmm0, xmm0
  00124	f3 0f 58 c1	 addss	 xmm0, xmm1
  00128	f3 0f 2c f0	 cvttss2si esi, xmm0
$LN12@GetAttackD:

; 1528 : 	}
; 1529 : 
; 1530 : 	if( lpObj->m_MPSkillOpt.MpsUseScepterPetStr > 0.0f )

  0012c	f3 0f 10 8b c4
	07 00 00	 movss	 xmm1, DWORD PTR [ebx+1988]
  00134	0f 2f ca	 comiss	 xmm1, xmm2
  00137	76 16		 jbe	 SHORT $LN15@GetAttackD

; 1531 : 	{
; 1532 : 		ad+= lpObj->m_MPSkillOpt.MpsUseScepterPetStr;

  00139	66 0f 6e c6	 movd	 xmm0, esi
  0013d	0f 5b c0	 cvtdq2ps xmm0, xmm0
  00140	5f		 pop	 edi
  00141	5e		 pop	 esi
  00142	5b		 pop	 ebx
  00143	f3 0f 58 c1	 addss	 xmm0, xmm1
  00147	f3 0f 2c c0	 cvttss2si eax, xmm0

; 1536 : }

  0014b	5d		 pop	 ebp
  0014c	c2 14 00	 ret	 20			; 00000014H
$LN15@GetAttackD:
  0014f	5f		 pop	 edi

; 1533 : 	}
; 1534 : 
; 1535 : 	return ad;

  00150	8b c6		 mov	 eax, esi
  00152	5e		 pop	 esi
  00153	5b		 pop	 ebx

; 1536 : }

  00154	5d		 pop	 ebp
  00155	c2 14 00	 ret	 20			; 00000014H
?GetAttackDamage@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@HHHH@Z ENDP ; CDarkSpirit::GetAttackDamage
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
;	COMDAT ?Attack@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0PAVCMagicInf@@HH@Z
_TEXT	SEGMENT
_bIsOnDuel$1$ = -24					; size = 4
_MSBFlag$1$ = -20					; size = 4
_ManaChange$1$ = -16					; size = 4
_iTotalShieldDamage$1$ = -12				; size = 4
_MsgDamage$ = -8					; size = 4
_this$1$ = -4						; size = 4
_skill$1$ = 8						; size = 4
_lpObj$ = 8						; size = 4
_AttackDamage$1$ = 12					; size = 4
_targetdefense$1$ = 12					; size = 4
_lpCallObj$1$ = 12					; size = 4
_EffectVal2$1 = 12					; size = 4
_lpTargetObj$ = 12					; size = 4
_EffectVal1$1$ = 16					; size = 4
_bAllMiss$ = 16						; size = 4
_lpMagic$ = 16						; size = 4
_selfdefense$2$ = 20					; size = 4
_EffectVal1$2 = 20					; size = 4
_criticaldamage$ = 20					; size = 4
_iActionType$ = 24					; size = 4
?Attack@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0PAVCMagicInf@@HH@Z PROC ; CDarkSpirit::Attack, COMDAT
; _this$ = ecx

; 665  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 18	 sub	 esp, 24			; 00000018H
  00006	56		 push	 esi
  00007	57		 push	 edi

; 666  : 	int skillSuccess = 0;
; 667  : 	LPOBJ lpCallObj;
; 668  : 	LPOBJ lpCallTargetObj;
; 669  : 	int MsgDamage = 0;
; 670  : 	int ManaChange = 0;
; 671  : 	int iTempShieldDamage = 0;
; 672  : 	int iTotalShieldDamage = 0;
; 673  : 
; 674  : 	if ( (lpTargetObj->Authority&2) == 2 )

  00008	8b 7d 0c	 mov	 edi, DWORD PTR _lpTargetObj$[ebp]
  0000b	8b f1		 mov	 esi, ecx
  0000d	89 75 fc	 mov	 DWORD PTR _this$1$[ebp], esi
  00010	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _MsgDamage$[ebp], 0
  00017	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _ManaChange$1$[ebp], 0
  0001e	f6 87 bc 01 00
	00 02		 test	 BYTE PTR [edi+444], 2
  00025	c7 45 f4 00 00
	00 00		 mov	 DWORD PTR _iTotalShieldDamage$1$[ebp], 0
  0002c	74 0a		 je	 SHORT $LN2@Attack

; 675  : 		return FALSE;

  0002e	5f		 pop	 edi
  0002f	33 c0		 xor	 eax, eax
  00031	5e		 pop	 esi

; 1468 : }

  00032	8b e5		 mov	 esp, ebp
  00034	5d		 pop	 ebp
  00035	c2 14 00	 ret	 20			; 00000014H
$LN2@Attack:
  00038	53		 push	 ebx

; 676  : 
; 677  : 	if ( lpObj->MapNumber != lpTargetObj->MapNumber )

  00039	8b 5d 08	 mov	 ebx, DWORD PTR _lpObj$[ebp]
  0003c	8a 83 23 01 00
	00		 mov	 al, BYTE PTR [ebx+291]
  00042	3a 87 23 01 00
	00		 cmp	 al, BYTE PTR [edi+291]
  00048	0f 85 7a 02 00
	00		 jne	 $LN257@Attack

; 678  : 		return FALSE;
; 679  : 
; 680  : #if (__GENS_SYSTEM__ == 1)
; 681  : 	if (gGensSystem.GetFriendlyFire() && gGensSystem.GensMap(lpObj->MapNumber)) {

  0004e	80 3d 38 00 00
	00 00		 cmp	 BYTE PTR ?gGensSystem@@3VCGensSystem@@A+56, 0
  00055	74 30		 je	 SHORT $LN5@Attack
  00057	0f b6 c0	 movzx	 eax, al
  0005a	b9 00 00 00 00	 mov	 ecx, OFFSET ?gGensSystem@@3VCGensSystem@@A ; gGensSystem
  0005f	50		 push	 eax
  00060	e8 00 00 00 00	 call	 ?GensMap@CGensSystem@@QAEHH@Z ; CGensSystem::GensMap
  00065	85 c0		 test	 eax, eax
  00067	74 1e		 je	 SHORT $LN5@Attack

; 682  : 		if (lpObj->Type == OBJ_USER && lpTargetObj->Type == OBJ_USER
; 683  : 			&& lpObj->m_GensInfo.btFamily == lpTargetObj->m_GensInfo.btFamily) {

  00069	80 7b 50 01	 cmp	 BYTE PTR [ebx+80], 1
  0006d	75 18		 jne	 SHORT $LN5@Attack
  0006f	80 7f 50 01	 cmp	 BYTE PTR [edi+80], 1
  00073	75 12		 jne	 SHORT $LN5@Attack
  00075	8a 83 ac 26 00
	00		 mov	 al, BYTE PTR [ebx+9900]
  0007b	3a 87 ac 26 00
	00		 cmp	 al, BYTE PTR [edi+9900]
  00081	0f 84 41 02 00
	00		 je	 $LN257@Attack
$LN5@Attack:

; 684  : 			return false;
; 685  : 		}
; 686  : 	}
; 687  : #endif
; 688  : 
; 689  : 	if ( IF_MAP_RANGE(lpObj->MapNumber) && !g_ImperialGuardian.IsAttackAbleMonster(lpTargetObj->m_Index) )

  00087	8a 83 23 01 00
	00		 mov	 al, BYTE PTR [ebx+291]
  0008d	3c 45		 cmp	 al, 69			; 00000045H
  0008f	72 1f		 jb	 SHORT $LN6@Attack
  00091	b1 48		 mov	 cl, 72			; 00000048H
  00093	3a c8		 cmp	 cl, al
  00095	1b c0		 sbb	 eax, eax
  00097	83 c0 01	 add	 eax, 1
  0009a	74 14		 je	 SHORT $LN6@Attack
  0009c	ff 37		 push	 DWORD PTR [edi]
  0009e	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_ImperialGuardian@@3VCImperialGuardian@@A ; g_ImperialGuardian
  000a3	e8 00 00 00 00	 call	 ?IsAttackAbleMonster@CImperialGuardian@@QAE_NH@Z ; CImperialGuardian::IsAttackAbleMonster
  000a8	84 c0		 test	 al, al
  000aa	0f 84 18 02 00
	00		 je	 $LN257@Attack
$LN6@Attack:

; 690  : 		return FALSE;
; 691  : 
; 692  : 	if ( lpObj->MapNumber == MAP_INDEX_PKFIELD && lpObj->m_iDuelUser == -1)

  000b0	80 bb 23 01 00
	00 40		 cmp	 BYTE PTR [ebx+291], 64	; 00000040H
  000b7	75 0d		 jne	 SHORT $LN7@Attack
  000b9	83 bb 50 12 00
	00 ff		 cmp	 DWORD PTR [ebx+4688], -1
  000c0	0f 84 02 02 00
	00		 je	 $LN257@Attack
$LN7@Attack:

; 693  : 		return FALSE;
; 694  : 	
; 695  : #if (GS_CASTLE == 1)
; 696  : 	if(g_Crywolf.GetCrywolfState() == CRYWOLF_STATE_READY || g_Crywolf.GetCrywolfState() == CRYWOLF_STATE_END)

  000c6	a1 8c a8 0f 00	 mov	 eax, DWORD PTR ?g_Crywolf@@3VCCrywolf@@A+1026188
  000cb	83 f8 03	 cmp	 eax, 3
  000ce	74 05		 je	 SHORT $LN9@Attack
  000d0	83 f8 05	 cmp	 eax, 5
  000d3	75 13		 jne	 SHORT $LN10@Attack
$LN9@Attack:

; 697  : 	{
; 698  : 		if( ((lpTargetObj->MapNumber == MAP_INDEX_CRYWOLF_FIRSTZONE) ? TRUE : FALSE) && lpTargetObj->Type == OBJ_MONSTER)

  000d5	80 bf 23 01 00
	00 22		 cmp	 BYTE PTR [edi+291], 34	; 00000022H
  000dc	75 0a		 jne	 SHORT $LN10@Attack
  000de	80 7f 50 02	 cmp	 BYTE PTR [edi+80], 2
  000e2	0f 84 e0 01 00
	00		 je	 $LN257@Attack
$LN10@Attack:

; 699  : 		{
; 700  : 			return FALSE;
; 701  : 		}
; 702  : 	}
; 703  : #endif
; 704  : 
; 705  : 	int skill = 0;
; 706  : 	
; 707  : 	if ( lpMagic )

  000e8	8b 45 10	 mov	 eax, DWORD PTR _lpMagic$[ebp]
  000eb	c7 45 08 00 00
	00 00		 mov	 DWORD PTR _skill$1$[ebp], 0
  000f2	85 c0		 test	 eax, eax
  000f4	74 06		 je	 SHORT $LN11@Attack

; 708  : 		skill = lpMagic->m_Skill;

  000f6	8b 40 08	 mov	 eax, DWORD PTR [eax+8]
  000f9	89 45 08	 mov	 DWORD PTR _skill$1$[ebp], eax
$LN11@Attack:

; 709  : 
; 710  : 	skillSuccess = TRUE;
; 711  : 
; 712  : 	if ( lpObj->GuildNumber > 0 )

  000fc	83 bb 14 06 00
	00 00		 cmp	 DWORD PTR [ebx+1556], 0
  00103	7e 2e		 jle	 SHORT $LN16@Attack

; 713  : 	{
; 714  : 		if ( lpObj->lpGuild )

  00105	8b 83 18 06 00
	00		 mov	 eax, DWORD PTR [ebx+1560]
  0010b	85 c0		 test	 eax, eax
  0010d	74 24		 je	 SHORT $LN16@Attack

; 715  : 		{
; 716  : 			if ( lpObj->lpGuild->WarState )

  0010f	80 b8 91 05 00
	00 00		 cmp	 BYTE PTR [eax+1425], 0
  00116	74 1b		 je	 SHORT $LN16@Attack

; 717  : 			{
; 718  : 				if ( lpObj->lpGuild->WarType == 1 )

  00118	80 b8 92 05 00
	00 01		 cmp	 BYTE PTR [eax+1426], 1
  0011f	75 12		 jne	 SHORT $LN16@Attack

; 719  : 				{
; 720  : 					if ( !GetBattleSoccerGoalMove(0) )

  00121	6a 00		 push	 0
  00123	e8 00 00 00 00	 call	 ?GetBattleSoccerGoalMove@@YAHH@Z ; GetBattleSoccerGoalMove
  00128	83 c4 04	 add	 esp, 4
  0012b	85 c0		 test	 eax, eax
  0012d	0f 84 24 0f 00
	00		 je	 $LN188@Attack
$LN16@Attack:

; 721  : 					{
; 722  : 						return TRUE;
; 723  : 					}
; 724  : 				}
; 725  : 			}
; 726  : 		}
; 727  : 	}
; 728  : 
; 729  : 	if ( lpTargetObj->Type == OBJ_MONSTER )

  00133	80 7f 50 02	 cmp	 BYTE PTR [edi+80], 2
  00137	75 4a		 jne	 SHORT $LN18@Attack

; 730  : 	{
; 731  : 		if ( lpTargetObj->Class == 200 )

  00139	b8 c8 00 00 00	 mov	 eax, 200		; 000000c8H
  0013e	66 39 87 90 00
	00 00		 cmp	 WORD PTR [edi+144], ax
  00145	75 3c		 jne	 SHORT $LN18@Attack

; 732  : 		{
; 733  : 			if ( skill )

  00147	83 7d 08 00	 cmp	 DWORD PTR _skill$1$[ebp], 0

; 734  : 			{
; 735  : 				gObjMonsterStateProc(lpTargetObj, 7, lpObj->m_Index, 0);

  0014b	6a 00		 push	 0
  0014d	ff 33		 push	 DWORD PTR [ebx]
  0014f	74 19		 je	 SHORT $LN19@Attack
  00151	6a 07		 push	 7

; 736  : 			}
; 737  : 			else
; 738  : 			{
; 739  : 				gObjMonsterStateProc(lpTargetObj, 6, lpObj->m_Index, 0);

  00153	57		 push	 edi
  00154	e8 00 00 00 00	 call	 ?gObjMonsterStateProc@@YAXPAUOBJECTSTRUCT@@HHH@Z ; gObjMonsterStateProc
  00159	83 c4 10	 add	 esp, 16			; 00000010H

; 1464 : 		}
; 1465 : 	}
; 1466 : 
; 1467 : 	return TRUE;

  0015c	b8 01 00 00 00	 mov	 eax, 1
  00161	5b		 pop	 ebx
  00162	5f		 pop	 edi
  00163	5e		 pop	 esi

; 1468 : }

  00164	8b e5		 mov	 esp, ebp
  00166	5d		 pop	 ebp
  00167	c2 14 00	 ret	 20			; 00000014H
$LN19@Attack:

; 736  : 			}
; 737  : 			else
; 738  : 			{
; 739  : 				gObjMonsterStateProc(lpTargetObj, 6, lpObj->m_Index, 0);

  0016a	6a 06		 push	 6
  0016c	57		 push	 edi
  0016d	e8 00 00 00 00	 call	 ?gObjMonsterStateProc@@YAXPAUOBJECTSTRUCT@@HHH@Z ; gObjMonsterStateProc
  00172	83 c4 10	 add	 esp, 16			; 00000010H

; 1464 : 		}
; 1465 : 	}
; 1466 : 
; 1467 : 	return TRUE;

  00175	b8 01 00 00 00	 mov	 eax, 1
  0017a	5b		 pop	 ebx
  0017b	5f		 pop	 edi
  0017c	5e		 pop	 esi

; 1468 : }

  0017d	8b e5		 mov	 esp, ebp
  0017f	5d		 pop	 ebp
  00180	c2 14 00	 ret	 20			; 00000014H
$LN18@Attack:

; 740  : 			}
; 741  : 
; 742  : 			return TRUE;
; 743  : 		}
; 744  : 	}
; 745  : 
; 746  : 	if ( lpObj->Type == OBJ_USER )

  00183	80 7b 50 01	 cmp	 BYTE PTR [ebx+80], 1
  00187	75 11		 jne	 SHORT $LN22@Attack

; 747  : 	{
; 748  : 		if ( !gObjIsConnected(lpObj))

  00189	53		 push	 ebx
  0018a	e8 00 00 00 00	 call	 ?gObjIsConnected@@YAHPAUOBJECTSTRUCT@@@Z ; gObjIsConnected
  0018f	83 c4 04	 add	 esp, 4
  00192	85 c0		 test	 eax, eax
  00194	0f 84 2e 01 00
	00		 je	 $LN257@Attack
$LN22@Attack:

; 749  : 		{
; 750  : 			return FALSE;
; 751  : 		}
; 752  : 	}
; 753  : 
; 754  : 	if ( lpTargetObj->Type == OBJ_USER )

  0019a	80 7f 50 01	 cmp	 BYTE PTR [edi+80], 1
  0019e	75 11		 jne	 SHORT $LN24@Attack

; 755  : 	{
; 756  : 		if ( !gObjIsConnected(lpTargetObj))

  001a0	57		 push	 edi
  001a1	e8 00 00 00 00	 call	 ?gObjIsConnected@@YAHPAUOBJECTSTRUCT@@@Z ; gObjIsConnected
  001a6	83 c4 04	 add	 esp, 4
  001a9	85 c0		 test	 eax, eax
  001ab	0f 84 17 01 00
	00		 je	 $LN257@Attack
$LN24@Attack:

; 757  : 		{
; 758  : 			return FALSE;
; 759  : 		}
; 760  : 	}
; 761  : 
; 762  : 	if ( lpObj->Type == OBJ_USER && lpTargetObj->Type == OBJ_MONSTER )	// PLAYER VS MONSTER

  001b1	80 7b 50 01	 cmp	 BYTE PTR [ebx+80], 1
  001b5	75 18		 jne	 SHORT $LN27@Attack
  001b7	80 7f 50 02	 cmp	 BYTE PTR [edi+80], 2
  001bb	75 12		 jne	 SHORT $LN27@Attack

; 763  : 	{
; 764  : 		if ( lpObj->m_RecallMon >= 0 )

  001bd	8b 83 30 06 00
	00		 mov	 eax, DWORD PTR [ebx+1584]
  001c3	85 c0		 test	 eax, eax
  001c5	78 08		 js	 SHORT $LN27@Attack

; 765  : 		{
; 766  : 			if ( lpObj->m_RecallMon == lpTargetObj->m_Index )

  001c7	3b 07		 cmp	 eax, DWORD PTR [edi]
  001c9	0f 84 f9 00 00
	00		 je	 $LN257@Attack
$LN27@Attack:

; 767  : 			{
; 768  : 				return FALSE;
; 769  : 			}
; 770  : 		}
; 771  : 	}
; 772  : 
; 773  : 	if ( !gObjAttackQ(lpTargetObj))

  001cf	57		 push	 edi
  001d0	e8 00 00 00 00	 call	 ?gObjAttackQ@@YAHPAUOBJECTSTRUCT@@@Z ; gObjAttackQ
  001d5	83 c4 04	 add	 esp, 4
  001d8	85 c0		 test	 eax, eax
  001da	0f 84 e8 00 00
	00		 je	 $LN257@Attack

; 774  : 		return FALSE;
; 775  : 
; 776  : #if (ENABLETEST_ARCA == 1)
; 777  : 	if ( g_ArcaBattle.IsArcaBattleServer() && !g_AcheronGuardianEvent.IsPlayStart()
; 778  :       && !g_ArcaBattle.IsEnableAttackObelisk(*lpObj, lpTargetObj->Class))
; 779  :       return 0;
; 780  : #endif
; 781  : 
; 782  : #if (GS_CASTLE == 1)
; 783  : 
; 784  : 	if ( g_CastleSiege.GetCastleState() == CASTLESIEGE_STATE_STARTSIEGE 
; 785  : 		&& lpObj->m_btCsJoinSide > 0
; 786  : 		&& lpObj->m_btCsJoinSide == lpTargetObj->m_btCsJoinSide)

  001e0	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_CastleSiege@@3VCCastleSiege@@A ; g_CastleSiege
  001e5	e8 00 00 00 00	 call	 ?GetCastleState@CCastleSiege@@QAEHXZ ; CCastleSiege::GetCastleState
  001ea	83 f8 07	 cmp	 eax, 7
  001ed	75 16		 jne	 SHORT $LN29@Attack
  001ef	8a 83 5a 20 00
	00		 mov	 al, BYTE PTR [ebx+8282]
  001f5	84 c0		 test	 al, al
  001f7	74 0c		 je	 SHORT $LN29@Attack
  001f9	3a 87 5a 20 00
	00		 cmp	 al, BYTE PTR [edi+8282]
  001ff	0f 84 c3 00 00
	00		 je	 $LN257@Attack
$LN29@Attack:

; 787  : 	{
; 788  : 		return FALSE;
; 789  : 	}
; 790  : #endif
; 791  : 
; 792  : 	if ( this->CheckAttackArea(lpObj, lpTargetObj) == FALSE )

  00205	57		 push	 edi
  00206	53		 push	 ebx
  00207	8b ce		 mov	 ecx, esi
  00209	e8 00 00 00 00	 call	 ?CheckAttackArea@CObjBaseAttack@@QAEHPAUOBJECTSTRUCT@@0@Z ; CObjBaseAttack::CheckAttackArea
  0020e	85 c0		 test	 eax, eax
  00210	0f 84 b2 00 00
	00		 je	 $LN257@Attack

; 793  : 		return FALSE;
; 794  : 
; 795  : 	lpCallObj = lpObj;
; 796  : 	lpCallTargetObj = lpTargetObj;
; 797  : 
; 798  : 	if ( lpTargetObj->Type == OBJ_MONSTER )
; 799  : 	{
; 800  : 		if ( lpTargetObj->m_RecallMon >= 0 )
; 801  : 		{
; 802  : 			lpCallTargetObj = &gObj[lpTargetObj->m_RecallMon];
; 803  : 		}
; 804  : 	}
; 805  : 
; 806  : 	if ( this->PkCheck(lpCallObj, lpTargetObj) == FALSE )

  00216	57		 push	 edi
  00217	53		 push	 ebx
  00218	8b ce		 mov	 ecx, esi
  0021a	e8 00 00 00 00	 call	 ?PkCheck@CObjBaseAttack@@QAEHPAUOBJECTSTRUCT@@0@Z ; CObjBaseAttack::PkCheck
  0021f	85 c0		 test	 eax, eax
  00221	0f 84 a1 00 00
	00		 je	 $LN257@Attack

; 807  : 		return FALSE;
; 808  : 
; 809  : 	int Strength = lpObj->Strength + lpObj->AddStrength;
; 810  : 	int Dexterity = lpObj->Dexterity + lpObj->AddDexterity;
; 811  : 	int Vitality = lpObj->Vitality + lpObj->AddVitality;
; 812  : 	int Energy = lpObj->Energy + lpObj->AddEnergy;
; 813  : 	BOOL bIsOnDuel = gObjDuelCheck(lpObj, lpTargetObj);

  00227	57		 push	 edi
  00228	53		 push	 ebx
  00229	e8 00 00 00 00	 call	 ?gObjDuelCheck@@YAHPAUOBJECTSTRUCT@@0@Z ; gObjDuelCheck
  0022e	83 c4 08	 add	 esp, 8
  00231	89 45 e8	 mov	 DWORD PTR _bIsOnDuel$1$[ebp], eax

; 814  : 
; 815  : #if (CUSTOM_OLYMP!=1)
; 816  : 	if ( bIsOnDuel )

  00234	85 c0		 test	 eax, eax
  00236	74 16		 je	 SHORT $LN34@Attack

; 817  : 	{
; 818  : 		lpObj->m_iDuelTickCount = GetTickCount();

  00238	8b 35 00 00 00
	00		 mov	 esi, DWORD PTR __imp__GetTickCount@0
  0023e	ff d6		 call	 esi
  00240	89 83 58 12 00
	00		 mov	 DWORD PTR [ebx+4696], eax

; 819  : 		lpTargetObj->m_iDuelTickCount = GetTickCount();

  00246	ff d6		 call	 esi
  00248	89 87 58 12 00
	00		 mov	 DWORD PTR [edi+4696], eax
$LN34@Attack:

; 820  : 	}
; 821  : #endif
; 822  : 
; 823  : 	int MSBFlag = 0;
; 824  : 	
; 825  : 	if ( criticaldamage == 1 )

  0024e	8b 75 14	 mov	 esi, DWORD PTR _criticaldamage$[ebp]
  00251	c7 45 ec 00 00
	00 00		 mov	 DWORD PTR _MSBFlag$1$[ebp], 0
  00258	83 fe 01	 cmp	 esi, 1
  0025b	75 09		 jne	 SHORT $LN35@Attack

; 826  : 	{
; 827  : 		MsgDamage = 3;

  0025d	c7 45 f8 03 00
	00 00		 mov	 DWORD PTR _MsgDamage$[ebp], 3
  00264	eb 0f		 jmp	 SHORT $LN37@Attack
$LN35@Attack:

; 828  : 	}
; 829  : 	else if( criticaldamage == 2 )

  00266	b9 02 00 00 00	 mov	 ecx, 2
  0026b	33 c0		 xor	 eax, eax
  0026d	3b f1		 cmp	 esi, ecx
  0026f	0f 44 c1	 cmove	 eax, ecx
  00272	89 45 f8	 mov	 DWORD PTR _MsgDamage$[ebp], eax
$LN37@Attack:

; 830  : 	{
; 831  : 		MsgDamage = 2;
; 832  : 	}
; 833  : 	else
; 834  : 	{
; 835  : 		MsgDamage = 0;
; 836  : 	}
; 837  : 
; 838  : 	BOOL bAllMiss = FALSE;
; 839  : 	int AttackDamage = 0;
; 840  : 
; 841  : 	if ( g_ShieldSystemOn == TRUE )

  00275	83 3d 00 00 00
	00 01		 cmp	 DWORD PTR ?g_ShieldSystemOn@@3HA, 1 ; g_ShieldSystemOn
  0027c	c7 45 10 00 00
	00 00		 mov	 DWORD PTR _bAllMiss$[ebp], 0
  00283	75 2c		 jne	 SHORT $LN39@Attack

; 842  : 	{
; 843  : 		if ( lpObj->Type == OBJ_USER && lpTargetObj->Type == OBJ_USER )

  00285	80 7b 50 01	 cmp	 BYTE PTR [ebx+80], 1
  00289	75 26		 jne	 SHORT $LN39@Attack
  0028b	80 7f 50 01	 cmp	 BYTE PTR [edi+80], 1
  0028f	75 20		 jne	 SHORT $LN39@Attack

; 844  : 		{
; 845  : 			if ( !this->MissCheckPvP(lpObj, lpTargetObj, skill, skillSuccess, bAllMiss) )

  00291	8b 4d fc	 mov	 ecx, DWORD PTR _this$1$[ebp]
  00294	8d 45 10	 lea	 eax, DWORD PTR _bAllMiss$[ebp]
  00297	50		 push	 eax
  00298	6a 01		 push	 1
  0029a	ff 75 08	 push	 DWORD PTR _skill$1$[ebp]
  0029d	57		 push	 edi
  0029e	53		 push	 ebx
  0029f	e8 00 00 00 00	 call	 ?MissCheckPvP@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0HHAAH@Z ; CDarkSpirit::MissCheckPvP
  002a4	85 c0		 test	 eax, eax
  002a6	75 2b		 jne	 SHORT $LN227@Attack
  002a8	5b		 pop	 ebx
  002a9	5f		 pop	 edi
  002aa	5e		 pop	 esi

; 1468 : }

  002ab	8b e5		 mov	 esp, ebp
  002ad	5d		 pop	 ebp
  002ae	c2 14 00	 ret	 20			; 00000014H
$LN39@Attack:

; 846  : 			{
; 847  : 				return FALSE;
; 848  : 			}
; 849  : 		}
; 850  : 		else if ( !this->MissCheck(lpObj, lpTargetObj, skill, skillSuccess, bAllMiss) )
; 851  : 		{
; 852  : 			return FALSE;
; 853  : 		}
; 854  : 
; 855  : 	}
; 856  : 	else if ( !this->MissCheck(lpObj, lpTargetObj, skill, skillSuccess, bAllMiss) )

  002b1	8b 4d fc	 mov	 ecx, DWORD PTR _this$1$[ebp]
  002b4	8d 45 10	 lea	 eax, DWORD PTR _bAllMiss$[ebp]
  002b7	50		 push	 eax
  002b8	6a 01		 push	 1
  002ba	ff 75 08	 push	 DWORD PTR _skill$1$[ebp]
  002bd	57		 push	 edi
  002be	53		 push	 ebx
  002bf	e8 00 00 00 00	 call	 ?MissCheck@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0HHAAH@Z ; CDarkSpirit::MissCheck
  002c4	85 c0		 test	 eax, eax
  002c6	75 0b		 jne	 SHORT $LN227@Attack
$LN257@Attack:
  002c8	5b		 pop	 ebx
  002c9	5f		 pop	 edi

; 857  : 	{
; 858  : 		return FALSE;

  002ca	33 c0		 xor	 eax, eax
  002cc	5e		 pop	 esi

; 1468 : }

  002cd	8b e5		 mov	 esp, ebp
  002cf	5d		 pop	 ebp
  002d0	c2 14 00	 ret	 20			; 00000014H
$LN227@Attack:

; 859  : 	}
; 860  : 
; 861  : 	int targetdefense = this->GetTargetDefense(lpObj, lpTargetObj, MsgDamage);

  002d3	8b 4d fc	 mov	 ecx, DWORD PTR _this$1$[ebp]
  002d6	8d 45 f8	 lea	 eax, DWORD PTR _MsgDamage$[ebp]
  002d9	50		 push	 eax
  002da	57		 push	 edi
  002db	53		 push	 ebx
  002dc	e8 00 00 00 00	 call	 ?GetTargetDefense@CObjBaseAttack@@QAEHPAUOBJECTSTRUCT@@0AAH@Z ; CObjBaseAttack::GetTargetDefense
  002e1	89 45 0c	 mov	 DWORD PTR _targetdefense$1$[ebp], eax

; 862  : 
; 863  : 	if( targetdefense > 0 )

  002e4	85 c0		 test	 eax, eax
  002e6	7e 2c		 jle	 SHORT $LN236@Attack

; 864  : 	{
; 865  : 		float fpercent = rand()%100;

  002e8	e8 00 00 00 00	 call	 _rand
  002ed	99		 cdq
  002ee	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  002f3	f7 f9		 idiv	 ecx

; 866  : 		if( fpercent < lpObj->m_MPSkillOpt.MpsDarkSpiritStr6 )

  002f5	f3 0f 10 83 80
	08 00 00	 movss	 xmm0, DWORD PTR [ebx+2176]
  002fd	66 0f 6e ca	 movd	 xmm1, edx
  00301	0f 5b c9	 cvtdq2ps xmm1, xmm1
  00304	0f 2f c1	 comiss	 xmm0, xmm1
  00307	76 0b		 jbe	 SHORT $LN236@Attack

; 867  : 		{
; 868  : 			targetdefense = 0;

  00309	33 c9		 xor	 ecx, ecx

; 869  : 			MsgDamage = 1;

  0030b	c7 45 f8 01 00
	00 00		 mov	 DWORD PTR _MsgDamage$[ebp], 1
  00312	eb 03		 jmp	 SHORT $LN47@Attack
$LN236@Attack:
  00314	8b 4d 0c	 mov	 ecx, DWORD PTR _targetdefense$1$[ebp]
$LN47@Attack:

; 870  : 		}
; 871  : 	}
; 872  : 
; 873  : 	AttackDamage = this->GetAttackDamage(lpObj, targetdefense, bIsOnDuel, criticaldamage,(criticaldamage==2) ? TRUE : FALSE);

  00317	33 c0		 xor	 eax, eax
  00319	83 fe 02	 cmp	 esi, 2
  0031c	0f 94 c0	 sete	 al
  0031f	50		 push	 eax
  00320	56		 push	 esi
  00321	ff 75 e8	 push	 DWORD PTR _bIsOnDuel$1$[ebp]
  00324	51		 push	 ecx
  00325	8b 4d fc	 mov	 ecx, DWORD PTR _this$1$[ebp]
  00328	53		 push	 ebx
  00329	e8 00 00 00 00	 call	 ?GetAttackDamage@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@HHHH@Z ; CDarkSpirit::GetAttackDamage

; 874  : 
; 875  : 	if ( criticaldamage == 0 && iActionType == 0 )

  0032e	83 7d 14 00	 cmp	 DWORD PTR _criticaldamage$[ebp], 0
  00332	8b f0		 mov	 esi, eax
  00334	89 75 0c	 mov	 DWORD PTR _AttackDamage$1$[ebp], esi
  00337	75 1c		 jne	 SHORT $LN48@Attack
  00339	83 7d 18 00	 cmp	 DWORD PTR _iActionType$[ebp], 0
  0033d	75 16		 jne	 SHORT $LN48@Attack

; 876  : 	{
; 877  : 		AttackDamage = (int)(AttackDamage/1.5f);

  0033f	66 0f 6e c6	 movd	 xmm0, esi
  00343	0f 5b c0	 cvtdq2ps xmm0, xmm0
  00346	f3 0f 5e 05 00
	00 00 00	 divss	 xmm0, DWORD PTR __real@3fc00000
  0034e	f3 0f 2c f0	 cvttss2si esi, xmm0
  00352	89 75 0c	 mov	 DWORD PTR _AttackDamage$1$[ebp], esi
$LN48@Attack:

; 878  : 	}
; 879  : 
; 880  : 	if ( bAllMiss )

  00355	83 7d 10 00	 cmp	 DWORD PTR _bAllMiss$[ebp], 0
  00359	74 1d		 je	 SHORT $LN49@Attack

; 881  : 	{
; 882  : 		AttackDamage = ( AttackDamage * 30 ) / 100;

  0035b	8b ce		 mov	 ecx, esi
  0035d	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  00362	c1 e1 04	 shl	 ecx, 4
  00365	2b ce		 sub	 ecx, esi
  00367	03 c9		 add	 ecx, ecx
  00369	f7 e9		 imul	 ecx
  0036b	c1 fa 05	 sar	 edx, 5
  0036e	8b f2		 mov	 esi, edx
  00370	c1 ee 1f	 shr	 esi, 31			; 0000001fH
  00373	03 f2		 add	 esi, edx
  00375	89 75 0c	 mov	 DWORD PTR _AttackDamage$1$[ebp], esi
$LN49@Attack:

; 883  : 	}
; 884  : 
; 885  : 	if ( lpTargetObj->DamageMinus )

  00378	8a 87 48 01 00
	00		 mov	 al, BYTE PTR [edi+328]
  0037e	84 c0		 test	 al, al
  00380	74 1c		 je	 SHORT $LN50@Attack

; 886  : 	{
; 887  : 		int beforeDamage = AttackDamage;
; 888  : 		AttackDamage -= ( ( AttackDamage * (int)lpTargetObj->DamageMinus) / 100 );

  00382	0f b6 c8	 movzx	 ecx, al
  00385	b8 e1 7a 14 ae	 mov	 eax, -1374389535	; ae147ae1H
  0038a	0f af ce	 imul	 ecx, esi
  0038d	f7 e9		 imul	 ecx
  0038f	c1 fa 05	 sar	 edx, 5
  00392	8b c2		 mov	 eax, edx
  00394	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  00397	03 c2		 add	 eax, edx
  00399	03 f0		 add	 esi, eax
  0039b	89 75 0c	 mov	 DWORD PTR _AttackDamage$1$[ebp], esi
$LN50@Attack:

; 889  : 	}
; 890  : 
; 891  : 	int tlevel = lpObj->Level / 10;

  0039e	0f bf 8b 96 00
	00 00		 movsx	 ecx, WORD PTR [ebx+150]
  003a5	b8 67 66 66 66	 mov	 eax, 1717986919		; 66666667H
  003aa	f7 e9		 imul	 ecx

; 892  : 
; 893  : 	if ( AttackDamage < tlevel )

  003ac	b9 01 00 00 00	 mov	 ecx, 1
  003b1	c1 fa 02	 sar	 edx, 2
  003b4	8b c2		 mov	 eax, edx
  003b6	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  003b9	03 c2		 add	 eax, edx
  003bb	3b f0		 cmp	 esi, eax
  003bd	7d 0a		 jge	 SHORT $LN51@Attack

; 894  : 	{
; 895  : 		if ( tlevel < 1 )

  003bf	3b c1		 cmp	 eax, ecx
  003c1	8b f0		 mov	 esi, eax
  003c3	0f 4c f1	 cmovl	 esi, ecx
  003c6	89 75 0c	 mov	 DWORD PTR _AttackDamage$1$[ebp], esi
$LN51@Attack:

; 896  : 		{
; 897  : 			tlevel = 1;
; 898  : 		}
; 899  : 
; 900  : 		AttackDamage = tlevel;
; 901  : 	}
; 902  : 
; 903  : 	if ( lpTargetObj->m_SkillNumber == 18 )

  003c9	66 83 bf b8 05
	00 00 12	 cmp	 WORD PTR [edi+1464], 18	; 00000012H
  003d1	75 0a		 jne	 SHORT $LN54@Attack

; 904  : 	{
; 905  : 		if ( AttackDamage > 1 )

  003d3	83 fe 01	 cmp	 esi, 1
  003d6	7e 05		 jle	 SHORT $LN54@Attack

; 906  : 		{
; 907  : 			AttackDamage >>= 1;

  003d8	d1 fe		 sar	 esi, 1
  003da	89 75 0c	 mov	 DWORD PTR _AttackDamage$1$[ebp], esi
$LN54@Attack:

; 908  : 		}
; 909  : 	}
; 910  : 
; 911  : 	lpObj->pInventory[1].m_DurabilitySmall += AttackDamage * 2 / 100;

  003dd	8b 4d 0c	 mov	 ecx, DWORD PTR _AttackDamage$1$[ebp]
  003e0	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  003e5	8b b3 c0 11 00
	00		 mov	 esi, DWORD PTR [ebx+4544]
  003eb	03 c9		 add	 ecx, ecx
  003ed	f7 e9		 imul	 ecx
  003ef	c1 fa 05	 sar	 edx, 5
  003f2	8b c2		 mov	 eax, edx
  003f4	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  003f7	03 c2		 add	 eax, edx
  003f9	66 01 86 fc 00
	00 00		 add	 WORD PTR [esi+252], ax

; 912  : 
; 913  : 	int SmallDur = 800;
; 914  : 
; 915  : 	if ( lpObj->pInventory[1].m_DurabilitySmall >= (SmallDur+lpObj->m_MPSkillOpt.MpsPetDurDownSpeed) )

  00400	8b 8b c0 11 00
	00		 mov	 ecx, DWORD PTR [ebx+4544]
  00406	f3 0f 10 83 18
	08 00 00	 movss	 xmm0, DWORD PTR [ebx+2072]
  0040e	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR __real@44480000
  00416	0f b7 81 fc 00
	00 00		 movzx	 eax, WORD PTR [ecx+252]
  0041d	66 0f 6e c8	 movd	 xmm1, eax
  00421	0f 5b c9	 cvtdq2ps xmm1, xmm1
  00424	0f 2f c8	 comiss	 xmm1, xmm0
  00427	0f 82 17 01 00
	00		 jb	 $LN55@Attack

; 916  : 	{
; 917  : 		lpObj->pInventory[1].m_DurabilitySmall = 0;
; 918  : 		lpObj->pInventory[1].m_Durability -= 1.0f;

  0042d	f3 0f 10 0d 00
	00 00 00	 movss	 xmm1, DWORD PTR __real@3f800000
  00435	33 c0		 xor	 eax, eax
  00437	66 89 81 fc 00
	00 00		 mov	 WORD PTR [ecx+252], ax
  0043e	8b 83 c0 11 00
	00		 mov	 eax, DWORD PTR [ebx+4544]
  00444	f3 0f 10 80 f8
	00 00 00	 movss	 xmm0, DWORD PTR [eax+248]
  0044c	f3 0f 5c c1	 subss	 xmm0, xmm1
  00450	f3 0f 11 80 f8
	00 00 00	 movss	 DWORD PTR [eax+248], xmm0

; 919  : 
; 920  : 		if ( lpObj->pInventory[1].m_Durability < 1.0f )

  00458	8b 83 c0 11 00
	00		 mov	 eax, DWORD PTR [ebx+4544]
  0045e	0f 2f 88 f8 00
	00 00		 comiss	 xmm1, DWORD PTR [eax+248]
  00465	0f 86 a9 00 00
	00		 jbe	 $LN56@Attack

; 921  : 		{
; 922  : 			lpObj->pInventory[1].m_Durability = 0;

  0046b	c7 80 f8 00 00
	00 00 00 00 00	 mov	 DWORD PTR [eax+248], 0

; 923  : 			int iPetExp = lpObj->pInventory[1].m_PetItem_Exp;

  00475	8b 8b c0 11 00
	00		 mov	 ecx, DWORD PTR [ebx+4544]

; 924  : 
; 925  : 			if ( lpObj->pInventory[1].DecPetItemExp(10) )

  0047b	6a 0a		 push	 10			; 0000000aH
  0047d	8b b1 90 01 00
	00		 mov	 esi, DWORD PTR [ecx+400]
  00483	81 c1 d4 00 00
	00		 add	 ecx, 212		; 000000d4H
  00489	e8 00 00 00 00	 call	 ?DecPetItemExp@CItem@@QAEHH@Z ; CItem::DecPetItemExp
  0048e	85 c0		 test	 eax, eax
  00490	74 61		 je	 SHORT $LN58@Attack

; 926  : 			{
; 927  : 				LogAddTD("[%s][%s][PetItemExpDown] [%s] Level:[%d]Exp:[%d]DecExp[%d]",

  00492	8b 8b c0 11 00
	00		 mov	 ecx, DWORD PTR [ebx+4544]
  00498	8b 81 90 01 00
	00		 mov	 eax, DWORD PTR [ecx+400]
  0049e	2b f0		 sub	 esi, eax
  004a0	56		 push	 esi
  004a1	50		 push	 eax
  004a2	ff b1 8c 01 00
	00		 push	 DWORD PTR [ecx+396]
  004a8	81 c1 d4 00 00
	00		 add	 ecx, 212		; 000000d4H
  004ae	e8 00 00 00 00	 call	 ?GetName@CItem@@QAEPADXZ ; CItem::GetName
  004b3	50		 push	 eax
  004b4	8d 43 5d	 lea	 eax, DWORD PTR [ebx+93]
  004b7	50		 push	 eax
  004b8	8d 43 52	 lea	 eax, DWORD PTR [ebx+82]
  004bb	50		 push	 eax
  004bc	68 00 00 00 00	 push	 OFFSET ??_C@_0DL@HDCMLJGF@?$FL?$CFs?$FN?$FL?$CFs?$FN?$FLPetItemExpDown?$FN?5?$FL?$CFs?$FN?5Le@
  004c1	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD

; 928  : 					lpObj->AccountID, lpObj->Name, lpObj->pInventory[1].GetName(),
; 929  : 					lpObj->pInventory[1].m_PetItem_Level,
; 930  : 					lpObj->pInventory[1].m_PetItem_Exp, iPetExp - lpObj->pInventory[1].m_PetItem_Exp);
; 931  : 
; 932  : 				this->Set(lpObj->m_Index, &lpObj->pInventory[1]);

  004c7	8b 83 c0 11 00
	00		 mov	 eax, DWORD PTR [ebx+4544]
  004cd	83 c4 1c	 add	 esp, 28			; 0000001cH
  004d0	8b 4d fc	 mov	 ecx, DWORD PTR _this$1$[ebp]
  004d3	05 d4 00 00 00	 add	 eax, 212		; 000000d4H
  004d8	50		 push	 eax
  004d9	ff 33		 push	 DWORD PTR [ebx]
  004db	e8 00 00 00 00	 call	 ?Set@CDarkSpirit@@QAEXHPAVCItem@@@Z ; CDarkSpirit::Set

; 933  : 				this->SendLevelmsg(lpObj->m_Index, 1, 0, 0xFF);

  004e0	68 ff 00 00 00	 push	 255			; 000000ffH
  004e5	6a 00		 push	 0
  004e7	6a 01		 push	 1
  004e9	ff 33		 push	 DWORD PTR [ebx]
  004eb	e8 00 00 00 00	 call	 ?SendLevelmsg@CDarkSpirit@@SAXHHHH@Z ; CDarkSpirit::SendLevelmsg
  004f0	83 c4 10	 add	 esp, 16			; 00000010H
$LN58@Attack:

; 934  : 			}
; 935  : 
; 936  : 			LogAddTD("[%s][%s] DarkSpirit Item is Broken because durability is exhausted [%d]",

  004f3	8b 83 c0 11 00
	00		 mov	 eax, DWORD PTR [ebx+4544]
  004f9	ff b0 d4 00 00
	00		 push	 DWORD PTR [eax+212]
  004ff	8d 43 5d	 lea	 eax, DWORD PTR [ebx+93]
  00502	50		 push	 eax
  00503	8d 43 52	 lea	 eax, DWORD PTR [ebx+82]
  00506	50		 push	 eax
  00507	68 00 00 00 00	 push	 OFFSET ??_C@_0EI@EDGOCDCM@?$FL?$CFs?$FN?$FL?$CFs?$FN?5DarkSpirit?5Item?5is?5Brok@
  0050c	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD

; 937  : 				lpObj->AccountID, lpObj->Name, lpObj->pInventory[1].m_Number);
; 938  : 		}
; 939  : 		else

  00512	eb 0d		 jmp	 SHORT $LN240@Attack
$LN56@Attack:

; 940  : 		{
; 941  : 			this->SendLevelmsg(lpObj->m_Index,1,0,0);

  00514	6a 00		 push	 0
  00516	6a 00		 push	 0
  00518	6a 01		 push	 1
  0051a	ff 33		 push	 DWORD PTR [ebx]
  0051c	e8 00 00 00 00	 call	 ?SendLevelmsg@CDarkSpirit@@SAXHHHH@Z ; CDarkSpirit::SendLevelmsg
$LN240@Attack:

; 942  : 		}
; 943  : 
; 944  : 		GCItemDurSend(lpObj->m_Index, 1, (BYTE)lpObj->pInventory[1].m_Durability, 0);

  00521	8b 83 c0 11 00
	00		 mov	 eax, DWORD PTR [ebx+4544]
  00527	83 c4 10	 add	 esp, 16			; 00000010H
  0052a	f3 0f 2c 80 f8
	00 00 00	 cvttss2si eax, DWORD PTR [eax+248]
  00532	6a 00		 push	 0
  00534	0f b6 c0	 movzx	 eax, al
  00537	50		 push	 eax
  00538	6a 01		 push	 1
  0053a	ff 33		 push	 DWORD PTR [ebx]
  0053c	e8 00 00 00 00	 call	 ?GCItemDurSend@@YAXHEEE@Z ; GCItemDurSend
  00541	83 c4 10	 add	 esp, 16			; 00000010H
$LN55@Attack:

; 945  : 	}
; 946  : 
; 947  : 	if ( gObjAngelSprite(lpTargetObj) == TRUE )

  00544	57		 push	 edi
  00545	e8 00 00 00 00	 call	 ?gObjAngelSprite@@YAHPAUOBJECTSTRUCT@@@Z ; gObjAngelSprite

; 948  : 	{
; 949  : 		if ( AttackDamage > 1 )

  0054a	8b 75 0c	 mov	 esi, DWORD PTR _AttackDamage$1$[ebp]
  0054d	83 c4 04	 add	 esp, 4
  00550	83 f8 01	 cmp	 eax, 1
  00553	75 21		 jne	 SHORT $LN60@Attack
  00555	3b f0		 cmp	 esi, eax
  00557	7e 1d		 jle	 SHORT $LN60@Attack

; 950  : 		{
; 951  : 			float  damage = (AttackDamage * 8) / 10.0f;

  00559	8d 04 f5 00 00
	00 00		 lea	 eax, DWORD PTR [esi*8]
  00560	66 0f 6e c0	 movd	 xmm0, eax
  00564	0f 5b c0	 cvtdq2ps xmm0, xmm0
  00567	f3 0f 5e 05 00
	00 00 00	 divss	 xmm0, DWORD PTR __real@41200000

; 952  : 			AttackDamage = (int)damage;

  0056f	f3 0f 2c f0	 cvttss2si esi, xmm0
  00573	89 75 0c	 mov	 DWORD PTR _AttackDamage$1$[ebp], esi
$LN60@Attack:

; 953  : 		}
; 954  : 	}
; 955  : 
; 956  : 	if ( gObjWingSprite(lpTargetObj) == TRUE )

  00576	57		 push	 edi
  00577	e8 00 00 00 00	 call	 ?gObjWingSprite@@YAHPAUOBJECTSTRUCT@@@Z ; gObjWingSprite
  0057c	f3 0f 10 0d 00
	00 00 00	 movss	 xmm1, DWORD PTR __real@42c80000
  00584	83 c4 04	 add	 esp, 4
  00587	83 f8 01	 cmp	 eax, 1
  0058a	0f 85 4b 02 00
	00		 jne	 $LN232@Attack

; 957  : 	{
; 958  : 		CItem * Wing = &lpTargetObj->pInventory[7];

  00590	8b 8f c0 11 00
	00		 mov	 ecx, DWORD PTR [edi+4544]
  00596	81 c1 cc 05 00
	00		 add	 ecx, 1484		; 000005ccH

; 959  : 
; 960  : 		if ( AttackDamage > 1 )

  0059c	83 fe 01	 cmp	 esi, 1
  0059f	0f 8e 36 02 00
	00		 jle	 $LN232@Attack

; 961  : 		{
; 962  : 			if( Wing->m_Type == ITEMGET(12,36) ||
; 963  : 				Wing->m_Type == ITEMGET(12,37) ||
; 964  : 				Wing->m_Type == ITEMGET(12,38) ||

  005a5	0f b7 41 06	 movzx	 eax, WORD PTR [ecx+6]
  005a9	ba 24 18 00 00	 mov	 edx, 6180		; 00001824H
  005ae	66 3b c2	 cmp	 ax, dx
  005b1	0f 84 19 02 00
	00		 je	 $LN65@Attack
  005b7	ba 25 18 00 00	 mov	 edx, 6181		; 00001825H
  005bc	66 3b c2	 cmp	 ax, dx
  005bf	0f 84 0b 02 00
	00		 je	 $LN65@Attack
  005c5	ba 26 18 00 00	 mov	 edx, 6182		; 00001826H
  005ca	66 3b c2	 cmp	 ax, dx
  005cd	0f 84 fd 01 00
	00		 je	 $LN65@Attack
  005d3	ba 27 18 00 00	 mov	 edx, 6183		; 00001827H
  005d8	66 3b c2	 cmp	 ax, dx
  005db	0f 84 ef 01 00
	00		 je	 $LN65@Attack

; 969  : 			}
; 970  : 			else if( Wing->m_Type == ITEMGET(12,262) )

  005e1	ba 06 19 00 00	 mov	 edx, 6406		; 00001906H
  005e6	66 3b c2	 cmp	 ax, dx
  005e9	75 0e		 jne	 SHORT $LN66@Attack

; 971  : 			{
; 972  : 				float damage = AttackDamage * (87 - Wing->m_Level*2) / 100.0f;

  005eb	0f bf 41 08	 movsx	 eax, WORD PTR [ecx+8]
  005ef	b9 57 00 00 00	 mov	 ecx, 87			; 00000057H

; 973  : 				AttackDamage = (int)damage;

  005f4	e9 b4 01 00 00	 jmp	 $LN258@Attack
$LN66@Attack:

; 974  : 			}
; 975  : 			else if( Wing->m_Type == ITEMGET(12,263) )

  005f9	ba 07 19 00 00	 mov	 edx, 6407		; 00001907H
  005fe	66 3b c2	 cmp	 ax, dx
  00601	75 24		 jne	 SHORT $LN68@Attack

; 976  : 			{
; 977  : 				float damage = AttackDamage * (70 - Wing->m_Level*2) / 100.0f;

  00603	0f bf 41 08	 movsx	 eax, WORD PTR [ecx+8]
  00607	b9 23 00 00 00	 mov	 ecx, 35			; 00000023H
  0060c	2b c8		 sub	 ecx, eax
  0060e	0f af ce	 imul	 ecx, esi
  00611	03 c9		 add	 ecx, ecx
  00613	66 0f 6e c1	 movd	 xmm0, ecx

; 1046 : 			{
; 1047 : 				float damage = AttackDamage * (75 - Wing->m_Level*2) / 100.0f;

  00617	0f 5b c0	 cvtdq2ps xmm0, xmm0
  0061a	f3 0f 5e c1	 divss	 xmm0, xmm1

; 1048 : 				AttackDamage = (int)damage;

  0061e	f3 0f 2c f0	 cvttss2si esi, xmm0

; 1049 : 			}
; 1050 : 			else

  00622	e9 b7 01 00 00	 jmp	 $LN92@Attack
$LN68@Attack:

; 978  : 				AttackDamage = (int)damage;
; 979  : 			}
; 980  : 			else if( Wing->m_Type == ITEMGET(12,264) || Wing->m_Type == ITEMGET(12,265) )

  00627	ba 08 19 00 00	 mov	 edx, 6408		; 00001908H
  0062c	66 3b c2	 cmp	 ax, dx
  0062f	0f 84 90 01 00
	00		 je	 $LN72@Attack
  00635	ba 09 19 00 00	 mov	 edx, 6409		; 00001909H
  0063a	66 3b c2	 cmp	 ax, dx
  0063d	0f 84 82 01 00
	00		 je	 $LN72@Attack

; 984  : 			}
; 985  : #if (CUSTOM_WINGS == 1)
; 986  : 			else if( Wing->m_Type >= ITEMGET(12,440) && Wing->m_Type <= ITEMGET(12,445) )
; 987  : 			{
; 988  : 				float damage;
; 989  : 				
; 990  : 				if( Wing->m_Type == ITEMGET(12,444) )
; 991  : 				{
; 992  : 					damage = AttackDamage * (70 - Wing->m_Level*3) / 100.0f;
; 993  : 				}
; 994  : 				else{
; 995  : 					damage = AttackDamage * (61 - Wing->m_Level*3) / 100.0f;
; 996  : 				}
; 997  : 				AttackDamage = (int)damage;
; 998  : 			}
; 999  : #endif
; 1000 : 			else if( Wing->m_Type == ITEMGET(12,40) )

  00643	ba 28 18 00 00	 mov	 edx, 6184		; 00001828H
  00648	66 3b c2	 cmp	 ax, dx
  0064b	75 24		 jne	 SHORT $LN73@Attack

; 1001 : 			{
; 1002 : 				float damage = AttackDamage * (76 - Wing->m_Level*2) / 100.0f;

  0064d	0f bf 41 08	 movsx	 eax, WORD PTR [ecx+8]
  00651	b9 26 00 00 00	 mov	 ecx, 38			; 00000026H
  00656	2b c8		 sub	 ecx, eax
  00658	0f af ce	 imul	 ecx, esi
  0065b	03 c9		 add	 ecx, ecx
  0065d	66 0f 6e c1	 movd	 xmm0, ecx

; 1046 : 			{
; 1047 : 				float damage = AttackDamage * (75 - Wing->m_Level*2) / 100.0f;

  00661	0f 5b c0	 cvtdq2ps xmm0, xmm0
  00664	f3 0f 5e c1	 divss	 xmm0, xmm1

; 1048 : 				AttackDamage = (int)damage;

  00668	f3 0f 2c f0	 cvttss2si esi, xmm0

; 1049 : 			}
; 1050 : 			else

  0066c	e9 6d 01 00 00	 jmp	 $LN92@Attack
$LN73@Attack:

; 1003 : 				AttackDamage = (int)damage;
; 1004 : 			}
; 1005 : 			else if( Wing->m_Type == ITEMGET(12,41) )

  00671	ba 29 18 00 00	 mov	 edx, 6185		; 00001829H
  00676	66 3b c2	 cmp	 ax, dx
  00679	75 24		 jne	 SHORT $LN75@Attack

; 1006 : 			{
; 1007 : 				float damage = AttackDamage * (88 - Wing->m_Level*2) / 100.0f;

  0067b	0f bf 41 08	 movsx	 eax, WORD PTR [ecx+8]
$LN91@Attack:
  0067f	b9 2c 00 00 00	 mov	 ecx, 44			; 0000002cH
  00684	2b c8		 sub	 ecx, eax
  00686	0f af ce	 imul	 ecx, esi
  00689	03 c9		 add	 ecx, ecx
  0068b	66 0f 6e c1	 movd	 xmm0, ecx

; 1046 : 			{
; 1047 : 				float damage = AttackDamage * (75 - Wing->m_Level*2) / 100.0f;

  0068f	0f 5b c0	 cvtdq2ps xmm0, xmm0
  00692	f3 0f 5e c1	 divss	 xmm0, xmm1

; 1048 : 				AttackDamage = (int)damage;

  00696	f3 0f 2c f0	 cvttss2si esi, xmm0

; 1049 : 			}
; 1050 : 			else

  0069a	e9 3f 01 00 00	 jmp	 $LN92@Attack
$LN75@Attack:

; 1008 : 				AttackDamage = (int)damage;
; 1009 : 			}
; 1010 : 			else if( Wing->m_Type == ITEMGET(12,42) )

  0069f	ba 2a 18 00 00	 mov	 edx, 6186		; 0000182aH
  006a4	66 3b c2	 cmp	 ax, dx
  006a7	75 09		 jne	 SHORT $LN77@Attack

; 1011 : 			{
; 1012 : 				float damage = AttackDamage * (75 - Wing->m_Level*2) / 100.0f;

  006a9	0f bf 41 08	 movsx	 eax, WORD PTR [ecx+8]

; 1013 : 				AttackDamage = (int)damage;

  006ad	e9 f6 00 00 00	 jmp	 $LN241@Attack
$LN77@Attack:

; 1014 : 			}
; 1015 : 			else if( Wing->m_Type == ITEMGET(12,43) )

  006b2	ba 2b 18 00 00	 mov	 edx, 6187		; 0000182bH
  006b7	66 3b c2	 cmp	 ax, dx
  006ba	75 24		 jne	 SHORT $LN79@Attack

; 1016 : 			{
; 1017 : 				float damage = AttackDamage * (61 - Wing->m_Level*2) / 100.0f;

  006bc	0f bf 41 08	 movsx	 eax, WORD PTR [ecx+8]
  006c0	b9 3d 00 00 00	 mov	 ecx, 61			; 0000003dH
  006c5	03 c0		 add	 eax, eax
  006c7	2b c8		 sub	 ecx, eax
  006c9	0f af ce	 imul	 ecx, esi
  006cc	66 0f 6e c1	 movd	 xmm0, ecx

; 1026 : 			{
; 1027 : 				float damage = AttackDamage * (76 - Wing->m_Level*2) / 100.0f;

  006d0	0f 5b c0	 cvtdq2ps xmm0, xmm0
  006d3	f3 0f 5e c1	 divss	 xmm0, xmm1

; 1028 : 				AttackDamage = (int)damage;

  006d7	f3 0f 2c f0	 cvttss2si esi, xmm0
  006db	e9 fe 00 00 00	 jmp	 $LN92@Attack
$LN79@Attack:

; 1018 : 				AttackDamage = (int)damage;
; 1019 : 			}
; 1020 : 			else if( Wing->m_Type == ITEMGET(12,49) )

  006e0	ba 31 18 00 00	 mov	 edx, 6193		; 00001831H
  006e5	66 3b c2	 cmp	 ax, dx
  006e8	75 0b		 jne	 SHORT $LN81@Attack

; 1021 : 			{
; 1022 : 				float damage = AttackDamage * (90 - Wing->m_Level*2) / 100.0f;

  006ea	0f bf 41 08	 movsx	 eax, WORD PTR [ecx+8]
  006ee	b9 2d 00 00 00	 mov	 ecx, 45			; 0000002dH

; 1023 : 				AttackDamage = (int)damage;

  006f3	eb 13		 jmp	 SHORT $LN244@Attack
$LN81@Attack:

; 1024 : 			}
; 1025 : 			else if( Wing->m_Type == ITEMGET(12,50) )

  006f5	ba 32 18 00 00	 mov	 edx, 6194		; 00001832H
  006fa	66 3b c2	 cmp	 ax, dx
  006fd	75 24		 jne	 SHORT $LN83@Attack

; 1026 : 			{
; 1027 : 				float damage = AttackDamage * (76 - Wing->m_Level*2) / 100.0f;

  006ff	0f bf 41 08	 movsx	 eax, WORD PTR [ecx+8]
  00703	b9 26 00 00 00	 mov	 ecx, 38			; 00000026H
$LN244@Attack:
  00708	2b c8		 sub	 ecx, eax
  0070a	0f af ce	 imul	 ecx, esi
  0070d	03 c9		 add	 ecx, ecx
  0070f	66 0f 6e c1	 movd	 xmm0, ecx
  00713	0f 5b c0	 cvtdq2ps xmm0, xmm0
  00716	f3 0f 5e c1	 divss	 xmm0, xmm1

; 1028 : 				AttackDamage = (int)damage;

  0071a	f3 0f 2c f0	 cvttss2si esi, xmm0
  0071e	e9 bb 00 00 00	 jmp	 $LN92@Attack
$LN83@Attack:

; 1029 : 			}
; 1030 : 			else if( Wing->m_Type == ITEMGET(13,30) )

  00723	ba 1e 1a 00 00	 mov	 edx, 6686		; 00001a1eH
  00728	66 3b c2	 cmp	 ax, dx
  0072b	75 22		 jne	 SHORT $LN85@Attack

; 1031 : 			{
; 1032 : 				float damage = AttackDamage * (90 - Wing->m_Level) / 100.0f;

  0072d	0f bf 41 08	 movsx	 eax, WORD PTR [ecx+8]
  00731	b9 5a 00 00 00	 mov	 ecx, 90			; 0000005aH
  00736	2b c8		 sub	 ecx, eax
  00738	0f af ce	 imul	 ecx, esi
  0073b	66 0f 6e c1	 movd	 xmm0, ecx
  0073f	0f 5b c0	 cvtdq2ps xmm0, xmm0
  00742	f3 0f 5e c1	 divss	 xmm0, xmm1

; 1033 : 				AttackDamage = (int)damage;

  00746	f3 0f 2c f0	 cvttss2si esi, xmm0
  0074a	e9 8f 00 00 00	 jmp	 $LN92@Attack
$LN85@Attack:

; 1034 : 			}
; 1035 : 			else if( Wing->m_Type == ITEMGET(12,266) )

  0074f	ba 0a 19 00 00	 mov	 edx, 6410		; 0000190aH
  00754	66 3b c2	 cmp	 ax, dx
  00757	75 14		 jne	 SHORT $LN87@Attack

; 1036 : 			{
; 1037 : 				float damage = AttackDamage * 29 / 100.0f;

  00759	6b c6 1d	 imul	 eax, esi, 29
  0075c	66 0f 6e c0	 movd	 xmm0, eax
  00760	0f 5b c0	 cvtdq2ps xmm0, xmm0
  00763	f3 0f 5e c1	 divss	 xmm0, xmm1

; 1038 : 				AttackDamage = (int)damage;

  00767	f3 0f 2c f0	 cvttss2si esi, xmm0
  0076b	eb 71		 jmp	 SHORT $LN92@Attack
$LN87@Attack:

; 1039 : 			}
; 1040 : 			else if( Wing->m_Type == ITEMGET(12,267) )

  0076d	ba 0b 19 00 00	 mov	 edx, 6411		; 0000190bH
  00772	66 3b c2	 cmp	 ax, dx
  00775	75 1f		 jne	 SHORT $LN89@Attack

; 1041 : 			{
; 1042 : 				float damage = AttackDamage * (40 - Wing->m_Level) / 100.0f;

  00777	0f bf 41 08	 movsx	 eax, WORD PTR [ecx+8]
  0077b	b9 28 00 00 00	 mov	 ecx, 40			; 00000028H
  00780	2b c8		 sub	 ecx, eax
  00782	0f af ce	 imul	 ecx, esi
  00785	66 0f 6e c1	 movd	 xmm0, ecx
  00789	0f 5b c0	 cvtdq2ps xmm0, xmm0
  0078c	f3 0f 5e c1	 divss	 xmm0, xmm1

; 1043 : 				AttackDamage = (int)damage;

  00790	f3 0f 2c f0	 cvttss2si esi, xmm0
  00794	eb 48		 jmp	 SHORT $LN92@Attack
$LN89@Attack:

; 1044 : 			}
; 1045 : 			else if( Wing->m_Type > ITEMGET(12,2) )

  00796	ba 02 18 00 00	 mov	 edx, 6146		; 00001802H
  0079b	66 3b c2	 cmp	 ax, dx

; 1046 : 			{
; 1047 : 				float damage = AttackDamage * (75 - Wing->m_Level*2) / 100.0f;

  0079e	0f bf 41 08	 movsx	 eax, WORD PTR [ecx+8]
  007a2	0f 8e d7 fe ff
	ff		 jle	 $LN91@Attack
$LN241@Attack:
  007a8	b9 4b 00 00 00	 mov	 ecx, 75			; 0000004bH
$LN258@Attack:
  007ad	03 c0		 add	 eax, eax
  007af	2b c8		 sub	 ecx, eax
  007b1	0f af ce	 imul	 ecx, esi
  007b4	66 0f 6e c1	 movd	 xmm0, ecx
  007b8	0f 5b c0	 cvtdq2ps xmm0, xmm0
  007bb	f3 0f 5e c1	 divss	 xmm0, xmm1

; 1048 : 				AttackDamage = (int)damage;

  007bf	f3 0f 2c f0	 cvttss2si esi, xmm0

; 1049 : 			}
; 1050 : 			else

  007c3	eb 19		 jmp	 SHORT $LN92@Attack
$LN72@Attack:

; 981  : 			{
; 982  : 				float damage = AttackDamage * (71 - Wing->m_Level*2) / 100.0f;

  007c5	0f bf 41 08	 movsx	 eax, WORD PTR [ecx+8]
  007c9	b9 47 00 00 00	 mov	 ecx, 71			; 00000047H

; 983  : 				AttackDamage = (int)damage;

  007ce	eb dd		 jmp	 SHORT $LN258@Attack
$LN65@Attack:

; 965  : 				Wing->m_Type == ITEMGET(12,39) )
; 966  : 			{
; 967  : 				float damage = AttackDamage * (61 - Wing->m_Level*2) / 100.0f;

  007d0	0f bf 41 08	 movsx	 eax, WORD PTR [ecx+8]
  007d4	b9 3d 00 00 00	 mov	 ecx, 61			; 0000003dH

; 968  : 				AttackDamage = (int)damage;

  007d9	eb d2		 jmp	 SHORT $LN258@Attack
$LN232@Attack:
  007db	8b 75 0c	 mov	 esi, DWORD PTR _AttackDamage$1$[ebp]
$LN92@Attack:

; 1051 : 			{
; 1052 : 				float damage = AttackDamage * (88 - Wing->m_Level*2) / 100.0f;
; 1053 : 				AttackDamage = (int)damage;
; 1054 : 			}
; 1055 : 		}
; 1056 : 	}
; 1057 : 
; 1058 : 	if ( gObjDenorantSprite(lpTargetObj ) )

  007de	57		 push	 edi
  007df	e8 00 00 00 00	 call	 ?gObjDenorantSprite@@YAHPAUOBJECTSTRUCT@@@Z ; gObjDenorantSprite
  007e4	83 c4 04	 add	 esp, 4
  007e7	85 c0		 test	 eax, eax
  007e9	74 7d		 je	 SHORT $LN93@Attack

; 1059 : 	{
; 1060 : 		CItem * Dinorant = &lpTargetObj->pInventory[8];

  007eb	8b 8f c0 11 00
	00		 mov	 ecx, DWORD PTR [edi+4544]
  007f1	81 c1 a0 06 00
	00		 add	 ecx, 1696		; 000006a0H

; 1061 : 		int dinorantdecdamage = 90 - Dinorant->IsDinorantReduceAttackDamaege();

  007f7	e8 00 00 00 00	 call	 ?IsDinorantReduceAttackDamaege@CItem@@QAEHXZ ; CItem::IsDinorantReduceAttackDamaege

; 1062 : 		lpObj->Life -= 1.0f;

  007fc	f3 0f 10 83 d8
	00 00 00	 movss	 xmm0, DWORD PTR [ebx+216]
  00804	b9 5a 00 00 00	 mov	 ecx, 90			; 0000005aH
  00809	f3 0f 5c 05 00
	00 00 00	 subss	 xmm0, DWORD PTR __real@3f800000
  00811	0f 57 c9	 xorps	 xmm1, xmm1
  00814	2b c8		 sub	 ecx, eax

; 1063 : 
; 1064 : 		if ( lpObj->Life < 0.0f )

  00816	0f 2f c8	 comiss	 xmm1, xmm0
  00819	f3 0f 11 83 d8
	00 00 00	 movss	 DWORD PTR [ebx+216], xmm0
  00821	76 0c		 jbe	 SHORT $LN94@Attack

; 1065 : 		{
; 1066 : 			lpObj->Life = 0.0f;

  00823	c7 83 d8 00 00
	00 00 00 00 00	 mov	 DWORD PTR [ebx+216], 0

; 1067 : 		}
; 1068 : 		else

  0082d	eb 14		 jmp	 SHORT $LN95@Attack
$LN94@Attack:

; 1069 : 		{
; 1070 : 			AttackDamage = AttackDamage * dinorantdecdamage / 100;

  0082f	0f af ce	 imul	 ecx, esi
  00832	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  00837	f7 e9		 imul	 ecx
  00839	c1 fa 05	 sar	 edx, 5
  0083c	8b f2		 mov	 esi, edx
  0083e	c1 ee 1f	 shr	 esi, 31			; 0000001fH
  00841	03 f2		 add	 esi, edx
$LN95@Attack:

; 1071 : 		}
; 1072 : 
; 1073 : 		GCReFillSend(lpObj->m_Index,(WORD)lpObj->Life, 0xFF, 0, lpObj->iShield);

  00843	0f b7 83 2c 01
	00 00		 movzx	 eax, WORD PTR [ebx+300]
  0084a	50		 push	 eax
  0084b	f3 0f 2c 83 d8
	00 00 00	 cvttss2si eax, DWORD PTR [ebx+216]
  00853	6a 00		 push	 0
  00855	68 ff 00 00 00	 push	 255			; 000000ffH
  0085a	0f b7 c0	 movzx	 eax, ax
  0085d	50		 push	 eax
  0085e	ff 33		 push	 DWORD PTR [ebx]
  00860	e8 00 00 00 00	 call	 ?GCReFillSend@@YAXHGEEG@Z ; GCReFillSend
  00865	83 c4 14	 add	 esp, 20			; 00000014H
$LN93@Attack:

; 1074 : 	}
; 1075 : 
; 1076 : 	if ( gObjDarkHorse(lpTargetObj ) )

  00868	57		 push	 edi
  00869	e8 00 00 00 00	 call	 ?gObjDarkHorse@@YAHPAUOBJECTSTRUCT@@@Z ; gObjDarkHorse
  0086e	83 c4 04	 add	 esp, 4
  00871	85 c0		 test	 eax, eax
  00873	0f 84 80 00 00
	00		 je	 $LN96@Attack

; 1077 : 	{
; 1078 : 		CItem * Darkhorse = &lpTargetObj->pInventory[8];
; 1079 : 		int decdamage = 100 - ((Darkhorse->m_PetItem_Level + 30) / 2 );

  00879	8b 87 c0 11 00
	00		 mov	 eax, DWORD PTR [edi+4544]
  0087f	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H

; 1080 : 
; 1081 : 		lpTargetObj->Life -= 1.0f;

  00884	f3 0f 10 87 d8
	00 00 00	 movss	 xmm0, DWORD PTR [edi+216]
  0088c	0f 57 c9	 xorps	 xmm1, xmm1
  0088f	f3 0f 5c 05 00
	00 00 00	 subss	 xmm0, DWORD PTR __real@3f800000
  00897	8b 80 58 07 00
	00		 mov	 eax, DWORD PTR [eax+1880]
  0089d	83 c0 1e	 add	 eax, 30			; 0000001eH
  008a0	99		 cdq
  008a1	2b c2		 sub	 eax, edx
  008a3	f3 0f 11 87 d8
	00 00 00	 movss	 DWORD PTR [edi+216], xmm0
  008ab	d1 f8		 sar	 eax, 1
  008ad	2b c8		 sub	 ecx, eax

; 1082 : 
; 1083 : 		if ( lpTargetObj->Life < 0.0f )

  008af	0f 2f c8	 comiss	 xmm1, xmm0
  008b2	76 0c		 jbe	 SHORT $LN97@Attack

; 1084 : 		{
; 1085 : 			lpTargetObj->Life = 0.0f;

  008b4	c7 87 d8 00 00
	00 00 00 00 00	 mov	 DWORD PTR [edi+216], 0

; 1086 : 		}
; 1087 : 		else

  008be	eb 14		 jmp	 SHORT $LN98@Attack
$LN97@Attack:

; 1088 : 		{
; 1089 : 			AttackDamage = AttackDamage * decdamage / 100;

  008c0	0f af ce	 imul	 ecx, esi
  008c3	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  008c8	f7 e9		 imul	 ecx
  008ca	c1 fa 05	 sar	 edx, 5
  008cd	8b f2		 mov	 esi, edx
  008cf	c1 ee 1f	 shr	 esi, 31			; 0000001fH
  008d2	03 f2		 add	 esi, edx
$LN98@Attack:

; 1090 : 		}
; 1091 : 
; 1092 : 		GCReFillSend(lpTargetObj->m_Index, (WORD)lpTargetObj->Life, 0xFF, 0, lpTargetObj->iShield);

  008d4	0f b7 87 2c 01
	00 00		 movzx	 eax, WORD PTR [edi+300]
  008db	50		 push	 eax
  008dc	f3 0f 2c 87 d8
	00 00 00	 cvttss2si eax, DWORD PTR [edi+216]
  008e4	6a 00		 push	 0
  008e6	68 ff 00 00 00	 push	 255			; 000000ffH
  008eb	0f b7 c0	 movzx	 eax, ax
  008ee	50		 push	 eax
  008ef	ff 37		 push	 DWORD PTR [edi]
  008f1	e8 00 00 00 00	 call	 ?GCReFillSend@@YAXHGEEG@Z ; GCReFillSend
  008f6	83 c4 14	 add	 esp, 20			; 00000014H
$LN96@Attack:

; 1093 : 	}
; 1094 : 
; 1095 : 	if ( lpTargetObj->Live )

  008f9	80 7f 51 00	 cmp	 BYTE PTR [edi+81], 0
  008fd	0f 84 37 03 00
	00		 je	 $LN134@Attack

; 1096 : 	{
; 1097 : 		BYTE btManashield = 0;
; 1098 : 
; 1099 : 		if( gObjCheckUsedBuffEffect(lpTargetObj,BUFF_MANASHIELD) == TRUE )

  00903	6a 04		 push	 4
  00905	57		 push	 edi
  00906	e8 00 00 00 00	 call	 ?gObjCheckUsedBuffEffect@@YA_NPAUOBJECTSTRUCT@@H@Z ; gObjCheckUsedBuffEffect
  0090b	83 c4 08	 add	 esp, 8
  0090e	3c 01		 cmp	 al, 1
  00910	75 04		 jne	 SHORT $LN100@Attack

; 1100 : 			btManashield = 1;

  00912	8a c8		 mov	 cl, al
  00914	eb 18		 jmp	 SHORT $LN220@Attack
$LN100@Attack:

; 1101 : 		else if( gObjCheckUsedBuffEffect(lpTargetObj,BUFF_MANASHIELD2) )

  00916	68 8c 00 00 00	 push	 140			; 0000008cH
  0091b	57		 push	 edi
  0091c	e8 00 00 00 00	 call	 ?gObjCheckUsedBuffEffect@@YA_NPAUOBJECTSTRUCT@@H@Z ; gObjCheckUsedBuffEffect
  00921	83 c4 08	 add	 esp, 8
  00924	84 c0		 test	 al, al
  00926	0f 84 cf 00 00
	00		 je	 $LN109@Attack

; 1102 : 			btManashield = 2;

  0092c	b1 02		 mov	 cl, 2
$LN220@Attack:

; 1103 : 
; 1104 : 		if ( btManashield && AttackDamage > 0 )

  0092e	85 f6		 test	 esi, esi
  00930	0f 8e c5 00 00
	00		 jle	 $LN109@Attack

; 1105 : 		{
; 1106 : 			int EffectVal1 = 0;

  00936	33 c0		 xor	 eax, eax
  00938	89 45 10	 mov	 DWORD PTR _EffectVal1$1$[ebp], eax
  0093b	89 45 14	 mov	 DWORD PTR _EffectVal1$2[ebp], eax

; 1107 : 			int EffectVal2 = 0;

  0093e	89 45 0c	 mov	 DWORD PTR _EffectVal2$1[ebp], eax

; 1108 : 
; 1109 : 			if( btManashield == 1 )

  00941	80 f9 01	 cmp	 cl, 1
  00944	75 0c		 jne	 SHORT $LN104@Attack

; 1110 : 				gObjGetValueOfBuffIndex(lpTargetObj,BUFF_MANASHIELD,&EffectVal1,&EffectVal2);

  00946	8d 45 0c	 lea	 eax, DWORD PTR _EffectVal2$1[ebp]
  00949	50		 push	 eax
  0094a	8d 45 14	 lea	 eax, DWORD PTR _EffectVal1$2[ebp]
  0094d	50		 push	 eax
  0094e	6a 04		 push	 4
  00950	eb 12		 jmp	 SHORT $LN246@Attack
$LN104@Attack:

; 1111 : 			else if( btManashield == 2 )

  00952	80 f9 02	 cmp	 cl, 2
  00955	75 44		 jne	 SHORT $LN107@Attack

; 1112 : 				gObjGetValueOfBuffIndex(lpTargetObj,BUFF_MANASHIELD2,&EffectVal1,&EffectVal2);

  00957	8d 45 0c	 lea	 eax, DWORD PTR _EffectVal2$1[ebp]
  0095a	50		 push	 eax
  0095b	8d 45 14	 lea	 eax, DWORD PTR _EffectVal1$2[ebp]
  0095e	50		 push	 eax
  0095f	68 8c 00 00 00	 push	 140			; 0000008cH
$LN246@Attack:
  00964	57		 push	 edi
  00965	e8 00 00 00 00	 call	 ?gObjGetValueOfBuffIndex@@YA_NPAUOBJECTSTRUCT@@HPAH1@Z ; gObjGetValueOfBuffIndex

; 1113 : 
; 1114 : 			int replacemana = 0;
; 1115 : 
; 1116 : 			if( EffectVal2 > 0 )

  0096a	8b 55 0c	 mov	 edx, DWORD PTR _EffectVal2$1[ebp]
  0096d	83 c4 10	 add	 esp, 16			; 00000010H
  00970	85 d2		 test	 edx, edx
  00972	7e 21		 jle	 SHORT $LN228@Attack

; 1117 : 			{
; 1118 : 				replacemana = ((WORD)lpTargetObj->Mana * EffectVal2) / 1000;

  00974	f3 0f 10 87 ec
	00 00 00	 movss	 xmm0, DWORD PTR [edi+236]
  0097c	f3 0f 2c c0	 cvttss2si eax, xmm0
  00980	0f b7 c8	 movzx	 ecx, ax
  00983	b8 d3 4d 62 10	 mov	 eax, 274877907		; 10624dd3H
  00988	0f af ca	 imul	 ecx, edx
  0098b	f7 e9		 imul	 ecx

; 1119 : 			}
; 1120 : 			else

  0098d	8b 4d 14	 mov	 ecx, DWORD PTR _EffectVal1$2[ebp]
  00990	c1 fa 06	 sar	 edx, 6
  00993	eb 24		 jmp	 SHORT $LN247@Attack
$LN228@Attack:
  00995	8b 45 14	 mov	 eax, DWORD PTR _EffectVal1$2[ebp]
  00998	89 45 10	 mov	 DWORD PTR _EffectVal1$1$[ebp], eax
$LN107@Attack:

; 1121 : 			{
; 1122 : 				replacemana = ((WORD)lpTargetObj->Mana * 2) / 100;

  0099b	f3 0f 10 87 ec
	00 00 00	 movss	 xmm0, DWORD PTR [edi+236]
  009a3	f3 0f 2c c0	 cvttss2si eax, xmm0
  009a7	0f b7 c8	 movzx	 ecx, ax
  009aa	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  009af	03 c9		 add	 ecx, ecx
  009b1	f7 e9		 imul	 ecx
  009b3	8b 4d 10	 mov	 ecx, DWORD PTR _EffectVal1$1$[ebp]
  009b6	c1 fa 05	 sar	 edx, 5
$LN247@Attack:
  009b9	8b c2		 mov	 eax, edx
  009bb	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  009be	03 c2		 add	 eax, edx
  009c0	66 0f 6e c8	 movd	 xmm1, eax

; 1123 : 			}
; 1124 : 
; 1125 : 			if ( replacemana < lpTargetObj->Mana )

  009c4	0f 5b c9	 cvtdq2ps xmm1, xmm1
  009c7	0f 2f c1	 comiss	 xmm0, xmm1
  009ca	76 2f		 jbe	 SHORT $LN109@Attack

; 1126 : 			{
; 1127 : 				lpTargetObj->Mana -= replacemana;

  009cc	f3 0f 5c c1	 subss	 xmm0, xmm1

; 1128 : 				int decattackdamage = 0;

  009d0	33 c0		 xor	 eax, eax
  009d2	f3 0f 11 87 ec
	00 00 00	 movss	 DWORD PTR [edi+236], xmm0

; 1129 : 				
; 1130 : 				if( EffectVal1 > 0 )

  009da	85 c9		 test	 ecx, ecx
  009dc	7e 14		 jle	 SHORT $LN110@Attack

; 1131 : 				{
; 1132 : 					decattackdamage = AttackDamage * EffectVal1 / 100;

  009de	0f af ce	 imul	 ecx, esi
  009e1	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  009e6	f7 e9		 imul	 ecx
  009e8	c1 fa 05	 sar	 edx, 5
  009eb	8b c2		 mov	 eax, edx
  009ed	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  009f0	03 c2		 add	 eax, edx
$LN110@Attack:

; 1133 : 				}
; 1134 : 				AttackDamage -= decattackdamage;

  009f2	2b f0		 sub	 esi, eax

; 1135 : 				ManaChange = TRUE;

  009f4	c7 45 f0 01 00
	00 00		 mov	 DWORD PTR _ManaChange$1$[ebp], 1
$LN109@Attack:

; 1136 : 			}
; 1137 : 		}
; 1138 : 
; 1139 : 		if ( g_ShieldSystemOn == FALSE )

  009fb	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?g_ShieldSystemOn@@3HA, 0 ; g_ShieldSystemOn
  00a02	75 52		 jne	 SHORT $LN113@Attack

; 1140 : 		{
; 1141 : 			if ( lpObj->Type == OBJ_USER && lpTargetObj->Type == OBJ_USER )

  00a04	80 7b 50 01	 cmp	 BYTE PTR [ebx+80], 1
  00a08	75 4c		 jne	 SHORT $LN113@Attack
  00a0a	80 7f 50 01	 cmp	 BYTE PTR [edi+80], 1
  00a0e	75 46		 jne	 SHORT $LN113@Attack

; 1142 : 			{
; 1143 : 				if ( CC_MAP_RANGE(lpObj->MapNumber ) && CC_MAP_RANGE(lpTargetObj->MapNumber) )

  00a10	8a 83 23 01 00
	00		 mov	 al, BYTE PTR [ebx+291]
  00a16	3c 35		 cmp	 al, 53			; 00000035H
  00a18	74 0f		 je	 SHORT $LN221@Attack
  00a1a	3c 12		 cmp	 al, 18			; 00000012H
  00a1c	72 38		 jb	 SHORT $LN113@Attack
  00a1e	b1 17		 mov	 cl, 23			; 00000017H
  00a20	3a c8		 cmp	 cl, al
  00a22	1b c0		 sbb	 eax, eax
  00a24	83 c0 01	 add	 eax, 1
  00a27	74 2d		 je	 SHORT $LN113@Attack
$LN221@Attack:
  00a29	8a 87 23 01 00
	00		 mov	 al, BYTE PTR [edi+291]
  00a2f	3c 35		 cmp	 al, 53			; 00000035H
  00a31	74 0f		 je	 SHORT $LN222@Attack
  00a33	3c 12		 cmp	 al, 18			; 00000012H
  00a35	72 1f		 jb	 SHORT $LN113@Attack
  00a37	b1 17		 mov	 cl, 23			; 00000017H
  00a39	3a c8		 cmp	 cl, al
  00a3b	1b c0		 sbb	 eax, eax
  00a3d	83 c0 01	 add	 eax, 1
  00a40	74 14		 je	 SHORT $LN113@Attack
$LN222@Attack:

; 1144 : 				{
; 1145 : 					AttackDamage = AttackDamage * 50 / 100;

  00a42	6b ce 32	 imul	 ecx, esi, 50
  00a45	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  00a4a	f7 e9		 imul	 ecx
  00a4c	c1 fa 05	 sar	 edx, 5
  00a4f	8b f2		 mov	 esi, edx
  00a51	c1 ee 1f	 shr	 esi, 31			; 0000001fH
  00a54	03 f2		 add	 esi, edx
$LN113@Attack:

; 1146 : 				}
; 1147 : 			}
; 1148 : 		}
; 1149 : 
; 1150 : #if (GS_CASTLE == 1)
; 1151 : 
; 1152 : 		if ( g_CastleSiege.GetCastleState() == CASTLESIEGE_STATE_STARTSIEGE 
; 1153 : 			&& lpObj->Type == OBJ_USER
; 1154 : 			&& lpTargetObj->Type == OBJ_USER
; 1155 : 			&& lpObj->MapNumber == MAP_INDEX_CASTLESIEGE
; 1156 : 			&& lpTargetObj->MapNumber == MAP_INDEX_CASTLESIEGE)

  00a56	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_CastleSiege@@3VCCastleSiege@@A ; g_CastleSiege
  00a5b	e8 00 00 00 00	 call	 ?GetCastleState@CCastleSiege@@QAEHXZ ; CCastleSiege::GetCastleState
  00a60	83 f8 07	 cmp	 eax, 7
  00a63	75 58		 jne	 SHORT $LN117@Attack
  00a65	80 7b 50 01	 cmp	 BYTE PTR [ebx+80], 1
  00a69	0f 85 9e 01 00
	00		 jne	 $LN131@Attack
  00a6f	80 7f 50 01	 cmp	 BYTE PTR [edi+80], 1
  00a73	75 48		 jne	 SHORT $LN117@Attack
  00a75	80 bb 23 01 00
	00 1e		 cmp	 BYTE PTR [ebx+291], 30	; 0000001eH
  00a7c	75 3f		 jne	 SHORT $LN117@Attack
  00a7e	80 bf 23 01 00
	00 1e		 cmp	 BYTE PTR [edi+291], 30	; 0000001eH
  00a85	75 36		 jne	 SHORT $LN117@Attack

; 1157 : 		{
; 1158 : 			if(lpObj->m_btCsJoinSide == lpTargetObj->m_btCsJoinSide)

  00a87	8a 83 5a 20 00
	00		 mov	 al, BYTE PTR [ebx+8282]
  00a8d	3a 87 5a 20 00
	00		 cmp	 al, BYTE PTR [edi+8282]
  00a93	75 08		 jne	 SHORT $LN115@Attack

; 1159 : 			{
; 1160 : 				AttackDamage = AttackDamage * 20 / 100;

  00a95	8d 0c b6	 lea	 ecx, DWORD PTR [esi+esi*4]
  00a98	c1 e1 02	 shl	 ecx, 2
  00a9b	eb 0f		 jmp	 SHORT $LN250@Attack
$LN115@Attack:

; 1161 : 			}
; 1162 : 			else if(g_ShieldSystemOn == FALSE)

  00a9d	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?g_ShieldSystemOn@@3HA, 0 ; g_ShieldSystemOn
  00aa4	75 17		 jne	 SHORT $LN117@Attack

; 1163 : 			{
; 1164 : 				AttackDamage = AttackDamage * 40 / 100;

  00aa6	8d 0c b6	 lea	 ecx, DWORD PTR [esi+esi*4]
  00aa9	c1 e1 03	 shl	 ecx, 3
$LN250@Attack:
  00aac	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  00ab1	f7 e9		 imul	 ecx
  00ab3	c1 fa 05	 sar	 edx, 5
  00ab6	8b f2		 mov	 esi, edx
  00ab8	c1 ee 1f	 shr	 esi, 31			; 0000001fH
  00abb	03 f2		 add	 esi, edx
$LN117@Attack:

; 1165 : 			}
; 1166 : 		}
; 1167 : #endif
; 1168 : 
; 1169 : 		if ( lpObj->Type == OBJ_USER && lpTargetObj->Type == OBJ_MONSTER )

  00abd	80 7b 50 01	 cmp	 BYTE PTR [ebx+80], 1
  00ac1	0f 85 46 01 00
	00		 jne	 $LN131@Attack
  00ac7	80 7f 50 02	 cmp	 BYTE PTR [edi+80], 2
  00acb	0f 85 12 01 00
	00		 jne	 $LN127@Attack

; 1170 : 		{
; 1171 : 			if ( lpTargetObj->Class == 283 )

  00ad1	b8 1b 01 00 00	 mov	 eax, 283		; 0000011bH
  00ad6	66 39 87 90 00
	00 00		 cmp	 WORD PTR [edi+144], ax
  00add	75 7b		 jne	 SHORT $LN121@Attack

; 1172 : 			{
; 1173 : 				if ( gObjCheckUsedBuffEffect(lpObj,BUFF_POT_BLESS) ||

  00adf	6a 0a		 push	 10			; 0000000aH
  00ae1	53		 push	 ebx
  00ae2	e8 00 00 00 00	 call	 ?gObjCheckUsedBuffEffect@@YA_NPAUOBJECTSTRUCT@@H@Z ; gObjCheckUsedBuffEffect
  00ae7	83 c4 08	 add	 esp, 8
  00aea	84 c0		 test	 al, al
  00aec	75 53		 jne	 SHORT $LN122@Attack
  00aee	6a 0b		 push	 11			; 0000000bH
  00af0	53		 push	 ebx
  00af1	e8 00 00 00 00	 call	 ?gObjCheckUsedBuffEffect@@YA_NPAUOBJECTSTRUCT@@H@Z ; gObjCheckUsedBuffEffect
  00af6	83 c4 08	 add	 esp, 8
  00af9	84 c0		 test	 al, al
  00afb	75 44		 jne	 SHORT $LN122@Attack

; 1177 : 				}
; 1178 : 				else 
; 1179 : 				{
; 1180 : 					if ( lpObj->m_iAccumulatedDamage > 100 )

  00afd	8b 83 68 20 00
	00		 mov	 eax, DWORD PTR [ebx+8296]
  00b03	83 f8 64	 cmp	 eax, 100		; 00000064H
  00b06	7e 18		 jle	 SHORT $LN123@Attack

; 1181 : 					{
; 1182 : 						gObjWeaponDurDownInCastle(lpObj, lpTargetObj, 1);

  00b08	6a 01		 push	 1
  00b0a	57		 push	 edi
  00b0b	53		 push	 ebx
  00b0c	e8 00 00 00 00	 call	 ?gObjWeaponDurDownInCastle@@YAXPAUOBJECTSTRUCT@@0H@Z ; gObjWeaponDurDownInCastle
  00b11	83 c4 0c	 add	 esp, 12			; 0000000cH

; 1183 : 						lpObj->m_iAccumulatedDamage = 0;

  00b14	c7 83 68 20 00
	00 00 00 00 00	 mov	 DWORD PTR [ebx+8296], 0

; 1184 : 					}
; 1185 : 					else

  00b1e	eb 08		 jmp	 SHORT $LN124@Attack
$LN123@Attack:

; 1186 : 					{
; 1187 : 						lpObj->m_iAccumulatedDamage += AttackDamage;

  00b20	03 c6		 add	 eax, esi
  00b22	89 83 68 20 00
	00		 mov	 DWORD PTR [ebx+8296], eax
$LN124@Attack:

; 1188 : 					}
; 1189 : 
; 1190 : 					AttackDamage = AttackDamage * 20 / 100;

  00b28	8d 0c b6	 lea	 ecx, DWORD PTR [esi+esi*4]
  00b2b	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  00b30	c1 e1 02	 shl	 ecx, 2
  00b33	f7 e9		 imul	 ecx
  00b35	c1 fa 05	 sar	 edx, 5
  00b38	8b f2		 mov	 esi, edx
  00b3a	c1 ee 1f	 shr	 esi, 31			; 0000001fH
  00b3d	03 f2		 add	 esi, edx
  00b3f	eb 19		 jmp	 SHORT $LN121@Attack
$LN122@Attack:

; 1174 : 					 gObjCheckUsedBuffEffect(lpObj,BUFF_POT_SOUL) )
; 1175 : 				{
; 1176 : 					AttackDamage += (AttackDamage * 20) / 100;

  00b41	8d 0c b6	 lea	 ecx, DWORD PTR [esi+esi*4]
  00b44	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  00b49	c1 e1 02	 shl	 ecx, 2
  00b4c	f7 e9		 imul	 ecx
  00b4e	c1 fa 05	 sar	 edx, 5
  00b51	8b c2		 mov	 eax, edx
  00b53	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  00b56	03 c2		 add	 eax, edx
  00b58	03 f0		 add	 esi, eax
$LN121@Attack:

; 1191 : 				}
; 1192 : 			}
; 1193 : 
; 1194 : 			if ( lpTargetObj->Class == 277 )

  00b5a	b8 15 01 00 00	 mov	 eax, 277		; 00000115H
  00b5f	66 39 87 90 00
	00 00		 cmp	 WORD PTR [edi+144], ax
  00b66	75 7b		 jne	 SHORT $LN127@Attack

; 1195 : 			{
; 1196 : 				if ( gObjCheckUsedBuffEffect(lpObj,BUFF_POT_BLESS) ||

  00b68	6a 0a		 push	 10			; 0000000aH
  00b6a	53		 push	 ebx
  00b6b	e8 00 00 00 00	 call	 ?gObjCheckUsedBuffEffect@@YA_NPAUOBJECTSTRUCT@@H@Z ; gObjCheckUsedBuffEffect
  00b70	83 c4 08	 add	 esp, 8
  00b73	84 c0		 test	 al, al
  00b75	75 53		 jne	 SHORT $LN128@Attack
  00b77	6a 0b		 push	 11			; 0000000bH
  00b79	53		 push	 ebx
  00b7a	e8 00 00 00 00	 call	 ?gObjCheckUsedBuffEffect@@YA_NPAUOBJECTSTRUCT@@H@Z ; gObjCheckUsedBuffEffect
  00b7f	83 c4 08	 add	 esp, 8
  00b82	84 c0		 test	 al, al
  00b84	75 44		 jne	 SHORT $LN128@Attack

; 1200 : 				}
; 1201 : 				else 
; 1202 : 				{
; 1203 : 					if ( lpObj->m_iAccumulatedDamage > 100 )

  00b86	8b 83 68 20 00
	00		 mov	 eax, DWORD PTR [ebx+8296]
  00b8c	83 f8 64	 cmp	 eax, 100		; 00000064H
  00b8f	7e 18		 jle	 SHORT $LN129@Attack

; 1204 : 					{
; 1205 : 						gObjWeaponDurDownInCastle(lpObj, lpTargetObj, 1);

  00b91	6a 01		 push	 1
  00b93	57		 push	 edi
  00b94	53		 push	 ebx
  00b95	e8 00 00 00 00	 call	 ?gObjWeaponDurDownInCastle@@YAXPAUOBJECTSTRUCT@@0H@Z ; gObjWeaponDurDownInCastle
  00b9a	83 c4 0c	 add	 esp, 12			; 0000000cH

; 1206 : 						lpObj->m_iAccumulatedDamage = 0;

  00b9d	c7 83 68 20 00
	00 00 00 00 00	 mov	 DWORD PTR [ebx+8296], 0

; 1207 : 					}
; 1208 : 					else

  00ba7	eb 08		 jmp	 SHORT $LN130@Attack
$LN129@Attack:

; 1209 : 					{
; 1210 : 						lpObj->m_iAccumulatedDamage += AttackDamage;

  00ba9	03 c6		 add	 eax, esi
  00bab	89 83 68 20 00
	00		 mov	 DWORD PTR [ebx+8296], eax
$LN130@Attack:

; 1211 : 					}
; 1212 : 
; 1213 : 					AttackDamage = AttackDamage * 20 / 100;

  00bb1	8d 0c b6	 lea	 ecx, DWORD PTR [esi+esi*4]
  00bb4	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  00bb9	c1 e1 02	 shl	 ecx, 2
  00bbc	f7 e9		 imul	 ecx
  00bbe	c1 fa 05	 sar	 edx, 5
  00bc1	8b f2		 mov	 esi, edx
  00bc3	c1 ee 1f	 shr	 esi, 31			; 0000001fH
  00bc6	03 f2		 add	 esi, edx
  00bc8	eb 19		 jmp	 SHORT $LN127@Attack
$LN128@Attack:

; 1197 : 					 gObjCheckUsedBuffEffect(lpObj,BUFF_POT_SOUL) )
; 1198 : 				{
; 1199 : 					AttackDamage += (AttackDamage * 20) / 100;

  00bca	8d 0c b6	 lea	 ecx, DWORD PTR [esi+esi*4]
  00bcd	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  00bd2	c1 e1 02	 shl	 ecx, 2
  00bd5	f7 e9		 imul	 ecx
  00bd7	c1 fa 05	 sar	 edx, 5
  00bda	8b c2		 mov	 eax, edx
  00bdc	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  00bdf	03 c2		 add	 eax, edx
  00be1	03 f0		 add	 esi, eax
$LN127@Attack:

; 1214 : 				}
; 1215 : 			}
; 1216 : 		}
; 1217 : 
; 1218 : 		if ( lpObj->Type == OBJ_USER && lpTargetObj->Type == OBJ_USER )

  00be3	80 7b 50 01	 cmp	 BYTE PTR [ebx+80], 1
  00be7	75 24		 jne	 SHORT $LN131@Attack
  00be9	80 7f 50 01	 cmp	 BYTE PTR [edi+80], 1
  00bed	75 1e		 jne	 SHORT $LN131@Attack

; 1219 : 		{
; 1220 : 			iTempShieldDamage = this->GetShieldDamage(lpObj, lpTargetObj, AttackDamage);

  00bef	8b 4d fc	 mov	 ecx, DWORD PTR _this$1$[ebp]
  00bf2	56		 push	 esi
  00bf3	57		 push	 edi
  00bf4	53		 push	 ebx
  00bf5	e8 00 00 00 00	 call	 ?GetShieldDamage@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0H@Z ; CDarkSpirit::GetShieldDamage

; 1221 : 			lpTargetObj->iShield -= iTempShieldDamage;

  00bfa	29 87 2c 01 00
	00		 sub	 DWORD PTR [edi+300], eax

; 1222 : 			lpTargetObj->Life -= AttackDamage - iTempShieldDamage;

  00c00	8b ce		 mov	 ecx, esi
  00c02	2b c8		 sub	 ecx, eax
  00c04	89 45 f4	 mov	 DWORD PTR _iTotalShieldDamage$1$[ebp], eax
  00c07	66 0f 6e c1	 movd	 xmm0, ecx

; 1223 : 			iTotalShieldDamage += iTempShieldDamage;
; 1224 : 
; 1225 : 			if ( lpTargetObj->Life < 0.0f )
; 1226 : 			{
; 1227 : 				lpTargetObj->Life = 0.0f;
; 1228 : 			}
; 1229 : 		}
; 1230 : 		else

  00c0b	eb 04		 jmp	 SHORT $LN252@Attack
$LN131@Attack:
  00c0d	66 0f 6e c6	 movd	 xmm0, esi
$LN252@Attack:

; 1231 : 		{
; 1232 : 			lpTargetObj->Life -= AttackDamage;

  00c11	f3 0f 10 8f d8
	00 00 00	 movss	 xmm1, DWORD PTR [edi+216]
  00c19	0f 5b c0	 cvtdq2ps xmm0, xmm0
  00c1c	f3 0f 5c c8	 subss	 xmm1, xmm0
  00c20	0f 57 c0	 xorps	 xmm0, xmm0

; 1233 : 
; 1234 : 			if ( lpTargetObj->Life < 0.0f )

  00c23	0f 2f c1	 comiss	 xmm0, xmm1
  00c26	f3 0f 11 8f d8
	00 00 00	 movss	 DWORD PTR [edi+216], xmm1
  00c2e	76 0a		 jbe	 SHORT $LN134@Attack

; 1235 : 			{
; 1236 : 				lpTargetObj->Life = 0.0f;

  00c30	c7 87 d8 00 00
	00 00 00 00 00	 mov	 DWORD PTR [edi+216], 0
$LN134@Attack:

; 1237 : 			}
; 1238 : 		}
; 1239 : 	}
; 1240 : 
; 1241 : 	if ( lpTargetObj->Type == OBJ_MONSTER )

  00c3a	80 7f 50 02	 cmp	 BYTE PTR [edi+80], 2
  00c3e	75 43		 jne	 SHORT $LN136@Attack

; 1242 : 	{
; 1243 : 		gObjAddMsgSendDelay(lpTargetObj, 0, lpObj->m_Index, 100, 0);

  00c40	6a 00		 push	 0
  00c42	6a 64		 push	 100			; 00000064H
  00c44	ff 33		 push	 DWORD PTR [ebx]
  00c46	6a 00		 push	 0
  00c48	57		 push	 edi
  00c49	e8 00 00 00 00	 call	 ?gObjAddMsgSendDelay@@YAXPAUOBJECTSTRUCT@@HHHH@Z ; gObjAddMsgSendDelay

; 1244 : 		lpTargetObj->LastAttackerID = lpObj->m_Index;

  00c4e	66 8b 0b	 mov	 cx, WORD PTR [ebx]
  00c51	83 c4 14	 add	 esp, 20			; 00000014H

; 1245 : 
; 1246 : 		if ( lpTargetObj->m_iCurrentAI )

  00c54	83 bf d0 20 00
	00 00		 cmp	 DWORD PTR [edi+8400], 0
  00c5b	66 89 8f 3e 06
	00 00		 mov	 WORD PTR [edi+1598], cx
  00c62	74 1f		 je	 SHORT $LN136@Attack

; 1247 : 		{
; 1248 : 			lpTargetObj->m_Agro.IncAgro(lpObj->m_Index, AttackDamage / 100);

  00c64	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  00c69	8d 8f ec 20 00
	00		 lea	 ecx, DWORD PTR [edi+8428]
  00c6f	f7 ee		 imul	 esi
  00c71	c1 fa 05	 sar	 edx, 5
  00c74	8b c2		 mov	 eax, edx
  00c76	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  00c79	03 c2		 add	 eax, edx
  00c7b	50		 push	 eax
  00c7c	ff 33		 push	 DWORD PTR [ebx]
  00c7e	e8 00 00 00 00	 call	 ?IncAgro@TMonsterAIAgro@@QAEHHH@Z ; TMonsterAIAgro::IncAgro
$LN136@Attack:

; 1249 : 		}
; 1250 : 	}
; 1251 : 
; 1252 : 	BOOL selfdefense = 0;
; 1253 : 	lpCallObj = lpTargetObj;
; 1254 : 	
; 1255 : 	if ( lpTargetObj->Type == OBJ_MONSTER )

  00c83	8a 57 50	 mov	 dl, BYTE PTR [edi+80]
  00c86	33 c0		 xor	 eax, eax
  00c88	89 45 14	 mov	 DWORD PTR _selfdefense$2$[ebp], eax
  00c8b	8b cf		 mov	 ecx, edi
  00c8d	89 4d 0c	 mov	 DWORD PTR _lpCallObj$1$[ebp], ecx
  00c90	80 fa 02	 cmp	 dl, 2
  00c93	75 19		 jne	 SHORT $LN138@Attack

; 1256 : 	{
; 1257 : 		if ( lpTargetObj->m_RecallMon >= 0 )

  00c95	8b 8f 30 06 00
	00		 mov	 ecx, DWORD PTR [edi+1584]
  00c9b	85 c9		 test	 ecx, ecx
  00c9d	78 0f		 js	 SHORT $LN138@Attack

; 1258 : 		{
; 1259 : 			lpCallObj = &gObj[lpTargetObj->m_RecallMon];

  00c9f	69 c9 40 27 00
	00		 imul	 ecx, ecx, 10048
  00ca5	03 0d 00 00 00
	00		 add	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00cab	89 4d 0c	 mov	 DWORD PTR _lpCallObj$1$[ebp], ecx
$LN138@Attack:

; 1260 : 		}
; 1261 : 	}
; 1262 : 
; 1263 : 	if ( AttackDamage >= 1 )

  00cae	83 fe 01	 cmp	 esi, 1
  00cb1	0f 8c 44 01 00
	00		 jl	 $LN161@Attack

; 1264 : 	{
; 1265 : 		if ( lpObj->Type == OBJ_USER && lpTargetObj->Type == OBJ_USER )

  00cb7	8a 4b 50	 mov	 cl, BYTE PTR [ebx+80]
  00cba	80 f9 01	 cmp	 cl, 1
  00cbd	0f 85 e8 00 00
	00		 jne	 $LN140@Attack
  00cc3	3a d1		 cmp	 dl, cl
  00cc5	0f 85 e0 00 00
	00		 jne	 $LN140@Attack

; 1266 : 		{
; 1267 : 			if ( gObjDuelCheck(lpObj, lpTargetObj) )

  00ccb	57		 push	 edi
  00ccc	53		 push	 ebx
  00ccd	e8 00 00 00 00	 call	 ?gObjDuelCheck@@YAHPAUOBJECTSTRUCT@@0@Z ; gObjDuelCheck
  00cd2	83 c4 08	 add	 esp, 8
  00cd5	85 c0		 test	 eax, eax
  00cd7	75 4c		 jne	 SHORT $LN146@Attack

; 1268 : 			{
; 1269 : 				selfdefense = 0;
; 1270 : 			}
; 1271 : 			else if ( CC_MAP_RANGE(lpObj->MapNumber) || CC_MAP_RANGE(lpTargetObj->MapNumber) )

  00cd9	8a 93 23 01 00
	00		 mov	 dl, BYTE PTR [ebx+291]
  00cdf	80 fa 35	 cmp	 dl, 53			; 00000035H
  00ce2	74 41		 je	 SHORT $LN146@Attack
  00ce4	80 fa 12	 cmp	 dl, 18			; 00000012H
  00ce7	72 0e		 jb	 SHORT $LN223@Attack
  00ce9	b8 17 00 00 00	 mov	 eax, 23			; 00000017H
  00cee	3a c2		 cmp	 al, dl
  00cf0	1b c0		 sbb	 eax, eax
  00cf2	83 c0 01	 add	 eax, 1
  00cf5	75 2e		 jne	 SHORT $LN146@Attack
$LN223@Attack:
  00cf7	8a 87 23 01 00
	00		 mov	 al, BYTE PTR [edi+291]
  00cfd	3c 35		 cmp	 al, 53			; 00000035H
  00cff	74 24		 je	 SHORT $LN146@Attack
  00d01	3c 12		 cmp	 al, 18			; 00000012H
  00d03	72 0b		 jb	 SHORT $LN224@Attack
  00d05	b1 17		 mov	 cl, 23			; 00000017H
  00d07	3a c8		 cmp	 cl, al
  00d09	1b c0		 sbb	 eax, eax
  00d0b	83 c0 01	 add	 eax, 1
  00d0e	75 15		 jne	 SHORT $LN146@Attack
$LN224@Attack:

; 1274 : 			}
; 1275 : #if (__GENS_SYSTEM__ == 1)
; 1276 : 			else if ( gGensSystem.GensMap(lpObj->MapNumber) )

  00d10	0f b6 c2	 movzx	 eax, dl
  00d13	b9 00 00 00 00	 mov	 ecx, OFFSET ?gGensSystem@@3VCGensSystem@@A ; gGensSystem
  00d18	50		 push	 eax
  00d19	e8 00 00 00 00	 call	 ?GensMap@CGensSystem@@QAEHH@Z ; CGensSystem::GensMap
  00d1e	f7 d8		 neg	 eax
  00d20	1b c0		 sbb	 eax, eax
  00d22	40		 inc	 eax

; 1277 : 			{
; 1278 : 				selfdefense = 0;
; 1279 : 			}
; 1280 : #endif
; 1281 : 			else
; 1282 : 			{
; 1283 : 				selfdefense = 1;

  00d23	eb 02		 jmp	 SHORT $LN253@Attack
$LN146@Attack:

; 1272 : 			{
; 1273 : 				selfdefense = 0;

  00d25	33 c0		 xor	 eax, eax
$LN253@Attack:

; 1284 : 			}
; 1285 : 
; 1286 : 			if ( gObjGetRelationShip(lpObj, lpTargetObj) == 2 )

  00d27	57		 push	 edi
  00d28	53		 push	 ebx
  00d29	89 45 14	 mov	 DWORD PTR _selfdefense$2$[ebp], eax
  00d2c	e8 00 00 00 00	 call	 ?gObjGetRelationShip@@YAHPAUOBJECTSTRUCT@@0@Z ; gObjGetRelationShip
  00d31	33 d2		 xor	 edx, edx
  00d33	83 c4 08	 add	 esp, 8
  00d36	83 f8 02	 cmp	 eax, 2

; 1287 : 			{
; 1288 : 				selfdefense = FALSE;
; 1289 : 			}
; 1290 : 
; 1291 : #if (GS_CASTLE == 1)
; 1292 : 			if(g_CastleSiege.GetCastleState() == CASTLESIEGE_STATE_STARTSIEGE)

  00d39	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_CastleSiege@@3VCCastleSiege@@A ; g_CastleSiege
  00d3e	8b 45 14	 mov	 eax, DWORD PTR _selfdefense$2$[ebp]
  00d41	0f 44 c2	 cmove	 eax, edx
  00d44	89 45 14	 mov	 DWORD PTR _selfdefense$2$[ebp], eax
  00d47	e8 00 00 00 00	 call	 ?GetCastleState@CCastleSiege@@QAEHXZ ; CCastleSiege::GetCastleState
  00d4c	83 f8 07	 cmp	 eax, 7
  00d4f	75 12		 jne	 SHORT $LN150@Attack

; 1293 : 			{
; 1294 : 				if( lpObj->m_btCsJoinSide > 0 )

  00d51	80 bb 5a 20 00
	00 00		 cmp	 BYTE PTR [ebx+8282], 0
  00d58	76 6c		 jbe	 SHORT $LN159@Attack

; 1295 : 				{
; 1296 : 					selfdefense = FALSE;

  00d5a	c7 45 14 00 00
	00 00		 mov	 DWORD PTR _selfdefense$2$[ebp], 0

; 1297 : 				}
; 1298 : 			}

  00d61	eb 63		 jmp	 SHORT $LN159@Attack
$LN150@Attack:

; 1299 : #endif
; 1300 : 
; 1301 : 			else if( IT_MAP_RANGE(lpObj->MapNumber) ||

  00d63	8a 93 23 01 00
	00		 mov	 dl, BYTE PTR [ebx+291]
  00d69	80 fa 2d	 cmp	 dl, 45			; 0000002dH
  00d6c	72 0b		 jb	 SHORT $LN225@Attack
  00d6e	b0 32		 mov	 al, 50			; 00000032H
  00d70	3a c2		 cmp	 al, dl
  00d72	1b c0		 sbb	 eax, eax
  00d74	83 c0 01	 add	 eax, 1
  00d77	75 16		 jne	 SHORT $LN155@Attack
$LN225@Attack:
  00d79	8a 8f 23 01 00
	00		 mov	 cl, BYTE PTR [edi+291]
  00d7f	80 f9 2d	 cmp	 cl, 45			; 0000002dH
  00d82	72 14		 jb	 SHORT $LN226@Attack
  00d84	b0 32		 mov	 al, 50			; 00000032H
  00d86	3a c1		 cmp	 al, cl
  00d88	1b c0		 sbb	 eax, eax
  00d8a	83 c0 01	 add	 eax, 1
  00d8d	74 09		 je	 SHORT $LN226@Attack
$LN155@Attack:

; 1302 : 				IT_MAP_RANGE(lpTargetObj->MapNumber) )
; 1303 : 			{
; 1304 : 				selfdefense = FALSE;

  00d8f	c7 45 14 00 00
	00 00		 mov	 DWORD PTR _selfdefense$2$[ebp], 0

; 1309 : 			}
; 1310 : 		}

  00d96	eb 2e		 jmp	 SHORT $LN159@Attack
$LN226@Attack:

; 1305 : 			}
; 1306 : 			else if( lpObj->MapNumber == MAP_INDEX_VULCANUS || lpTargetObj->MapNumber == MAP_INDEX_VULCANUS )

  00d98	80 fa 3f	 cmp	 dl, 63			; 0000003fH
  00d9b	74 f2		 je	 SHORT $LN155@Attack
  00d9d	80 f9 3f	 cmp	 cl, 63			; 0000003fH
  00da0	75 24		 jne	 SHORT $LN159@Attack

; 1307 : 			{
; 1308 : 				selfdefense = FALSE;

  00da2	c7 45 14 00 00
	00 00		 mov	 DWORD PTR _selfdefense$2$[ebp], 0
  00da9	eb 1b		 jmp	 SHORT $LN159@Attack
$LN140@Attack:

; 1311 : 		else if ( lpTargetObj->Type == OBJ_MONSTER && lpObj->Type == OBJ_USER )

  00dab	80 fa 02	 cmp	 dl, 2
  00dae	75 16		 jne	 SHORT $LN159@Attack
  00db0	80 f9 01	 cmp	 cl, 1
  00db3	75 11		 jne	 SHORT $LN159@Attack

; 1312 : 		{
; 1313 : 			if ( lpTargetObj->m_RecallMon >= 0 )

  00db5	39 87 30 06 00
	00		 cmp	 DWORD PTR [edi+1584], eax
  00dbb	b9 01 00 00 00	 mov	 ecx, 1
  00dc0	0f 4d c1	 cmovge	 eax, ecx
  00dc3	89 45 14	 mov	 DWORD PTR _selfdefense$2$[ebp], eax
$LN159@Attack:

; 1314 : 			{
; 1315 : 				selfdefense = TRUE;
; 1316 : 			}
; 1317 : 		}
; 1318 : 
; 1319 : 		if ( lpTargetObj->Type == OBJ_USER )

  00dc6	80 7f 50 01	 cmp	 BYTE PTR [edi+80], 1
  00dca	75 0a		 jne	 SHORT $LN160@Attack

; 1320 : 		{
; 1321 : 			gObjArmorRandomDurDown(lpTargetObj, lpObj);

  00dcc	53		 push	 ebx
  00dcd	57		 push	 edi
  00dce	e8 00 00 00 00	 call	 ?gObjArmorRandomDurDown@@YAXPAUOBJECTSTRUCT@@0@Z ; gObjArmorRandomDurDown
  00dd3	83 c4 08	 add	 esp, 8
$LN160@Attack:

; 1322 : 		}
; 1323 : 
; 1324 : 		if ( gObjCheckUsedBuffEffect(lpTargetObj,BUFF_ICEARROW) == TRUE )

  00dd6	6a 39		 push	 57			; 00000039H
  00dd8	57		 push	 edi
  00dd9	e8 00 00 00 00	 call	 ?gObjCheckUsedBuffEffect@@YA_NPAUOBJECTSTRUCT@@H@Z ; gObjCheckUsedBuffEffect
  00dde	83 c4 08	 add	 esp, 8
  00de1	3c 01		 cmp	 al, 1
  00de3	75 13		 jne	 SHORT $LN233@Attack

; 1325 : 		{
; 1326 : 			gObjRemoveBuffEffect(lpTargetObj,BUFF_ICEARROW);

  00de5	6a 39		 push	 57			; 00000039H
  00de7	57		 push	 edi
  00de8	e8 00 00 00 00	 call	 ?gObjRemoveBuffEffect@@YA_NPAUOBJECTSTRUCT@@H@Z ; gObjRemoveBuffEffect

; 1327 : 			GCMagicCancelSend(lpTargetObj,51);

  00ded	6a 33		 push	 51			; 00000033H
  00def	57		 push	 edi
  00df0	e8 00 00 00 00	 call	 ?GCMagicCancelSend@@YAXPAUOBJECTSTRUCT@@H@Z ; GCMagicCancelSend
  00df5	83 c4 10	 add	 esp, 16			; 00000010H
$LN233@Attack:
  00df8	8b 45 14	 mov	 eax, DWORD PTR _selfdefense$2$[ebp]
$LN161@Attack:

; 1328 : 		}
; 1329 : 	}
; 1330 : 
; 1331 : 	if ( lpObj->PartyNumber >= 0 &&

  00dfb	83 bb 0c 06 00
	00 00		 cmp	 DWORD PTR [ebx+1548], 0
  00e02	8b 4d 0c	 mov	 ecx, DWORD PTR _lpCallObj$1$[ebp]
  00e05	7c 12		 jl	 SHORT $LN163@Attack
  00e07	8b 91 0c 06 00
	00		 mov	 edx, DWORD PTR [ecx+1548]
  00e0d	85 d2		 test	 edx, edx
  00e0f	78 08		 js	 SHORT $LN163@Attack

; 1332 : 		 lpCallObj->PartyNumber >= 0)
; 1333 : 	{
; 1334 : 		if( lpObj->PartyNumber == lpCallObj->PartyNumber )

  00e11	39 93 0c 06 00
	00		 cmp	 DWORD PTR [ebx+1548], edx
  00e17	74 41		 je	 SHORT $LN167@Attack
$LN163@Attack:

; 1335 : 		{
; 1336 : 			selfdefense = 0;
; 1337 : 		}
; 1338 : 	}
; 1339 : 
; 1340 : 	if ( selfdefense == TRUE )

  00e19	83 f8 01	 cmp	 eax, 1
  00e1c	75 3c		 jne	 SHORT $LN167@Attack

; 1341 : 	{
; 1342 : 		if ( !gObjTargetGuildWarCheck(lpObj, lpCallObj) )

  00e1e	51		 push	 ecx
  00e1f	53		 push	 ebx
  00e20	e8 00 00 00 00	 call	 ?gObjTargetGuildWarCheck@@YAHPAUOBJECTSTRUCT@@0@Z ; gObjTargetGuildWarCheck
  00e25	83 c4 08	 add	 esp, 8
  00e28	85 c0		 test	 eax, eax
  00e2a	75 2e		 jne	 SHORT $LN167@Attack

; 1343 : 		{
; 1344 : 			if( lpCallObj->PartyNumber >= 0 )

  00e2c	8b 45 0c	 mov	 eax, DWORD PTR _lpCallObj$1$[ebp]
  00e2f	8b 88 0c 06 00
	00		 mov	 ecx, DWORD PTR [eax+1548]
  00e35	85 c9		 test	 ecx, ecx
  00e37	78 16		 js	 SHORT $LN166@Attack

; 1345 : 			{
; 1346 : 				int bTmp = 0;
; 1347 : 				int PartyNumber = lpCallObj->PartyNumber;
; 1348 : 
; 1349 : 				if( gParty.GetPartyPkLevel(PartyNumber) < 5 )

  00e39	51		 push	 ecx
  00e3a	b9 00 00 00 00	 mov	 ecx, OFFSET ?gParty@@3VPartyClass@@A ; gParty
  00e3f	e8 00 00 00 00	 call	 ?GetPartyPkLevel@PartyClass@@QAEDH@Z ; PartyClass::GetPartyPkLevel
  00e44	3c 05		 cmp	 al, 5
  00e46	7d 12		 jge	 SHORT $LN167@Attack

; 1350 : 				{
; 1351 : 					gObjCheckSelfDefense(lpObj, lpCallObj->m_Index);

  00e48	8b 4d 0c	 mov	 ecx, DWORD PTR _lpCallObj$1$[ebp]
  00e4b	ff 31		 push	 DWORD PTR [ecx]

; 1352 : 				}
; 1353 : 			}
; 1354 : 			else

  00e4d	eb 02		 jmp	 SHORT $LN254@Attack
$LN166@Attack:

; 1355 : 			{
; 1356 : 				gObjCheckSelfDefense(lpObj, lpCallObj->m_Index);

  00e4f	ff 30		 push	 DWORD PTR [eax]
$LN254@Attack:
  00e51	53		 push	 ebx
  00e52	e8 00 00 00 00	 call	 ?gObjCheckSelfDefense@@YAXPAUOBJECTSTRUCT@@H@Z ; gObjCheckSelfDefense
  00e57	83 c4 08	 add	 esp, 8
$LN167@Attack:

; 1357 : 			}
; 1358 : 		}
; 1359 : 	}
; 1360 : 
; 1361 : 	if ( AttackDamage >= 5 )	// To make strong hit

  00e5a	83 fe 05	 cmp	 esi, 5
  00e5d	7c 54		 jl	 SHORT $LN174@Attack

; 1362 : 	{
; 1363 : 		if ( lpTargetObj->Type == OBJ_MONSTER )

  00e5f	80 7f 50 02	 cmp	 BYTE PTR [edi+80], 2
  00e63	75 23		 jne	 SHORT $LN170@Attack

; 1364 : 		{
; 1365 : 			if ( (rand()%26) == 0 )

  00e65	e8 00 00 00 00	 call	 _rand
  00e6a	99		 cdq
  00e6b	b9 1a 00 00 00	 mov	 ecx, 26			; 0000001aH
  00e70	f7 f9		 idiv	 ecx
  00e72	85 d2		 test	 edx, edx
  00e74	75 3d		 jne	 SHORT $LN174@Attack

; 1366 : 			{
; 1367 : 				gObjAddMsgSendDelay(lpTargetObj,4, lpObj->m_Index, 100, 0);

  00e76	52		 push	 edx
  00e77	6a 64		 push	 100			; 00000064H
  00e79	ff 33		 push	 DWORD PTR [ebx]
  00e7b	6a 04		 push	 4
  00e7d	57		 push	 edi
  00e7e	e8 00 00 00 00	 call	 ?gObjAddMsgSendDelay@@YAXPAUOBJECTSTRUCT@@HHHH@Z ; gObjAddMsgSendDelay
  00e83	83 c4 14	 add	 esp, 20			; 00000014H

; 1368 : 			}
; 1369 : 		}

  00e86	eb 2b		 jmp	 SHORT $LN174@Attack
$LN170@Attack:

; 1370 : 		else if ( (rand()%4) == 0 )

  00e88	e8 00 00 00 00	 call	 _rand
  00e8d	25 03 00 00 80	 and	 eax, -2147483645	; 80000003H
  00e92	79 05		 jns	 SHORT $LN238@Attack
  00e94	48		 dec	 eax
  00e95	83 c8 fc	 or	 eax, -4			; fffffffcH
  00e98	40		 inc	 eax
$LN238@Attack:
  00e99	75 18		 jne	 SHORT $LN174@Attack

; 1371 : 		{
; 1372 : 			if ( !gObjUniriaSprite(lpTargetObj) )

  00e9b	57		 push	 edi
  00e9c	e8 00 00 00 00	 call	 ?gObjUniriaSprite@@YAHPAUOBJECTSTRUCT@@@Z ; gObjUniriaSprite
  00ea1	33 c9		 xor	 ecx, ecx
  00ea3	83 c4 04	 add	 esp, 4
  00ea6	85 c0		 test	 eax, eax
  00ea8	b8 01 00 00 00	 mov	 eax, 1
  00ead	0f 44 c8	 cmove	 ecx, eax
  00eb0	89 4d ec	 mov	 DWORD PTR _MSBFlag$1$[ebp], ecx
$LN174@Attack:

; 1373 : 			{
; 1374 : 				MSBFlag = 1;
; 1375 : 			}
; 1376 : 		}
; 1377 : 	}
; 1378 : 
; 1379 : 	if ( ManaChange )

  00eb3	83 7d f0 00	 cmp	 DWORD PTR _ManaChange$1$[ebp], 0
  00eb7	74 25		 je	 SHORT $LN175@Attack

; 1380 : 	{
; 1381 : 		GCManaSend(lpTargetObj->m_Index, (WORD)lpTargetObj->Mana, 0xFF, 0, lpTargetObj->BP);

  00eb9	0f b7 87 04 01
	00 00		 movzx	 eax, WORD PTR [edi+260]
  00ec0	50		 push	 eax
  00ec1	f3 0f 2c 87 ec
	00 00 00	 cvttss2si eax, DWORD PTR [edi+236]
  00ec9	6a 00		 push	 0
  00ecb	68 ff 00 00 00	 push	 255			; 000000ffH
  00ed0	0f b7 c0	 movzx	 eax, ax
  00ed3	50		 push	 eax
  00ed4	ff 37		 push	 DWORD PTR [edi]
  00ed6	e8 00 00 00 00	 call	 ?GCManaSend@@YAXHFEEG@Z	; GCManaSend
  00edb	83 c4 14	 add	 esp, 20			; 00000014H
$LN175@Attack:

; 1382 : 	}
; 1383 : 
; 1384 : 	if ( lpObj->Type == OBJ_USER )

  00ede	80 7b 50 01	 cmp	 BYTE PTR [ebx+80], 1
  00ee2	75 18		 jne	 SHORT $LN177@Attack

; 1385 : 	{
; 1386 : 		if ( lpObj->m_Change == 9 )

  00ee4	83 bb 34 06 00
	00 09		 cmp	 DWORD PTR [ebx+1588], 9
  00eeb	75 0f		 jne	 SHORT $LN177@Attack

; 1387 : 		{
; 1388 : 			GCMagicAttackNumberSend(lpObj, 3, lpTargetObj->m_Index, 1);

  00eed	6a 01		 push	 1
  00eef	ff 37		 push	 DWORD PTR [edi]
  00ef1	6a 03		 push	 3
  00ef3	53		 push	 ebx
  00ef4	e8 00 00 00 00	 call	 ?GCMagicAttackNumberSend@@YAXPAUOBJECTSTRUCT@@GHE@Z ; GCMagicAttackNumberSend
  00ef9	83 c4 10	 add	 esp, 16			; 00000010H
$LN177@Attack:

; 1389 : 		}
; 1390 : 	}
; 1391 : 
; 1392 : 	lpObj->m_Rest = 0;

  00efc	c6 83 d4 01 00
	00 00		 mov	 BYTE PTR [ebx+468], 0

; 1393 : 
; 1394 : 	if ( AttackDamage > 0 )

  00f03	85 f6		 test	 esi, esi
  00f05	0f 8e ff 00 00
	00		 jle	 $LN178@Attack

; 1395 : 	{
; 1396 : 		int atd_reflect = (int)((float)AttackDamage * lpTargetObj->DamageReflect / 100.0f);

  00f0b	0f b6 87 49 01
	00 00		 movzx	 eax, BYTE PTR [edi+329]
  00f12	66 0f 6e c6	 movd	 xmm0, esi
  00f16	0f 5b c0	 cvtdq2ps xmm0, xmm0
  00f19	66 0f 6e c8	 movd	 xmm1, eax
  00f1d	0f 5b c9	 cvtdq2ps xmm1, xmm1
  00f20	f3 0f 59 c8	 mulss	 xmm1, xmm0
  00f24	f3 0f 5e 0d 00
	00 00 00	 divss	 xmm1, DWORD PTR __real@42c80000
  00f2c	f3 0f 2c c1	 cvttss2si eax, xmm1

; 1397 : 
; 1398 : 		if ( atd_reflect )

  00f30	85 c0		 test	 eax, eax
  00f32	74 10		 je	 SHORT $LN180@Attack

; 1399 : 		{
; 1400 : 			gObjAddMsgSendDelay(lpTargetObj, 10, lpObj->m_Index, 10, atd_reflect);

  00f34	50		 push	 eax
  00f35	6a 0a		 push	 10			; 0000000aH
  00f37	ff 33		 push	 DWORD PTR [ebx]
  00f39	6a 0a		 push	 10			; 0000000aH
  00f3b	57		 push	 edi
  00f3c	e8 00 00 00 00	 call	 ?gObjAddMsgSendDelay@@YAXPAUOBJECTSTRUCT@@HHHH@Z ; gObjAddMsgSendDelay
  00f41	83 c4 14	 add	 esp, 20			; 00000014H
$LN180@Attack:

; 1401 : 		}
; 1402 : 
; 1403 : 		if ( (rand()%100) < lpObj->SetOpReflectionDamage )

  00f44	e8 00 00 00 00	 call	 _rand
  00f49	99		 cdq
  00f4a	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  00f4f	f7 f9		 idiv	 ecx
  00f51	0f b6 83 d0 14
	00 00		 movzx	 eax, BYTE PTR [ebx+5328]
  00f58	3b d0		 cmp	 edx, eax
  00f5a	7d 10		 jge	 SHORT $LN181@Attack

; 1404 : 		{
; 1405 : 			gObjAddMsgSendDelay(lpTargetObj, 10, lpObj->m_Index, 10, AttackDamage);

  00f5c	56		 push	 esi
  00f5d	6a 0a		 push	 10			; 0000000aH
  00f5f	ff 33		 push	 DWORD PTR [ebx]
  00f61	6a 0a		 push	 10			; 0000000aH
  00f63	57		 push	 edi
  00f64	e8 00 00 00 00	 call	 ?gObjAddMsgSendDelay@@YAXPAUOBJECTSTRUCT@@HHHH@Z ; gObjAddMsgSendDelay
  00f69	83 c4 14	 add	 esp, 20			; 00000014H
$LN181@Attack:

; 1406 : 		}
; 1407 : 
; 1408 : 		AttackDamage -= iTotalShieldDamage;

  00f6c	2b 75 f4	 sub	 esi, DWORD PTR _iTotalShieldDamage$1$[ebp]

; 1409 : 
; 1410 : 		float fpercent = rand()%100;

  00f6f	e8 00 00 00 00	 call	 _rand
  00f74	99		 cdq
  00f75	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  00f7a	f7 f9		 idiv	 ecx

; 1411 : 
; 1412 : 		if ( fpercent < lpObj->m_MPSkillOpt.MpsDarkSpiritStr5 )

  00f7c	f3 0f 10 83 7c
	08 00 00	 movss	 xmm0, DWORD PTR [ebx+2172]
  00f84	66 0f 6e ca	 movd	 xmm1, edx
  00f88	0f 5b c9	 cvtdq2ps xmm1, xmm1
  00f8b	0f 2f c1	 comiss	 xmm0, xmm1
  00f8e	76 5e		 jbe	 SHORT $LN229@Attack

; 1413 : 		{
; 1414 : 			if ( lpTargetObj->Type == OBJ_USER )

  00f90	80 7f 50 01	 cmp	 BYTE PTR [edi+80], 1
  00f94	75 1e		 jne	 SHORT $LN183@Attack

; 1415 : 			{
; 1416 : 				iTempShieldDamage = this->GetShieldDamage(lpObj, lpTargetObj, AttackDamage);

  00f96	8b 4d fc	 mov	 ecx, DWORD PTR _this$1$[ebp]
  00f99	56		 push	 esi
  00f9a	57		 push	 edi
  00f9b	53		 push	 ebx
  00f9c	e8 00 00 00 00	 call	 ?GetShieldDamage@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0H@Z ; CDarkSpirit::GetShieldDamage

; 1417 : 				lpTargetObj->iShield -= iTempShieldDamage;

  00fa1	29 87 2c 01 00
	00		 sub	 DWORD PTR [edi+300], eax

; 1418 : 				lpTargetObj->Life -= AttackDamage - iTempShieldDamage;

  00fa7	8b ce		 mov	 ecx, esi
  00fa9	2b c8		 sub	 ecx, eax

; 1419 : 				iTotalShieldDamage += iTempShieldDamage;

  00fab	01 45 f4	 add	 DWORD PTR _iTotalShieldDamage$1$[ebp], eax
  00fae	66 0f 6e c1	 movd	 xmm0, ecx

; 1420 : 				AttackDamage += AttackDamage;
; 1421 : 
; 1422 : 				if ( lpTargetObj->Life < 0.0f )
; 1423 : 				{
; 1424 : 					lpTargetObj->Life = 0.0f;
; 1425 : 				}
; 1426 : 			}
; 1427 : 			else

  00fb2	eb 04		 jmp	 SHORT $LN256@Attack
$LN183@Attack:
  00fb4	66 0f 6e c6	 movd	 xmm0, esi
$LN256@Attack:

; 1428 : 			{
; 1429 : 				lpTargetObj->Life -= AttackDamage;

  00fb8	f3 0f 10 8f d8
	00 00 00	 movss	 xmm1, DWORD PTR [edi+216]

; 1430 : 				AttackDamage += AttackDamage;

  00fc0	03 f6		 add	 esi, esi
  00fc2	0f 5b c0	 cvtdq2ps xmm0, xmm0
  00fc5	f3 0f 5c c8	 subss	 xmm1, xmm0
  00fc9	0f 57 c0	 xorps	 xmm0, xmm0

; 1431 : 
; 1432 : 				if ( lpTargetObj->Life < 0.0f )

  00fcc	0f 2f c1	 comiss	 xmm0, xmm1
  00fcf	f3 0f 11 8f d8
	00 00 00	 movss	 DWORD PTR [edi+216], xmm1
  00fd7	76 0a		 jbe	 SHORT $LN186@Attack

; 1433 : 				{
; 1434 : 					lpTargetObj->Life = 0.0f;

  00fd9	c7 87 d8 00 00
	00 00 00 00 00	 mov	 DWORD PTR [edi+216], 0
$LN186@Attack:

; 1435 : 				}
; 1436 : 			}
; 1437 : 
; 1438 : 			MsgDamage |= 0x40;

  00fe3	8b 45 f8	 mov	 eax, DWORD PTR _MsgDamage$[ebp]
  00fe6	83 c8 40	 or	 eax, 64			; 00000040H
  00fe9	89 45 f8	 mov	 DWORD PTR _MsgDamage$[ebp], eax
  00fec	eb 03		 jmp	 SHORT $LN182@Attack
$LN229@Attack:
  00fee	8b 45 f8	 mov	 eax, DWORD PTR _MsgDamage$[ebp]
$LN182@Attack:

; 1439 : 		}
; 1440 : 		
; 1441 : 		gObjLifeCheck(lpTargetObj, lpObj, AttackDamage, 0, MSBFlag, MsgDamage, skill, iTotalShieldDamage);

  00ff1	ff 75 f4	 push	 DWORD PTR _iTotalShieldDamage$1$[ebp]
  00ff4	ff 75 08	 push	 DWORD PTR _skill$1$[ebp]
  00ff7	50		 push	 eax
  00ff8	ff 75 ec	 push	 DWORD PTR _MSBFlag$1$[ebp]
  00ffb	6a 00		 push	 0
  00ffd	56		 push	 esi
  00ffe	53		 push	 ebx
  00fff	57		 push	 edi
  01000	e8 00 00 00 00	 call	 ?gObjLifeCheck@@YAXPAUOBJECTSTRUCT@@0HHHHGH@Z ; gObjLifeCheck
  01005	83 c4 20	 add	 esp, 32			; 00000020H

; 1442 : 	}
; 1443 : 	else

  01008	eb 15		 jmp	 SHORT $LN179@Attack
$LN178@Attack:

; 1444 : 	{
; 1445 : 		GCDamageSend(lpObj->m_Index, lpTargetObj->m_Index, 0, 0, MsgDamage, 0);

  0100a	6a 00		 push	 0
  0100c	ff 75 f8	 push	 DWORD PTR _MsgDamage$[ebp]
  0100f	6a 00		 push	 0
  01011	6a 00		 push	 0
  01013	ff 37		 push	 DWORD PTR [edi]
  01015	ff 33		 push	 DWORD PTR [ebx]
  01017	e8 00 00 00 00	 call	 ?GCDamageSend@@YAXHHHHHH@Z ; GCDamageSend
  0101c	83 c4 18	 add	 esp, 24			; 00000018H
$LN179@Attack:

; 1446 : 	}
; 1447 : 
; 1448 : 	if ( lpObj->Life <= 0.0f && lpObj->Type == OBJ_USER )

  0101f	0f 57 c0	 xorps	 xmm0, xmm0
  01022	0f 2f 83 d8 00
	00 00		 comiss	 xmm0, DWORD PTR [ebx+216]
  01029	72 2c		 jb	 SHORT $LN188@Attack
  0102b	80 7b 50 01	 cmp	 BYTE PTR [ebx+80], 1
  0102f	75 26		 jne	 SHORT $LN188@Attack

; 1449 : 	{
; 1450 : 		if ( lpObj->m_CheckLifeTime <= 0 )

  01031	83 bb 64 14 00
	00 00		 cmp	 DWORD PTR [ebx+5220], 0
  01038	7f 1d		 jg	 SHORT $LN188@Attack

; 1451 : 		{
; 1452 : 			lpObj->lpAttackObj = lpTargetObj;

  0103a	89 bb b4 05 00
	00		 mov	 DWORD PTR [ebx+1460], edi

; 1453 : 
; 1454 : 			if ( lpTargetObj->Type == OBJ_USER )

  01040	80 7f 50 01	 cmp	 BYTE PTR [edi+80], 1

; 1455 : 			{
; 1456 : 				lpObj->m_bAttackerKilled = true;
; 1457 : 			}
; 1458 : 			else
; 1459 : 			{
; 1460 : 				lpObj->m_bAttackerKilled = false;
; 1461 : 			}
; 1462 : 
; 1463 : 			lpObj->m_CheckLifeTime = 3;

  01044	c7 83 64 14 00
	00 03 00 00 00	 mov	 DWORD PTR [ebx+5220], 3
  0104e	0f 94 c1	 sete	 cl
  01051	88 8b c0 05 00
	00		 mov	 BYTE PTR [ebx+1472], cl
$LN188@Attack:

; 1464 : 		}
; 1465 : 	}
; 1466 : 
; 1467 : 	return TRUE;

  01057	5b		 pop	 ebx
  01058	5f		 pop	 edi
  01059	b8 01 00 00 00	 mov	 eax, 1
  0105e	5e		 pop	 esi

; 1468 : }

  0105f	8b e5		 mov	 esp, ebp
  01061	5d		 pop	 ebp
  01062	c2 14 00	 ret	 20			; 00000014H
?Attack@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0PAVCMagicInf@@HH@Z ENDP ; CDarkSpirit::Attack
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
; File c:\users\michel\desktop\source\gameserver\include\prodef.h
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
;	COMDAT ?SetMode@CDarkSpirit@@QAEXW4ePetItem_Mode@1@H@Z
_TEXT	SEGMENT
_pMsg$1 = -8						; size = 7
_mode$ = 8						; size = 4
_iTargetindex$ = 12					; size = 4
?SetMode@CDarkSpirit@@QAEXW4ePetItem_Mode@1@H@Z PROC	; CDarkSpirit::SetMode, COMDAT
; _this$ = ecx

; 565  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 08	 sub	 esp, 8
  00006	57		 push	 edi

; 566  : 	if ( this->m_iMasterIndex == -1 )

  00007	8b 79 1c	 mov	 edi, DWORD PTR [ecx+28]
  0000a	83 ff ff	 cmp	 edi, -1
  0000d	74 6b		 je	 SHORT $LN4@SetMode

; 567  : 	{
; 568  : 		return;
; 569  : 	}
; 570  : 
; 571  : 	LPOBJ lpObj = &gObj[this->m_iMasterIndex];
; 572  : 
; 573  : 	if ( lpObj->Class != CLASS_DARKLORD )	// DL

  0000f	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00014	69 d7 40 27 00
	00		 imul	 edx, edi, 10048
  0001a	66 83 bc 02 90
	00 00 00 04	 cmp	 WORD PTR [edx+eax+144], 4
  00023	75 55		 jne	 SHORT $LN4@SetMode

; 574  : 	{
; 575  : 		return;
; 576  : 	}
; 577  : 
; 578  : 	if ( mode == PetItem_Mode_Attack_Target || this->m_ActionMode != mode)

  00025	8b 55 08	 mov	 edx, DWORD PTR _mode$[ebp]
  00028	56		 push	 esi
  00029	83 fa 03	 cmp	 edx, 3
  0002c	74 07		 je	 SHORT $LN14@SetMode
  0002e	39 51 28	 cmp	 DWORD PTR [ecx+40], edx
  00031	74 46		 je	 SHORT $LN15@SetMode

; 579  : 	{
; 580  : 		if ( mode == PetItem_Mode_Attack_Target )

  00033	eb 19		 jmp	 SHORT $LN8@SetMode
$LN14@SetMode:

; 581  : 		{
; 582  : 			if ( OBJMAX_RANGE(iTargetindex) != FALSE )

  00035	8b 75 0c	 mov	 esi, DWORD PTR _iTargetindex$[ebp]
  00038	85 f6		 test	 esi, esi
  0003a	78 3d		 js	 SHORT $LN15@SetMode
  0003c	33 c0		 xor	 eax, eax
  0003e	81 fe eb 2c 00
	00		 cmp	 esi, 11499		; 00002cebH
  00044	0f 9e c0	 setle	 al
  00047	85 c0		 test	 eax, eax
  00049	74 2e		 je	 SHORT $LN15@SetMode

; 583  : 			{
; 584  : 				this->m_iTargetIndex = iTargetindex;

  0004b	89 71 20	 mov	 DWORD PTR [ecx+32], esi
$LN8@SetMode:

; 597  : 		pMsg.NumberH = SET_NUMBERH(this->m_iTargetIndex);

  0004e	8b 41 20	 mov	 eax, DWORD PTR [ecx+32]
  00051	c1 e8 08	 shr	 eax, 8
  00054	88 45 fd	 mov	 BYTE PTR _pMsg$1[ebp+5], al

; 598  : 		pMsg.NumberL = SET_NUMBERL(this->m_iTargetIndex);

  00057	8a 41 20	 mov	 al, BYTE PTR [ecx+32]
  0005a	88 45 fe	 mov	 BYTE PTR _pMsg$1[ebp+6], al

; 599  : 		DataSend(this->m_iMasterIndex, (UCHAR*)&pMsg, sizeof(pMsg));

  0005d	8d 45 f8	 lea	 eax, DWORD PTR _pMsg$1[ebp]
  00060	6a 07		 push	 7
  00062	50		 push	 eax
  00063	57		 push	 edi
  00064	89 51 28	 mov	 DWORD PTR [ecx+40], edx
; File c:\users\michel\desktop\source\gameserver\include\prodef.h

; 86   : 		lpBuf[0] = 0xC1;

  00067	c7 45 f8 c1 07
	a7 00		 mov	 DWORD PTR _pMsg$1[ebp], 10946497 ; 00a707c1H
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp

; 596  : 		pMsg.Command = mode;

  0006e	88 55 fc	 mov	 BYTE PTR _pMsg$1[ebp+4], dl

; 599  : 		DataSend(this->m_iMasterIndex, (UCHAR*)&pMsg, sizeof(pMsg));

  00071	e8 00 00 00 00	 call	 ?DataSend@@YAHHPAEK@Z	; DataSend
  00076	83 c4 0c	 add	 esp, 12			; 0000000cH
$LN15@SetMode:
  00079	5e		 pop	 esi
$LN4@SetMode:
  0007a	5f		 pop	 edi

; 600  : 	}
; 601  : }

  0007b	8b e5		 mov	 esp, ebp
  0007d	5d		 pop	 ebp
  0007e	c2 08 00	 ret	 8
?SetMode@CDarkSpirit@@QAEXW4ePetItem_Mode@1@H@Z ENDP	; CDarkSpirit::SetMode
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
;	COMDAT ?Set@CDarkSpirit@@QAEXHPAVCItem@@@Z
_TEXT	SEGMENT
_bChange$2$ = -12					; size = 4
_this$1$ = -8						; size = 4
_lpObj$1$ = -4						; size = 4
_aIndex$ = 8						; size = 4
_pPetItem$ = 12						; size = 4
?Set@CDarkSpirit@@QAEXHPAVCItem@@@Z PROC		; CDarkSpirit::Set, COMDAT
; _this$ = ecx

; 605  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 0c	 sub	 esp, 12			; 0000000cH
  00006	56		 push	 esi
  00007	57		 push	 edi

; 606  : 	LPOBJ lpObj = &gObj[aIndex];

  00008	69 7d 08 40 27
	00 00		 imul	 edi, DWORD PTR _aIndex$[ebp], 10048
  0000f	8b f1		 mov	 esi, ecx
  00011	89 75 f8	 mov	 DWORD PTR _this$1$[ebp], esi
  00014	03 3d 00 00 00
	00		 add	 edi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0001a	89 7d fc	 mov	 DWORD PTR _lpObj$1$[ebp], edi

; 607  : 
; 608  : 	if ( lpObj->Class != 4 )	// DL

  0001d	66 83 bf 90 00
	00 00 04	 cmp	 WORD PTR [edi+144], 4
  00025	0f 85 3c 01 00
	00		 jne	 $LN6@Set

; 609  : 	{
; 610  : 		return;
; 611  : 	}
; 612  : 
; 613  : 	BOOL bChange = FALSE;

  0002b	33 c0		 xor	 eax, eax

; 614  : 
; 615  : 	if ( this->m_iMasterIndex == -1 )

  0002d	b9 01 00 00 00	 mov	 ecx, 1
  00032	83 7e 1c ff	 cmp	 DWORD PTR [esi+28], -1
  00036	0f 44 c1	 cmove	 eax, ecx

; 616  : 	{
; 617  : 		bChange = TRUE;
; 618  : 	}
; 619  : 
; 620  : 	this->Init();

  00039	8b ce		 mov	 ecx, esi
  0003b	89 45 f4	 mov	 DWORD PTR _bChange$2$[ebp], eax
  0003e	e8 00 00 00 00	 call	 ?Init@CDarkSpirit@@QAEXXZ ; CDarkSpirit::Init

; 621  : 
; 622  : 	if ( pPetItem->m_Type != ITEMGET(13,5) ) // Talon of Dark Raven

  00043	8b 45 0c	 mov	 eax, DWORD PTR _pPetItem$[ebp]
  00046	b9 05 1a 00 00	 mov	 ecx, 6661		; 00001a05H
  0004b	66 39 48 06	 cmp	 WORD PTR [eax+6], cx
  0004f	0f 85 12 01 00
	00		 jne	 $LN6@Set

; 623  : 	{
; 624  : 		return;
; 625  : 	}
; 626  : 
; 627  : 	if ( pPetItem->m_Durability <= 0.0f )

  00055	0f 57 c0	 xorps	 xmm0, xmm0
  00058	0f 2f 40 24	 comiss	 xmm0, DWORD PTR [eax+36]
  0005c	0f 83 05 01 00
	00		 jae	 $LN6@Set

; 633  : 	int leadership = lpObj->Leadership + lpObj->AddLeadership;

  00062	0f b7 bf f6 00
	00 00		 movzx	 edi, WORD PTR [edi+246]
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h

; 78   : 		return this->m_Data[CLASS_DARKLORD].PetAttackDamageMinDiv;

  00069	0f b7 0d c6 01
	00 00		 movzx	 ecx, WORD PTR ?g_ClassCalc@@3VClassCalc@@A+454
  00070	53		 push	 ebx
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp

; 632  : 	int petitemlevel = pPetItem->m_PetItem_Level;

  00071	8b 98 b8 00 00
	00		 mov	 ebx, DWORD PTR [eax+184]

; 633  : 	int leadership = lpObj->Leadership + lpObj->AddLeadership;

  00077	8b 45 fc	 mov	 eax, DWORD PTR _lpObj$1$[ebp]
  0007a	0f b7 80 f4 00
	00 00		 movzx	 eax, WORD PTR [eax+244]
  00081	03 f8		 add	 edi, eax

; 636  : 	this->m_AttackDamageMin			= petitemlevel * g_ClassCalc.GetPetAttackDamageMinFact() + leadership / g_ClassCalc.GetPetAttackDamageMinDiv() + g_ClassCalc.GetPetAttackDamageMinStart();

  00083	8b c7		 mov	 eax, edi
  00085	99		 cdq
  00086	f7 f9		 idiv	 ecx
  00088	8b c8		 mov	 ecx, eax
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h

; 74   : 		return this->m_Data[CLASS_DARKLORD].PetAttackDamageMinFact;

  0008a	0f b7 05 c4 01
	00 00		 movzx	 eax, WORD PTR ?g_ClassCalc@@3VClassCalc@@A+452
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp

; 636  : 	this->m_AttackDamageMin			= petitemlevel * g_ClassCalc.GetPetAttackDamageMinFact() + leadership / g_ClassCalc.GetPetAttackDamageMinDiv() + g_ClassCalc.GetPetAttackDamageMinStart();

  00091	0f af c3	 imul	 eax, ebx
  00094	03 c8		 add	 ecx, eax
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h

; 82   : 		return this->m_Data[CLASS_DARKLORD].PetAttackDamageMinStart;

  00096	0f b7 05 c8 01
	00 00		 movzx	 eax, WORD PTR ?g_ClassCalc@@3VClassCalc@@A+456
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp

; 636  : 	this->m_AttackDamageMin			= petitemlevel * g_ClassCalc.GetPetAttackDamageMinFact() + leadership / g_ClassCalc.GetPetAttackDamageMinDiv() + g_ClassCalc.GetPetAttackDamageMinStart();

  0009d	03 c8		 add	 ecx, eax

; 637  : 	this->m_AttackDamageMax			= petitemlevel * g_ClassCalc.GetPetAttackDamageMaxFact() + leadership / g_ClassCalc.GetPetAttackDamageMaxDiv() + g_ClassCalc.GetPetAttackDamageMaxStart();

  0009f	8b c7		 mov	 eax, edi
  000a1	99		 cdq
  000a2	89 4e 04	 mov	 DWORD PTR [esi+4], ecx
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h

; 90   : 		return this->m_Data[CLASS_DARKLORD].PetAttackDamageMaxDiv;

  000a5	0f b7 0d cc 01
	00 00		 movzx	 ecx, WORD PTR ?g_ClassCalc@@3VClassCalc@@A+460
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp

; 637  : 	this->m_AttackDamageMax			= petitemlevel * g_ClassCalc.GetPetAttackDamageMaxFact() + leadership / g_ClassCalc.GetPetAttackDamageMaxDiv() + g_ClassCalc.GetPetAttackDamageMaxStart();

  000ac	f7 f9		 idiv	 ecx
  000ae	8b c8		 mov	 ecx, eax
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h

; 86   : 		return this->m_Data[CLASS_DARKLORD].PetAttackDamageMaxFact;

  000b0	0f b7 05 ca 01
	00 00		 movzx	 eax, WORD PTR ?g_ClassCalc@@3VClassCalc@@A+458
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp

; 637  : 	this->m_AttackDamageMax			= petitemlevel * g_ClassCalc.GetPetAttackDamageMaxFact() + leadership / g_ClassCalc.GetPetAttackDamageMaxDiv() + g_ClassCalc.GetPetAttackDamageMaxStart();

  000b7	0f af c3	 imul	 eax, ebx
  000ba	03 c8		 add	 ecx, eax
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h

; 94   : 		return this->m_Data[CLASS_DARKLORD].PetAttackDamageMaxStart;

  000bc	0f b7 05 ce 01
	00 00		 movzx	 eax, WORD PTR ?g_ClassCalc@@3VClassCalc@@A+462
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp

; 637  : 	this->m_AttackDamageMax			= petitemlevel * g_ClassCalc.GetPetAttackDamageMaxFact() + leadership / g_ClassCalc.GetPetAttackDamageMaxDiv() + g_ClassCalc.GetPetAttackDamageMaxStart();

  000c3	03 c8		 add	 ecx, eax
  000c5	89 4e 08	 mov	 DWORD PTR [esi+8], ecx

; 638  : 	this->m_iCriticalSuccessRate	= (float)g_ClassCalc.GetPetCriticalAttackRate();

  000c8	0f b7 05 d0 01
	00 00		 movzx	 eax, WORD PTR ?g_ClassCalc@@3VClassCalc@@A+464
  000cf	66 0f 6e c0	 movd	 xmm0, eax
  000d3	0f 5b c0	 cvtdq2ps xmm0, xmm0
  000d6	f3 0f 11 46 14	 movss	 DWORD PTR [esi+20], xmm0
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h

; 102  : 		return this->m_Data[CLASS_DARKLORD].PetAttackSpeedFact;

  000db	0f b7 05 d2 01
	00 00		 movzx	 eax, WORD PTR ?g_ClassCalc@@3VClassCalc@@A+466

; 103  : 	};
; 104  : 	int		GetPetAttackSpeedDiv1()
; 105  : 	{
; 106  : 		return this->m_Data[CLASS_DARKLORD].PetAttackSpeedDiv1;

  000e2	0f b7 0d d4 01
	00 00		 movzx	 ecx, WORD PTR ?g_ClassCalc@@3VClassCalc@@A+468
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp

; 639  : 	this->m_AttackSpeed				= petitemlevel * g_ClassCalc.GetPetAttackSpeedFact() / g_ClassCalc.GetPetAttackSpeedDiv1() + leadership / g_ClassCalc.GetPetAttackSpeedDiv2() + g_ClassCalc.GetPetAttackSpeedStart();

  000e9	0f af c3	 imul	 eax, ebx
  000ec	99		 cdq
  000ed	f7 f9		 idiv	 ecx
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h

; 110  : 		return this->m_Data[CLASS_DARKLORD].PetAttackSpeedDiv2;

  000ef	0f b7 0d d6 01
	00 00		 movzx	 ecx, WORD PTR ?g_ClassCalc@@3VClassCalc@@A+470
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp

; 639  : 	this->m_AttackSpeed				= petitemlevel * g_ClassCalc.GetPetAttackSpeedFact() / g_ClassCalc.GetPetAttackSpeedDiv1() + leadership / g_ClassCalc.GetPetAttackSpeedDiv2() + g_ClassCalc.GetPetAttackSpeedStart();

  000f6	8b f0		 mov	 esi, eax
  000f8	8b c7		 mov	 eax, edi
  000fa	99		 cdq
  000fb	f7 f9		 idiv	 ecx
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h

; 114  : 		return this->m_Data[CLASS_DARKLORD].PetAttackSpeedStart;

  000fd	0f b7 0d d8 01
	00 00		 movzx	 ecx, WORD PTR ?g_ClassCalc@@3VClassCalc@@A+472
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp

; 639  : 	this->m_AttackSpeed				= petitemlevel * g_ClassCalc.GetPetAttackSpeedFact() / g_ClassCalc.GetPetAttackSpeedDiv1() + leadership / g_ClassCalc.GetPetAttackSpeedDiv2() + g_ClassCalc.GetPetAttackSpeedStart();

  00104	8b 7d f8	 mov	 edi, DWORD PTR _this$1$[ebp]
  00107	03 f0		 add	 esi, eax
  00109	03 f1		 add	 esi, ecx

; 640  : 	this->m_SuccessAttackRate		= petitemlevel + petitemlevel / g_ClassCalc.GetPetSuccessAttackRateDiv() + g_ClassCalc.GetPetSuccessAttackRateStart();

  0010b	8b c3		 mov	 eax, ebx
  0010d	99		 cdq
  0010e	89 77 0c	 mov	 DWORD PTR [edi+12], esi
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h

; 118  : 		return this->m_Data[CLASS_DARKLORD].PetSuccessAttackRateDiv;

  00111	0f b7 0d da 01
	00 00		 movzx	 ecx, WORD PTR ?g_ClassCalc@@3VClassCalc@@A+474
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp

; 640  : 	this->m_SuccessAttackRate		= petitemlevel + petitemlevel / g_ClassCalc.GetPetSuccessAttackRateDiv() + g_ClassCalc.GetPetSuccessAttackRateStart();

  00118	f7 f9		 idiv	 ecx
; File c:\users\michel\desktop\source\gameserver\source\classcalc.h

; 122  : 		return this->m_Data[CLASS_DARKLORD].PetSuccessAttackRateStart;

  0011a	0f b7 0d dc 01
	00 00		 movzx	 ecx, WORD PTR ?g_ClassCalc@@3VClassCalc@@A+476
  00121	66 0f 6e 47 0c	 movd	 xmm0, DWORD PTR [edi+12]
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp

; 640  : 	this->m_SuccessAttackRate		= petitemlevel + petitemlevel / g_ClassCalc.GetPetSuccessAttackRateDiv() + g_ClassCalc.GetPetSuccessAttackRateStart();

  00126	03 c3		 add	 eax, ebx
  00128	03 c8		 add	 ecx, eax

; 641  : #else
; 642  : 	this->m_AttackDamageMin			= petitemlevel*15 + leadership/8 + 180;
; 643  : 	this->m_AttackDamageMax			= petitemlevel*15 + leadership/4 + 200;
; 644  : 	this->m_iCriticalSuccessRate	= 30.0f;
; 645  : 	this->m_AttackSpeed				= petitemlevel * 4 / 5 + leadership / 50 + 20;
; 646  : 	this->m_SuccessAttackRate		= petitemlevel + petitemlevel / 15 + 1000;
; 647  : #endif
; 648  : 
; 649  : 	this->m_AttackSpeed += lpObj->m_MPSkillOpt.MpsDarkSpiritStr4;

  0012a	8b 45 fc	 mov	 eax, DWORD PTR _lpObj$1$[ebp]

; 650  : 	this->m_iExcelentSuccessRate = 0;
; 651  : 	this->m_iMasterIndex = aIndex;
; 652  : 	this->m_pPetItem = pPetItem;
; 653  : 
; 654  : 	if ( bChange != FALSE )

  0012d	83 7d f4 00	 cmp	 DWORD PTR _bChange$2$[ebp], 0
  00131	0f 5b c0	 cvtdq2ps xmm0, xmm0
  00134	89 4f 10	 mov	 DWORD PTR [edi+16], ecx
  00137	5b		 pop	 ebx
  00138	f3 0f 58 80 78
	08 00 00	 addss	 xmm0, DWORD PTR [eax+2168]
  00140	c7 47 18 00 00
	00 00		 mov	 DWORD PTR [edi+24], 0
  00147	f3 0f 2c c0	 cvttss2si eax, xmm0
  0014b	89 47 0c	 mov	 DWORD PTR [edi+12], eax
  0014e	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  00151	89 47 1c	 mov	 DWORD PTR [edi+28], eax
  00154	8b 45 0c	 mov	 eax, DWORD PTR _pPetItem$[ebp]
  00157	89 47 2c	 mov	 DWORD PTR [edi+44], eax
  0015a	74 0b		 je	 SHORT $LN6@Set

; 655  : 	{
; 656  : 		this->SetMode(PetItem_Mode_Normal, -1);

  0015c	6a ff		 push	 -1
  0015e	6a 00		 push	 0
  00160	8b cf		 mov	 ecx, edi
  00162	e8 00 00 00 00	 call	 ?SetMode@CDarkSpirit@@QAEXW4ePetItem_Mode@1@H@Z ; CDarkSpirit::SetMode
$LN6@Set:
  00167	5f		 pop	 edi
  00168	5e		 pop	 esi

; 657  : 	}
; 658  : }

  00169	8b e5		 mov	 esp, ebp
  0016b	5d		 pop	 ebp
  0016c	c2 08 00	 ret	 8
?Set@CDarkSpirit@@QAEXHPAVCItem@@@Z ENDP		; CDarkSpirit::Set
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
;	COMDAT ?ReSetTarget@CDarkSpirit@@QAEXH@Z
_TEXT	SEGMENT
_aTargetIndex$ = 8					; size = 4
?ReSetTarget@CDarkSpirit@@QAEXH@Z PROC			; CDarkSpirit::ReSetTarget, COMDAT
; _this$ = ecx

; 528  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 529  : 	if ( this->m_iMasterIndex == -1 )

  00003	8b 41 1c	 mov	 eax, DWORD PTR [ecx+28]
  00006	83 f8 ff	 cmp	 eax, -1
  00009	74 34		 je	 SHORT $LN5@ReSetTarge

; 530  : 	{
; 531  : 		return;
; 532  : 	}
; 533  : 
; 534  : 	LPOBJ lpObj = &gObj[this->m_iMasterIndex];

  0000b	69 d0 40 27 00
	00		 imul	 edx, eax, 10048

; 535  : 
; 536  : 	if ( lpObj->Class != 4 )	// DL

  00011	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00016	66 83 bc 02 90
	00 00 00 04	 cmp	 WORD PTR [edx+eax+144], 4
  0001f	75 1e		 jne	 SHORT $LN5@ReSetTarge

; 537  : 	{
; 538  : 		return;
; 539  : 	}
; 540  : 
; 541  : 	if ( aTargetIndex == this->m_iTargetIndex )

  00021	8b 45 08	 mov	 eax, DWORD PTR _aTargetIndex$[ebp]
  00024	3b 41 20	 cmp	 eax, DWORD PTR [ecx+32]
  00027	75 16		 jne	 SHORT $LN5@ReSetTarge

; 542  : 	{
; 543  : 		this->m_iTargetIndex = -1;
; 544  : 
; 545  : 		if ( this->m_ActionMode == PetItem_Mode_Attack_Target )

  00029	83 79 28 03	 cmp	 DWORD PTR [ecx+40], 3
  0002d	c7 41 20 ff ff
	ff ff		 mov	 DWORD PTR [ecx+32], -1
  00034	75 09		 jne	 SHORT $LN5@ReSetTarge

; 546  : 		{
; 547  : 			this->SetMode(PetItem_Mode_Normal, -1);

  00036	6a ff		 push	 -1
  00038	6a 00		 push	 0
  0003a	e8 00 00 00 00	 call	 ?SetMode@CDarkSpirit@@QAEXW4ePetItem_Mode@1@H@Z ; CDarkSpirit::SetMode
$LN5@ReSetTarge:

; 548  : 		}
; 549  : 	}
; 550  : }

  0003f	5d		 pop	 ebp
  00040	c2 04 00	 ret	 4
?ReSetTarget@CDarkSpirit@@QAEXH@Z ENDP			; CDarkSpirit::ReSetTarget
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
;	COMDAT ?SetTarget@CDarkSpirit@@QAEXH@Z
_TEXT	SEGMENT
_aTargetIndex$ = 8					; size = 4
?SetTarget@CDarkSpirit@@QAEXH@Z PROC			; CDarkSpirit::SetTarget, COMDAT
; _this$ = ecx

; 507  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 508  : 	if ( this->m_iMasterIndex == -1 )

  00003	8b 41 1c	 mov	 eax, DWORD PTR [ecx+28]
  00006	83 f8 ff	 cmp	 eax, -1
  00009	74 1c		 je	 SHORT $LN1@SetTarget

; 509  : 	{
; 510  : 		return;
; 511  : 	}
; 512  : 
; 513  : 	LPOBJ lpObj = &gObj[this->m_iMasterIndex];

  0000b	69 d0 40 27 00
	00		 imul	 edx, eax, 10048

; 514  : 
; 515  : 	if ( lpObj->Class != 4 )	// DL

  00011	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00016	66 83 bc 02 90
	00 00 00 04	 cmp	 WORD PTR [edx+eax+144], 4
  0001f	75 06		 jne	 SHORT $LN1@SetTarget

; 516  : 	{
; 517  : 		return;
; 518  : 	}
; 519  : 
; 520  : 	this->m_iTargetIndex = aTargetIndex;

  00021	8b 45 08	 mov	 eax, DWORD PTR _aTargetIndex$[ebp]
  00024	89 41 20	 mov	 DWORD PTR [ecx+32], eax
$LN1@SetTarget:

; 521  : }

  00027	5d		 pop	 ebp
  00028	c2 04 00	 ret	 4
?SetTarget@CDarkSpirit@@QAEXH@Z ENDP			; CDarkSpirit::SetTarget
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
;	COMDAT ?ModeAttakTarget@CDarkSpirit@@QAEXXZ
_TEXT	SEGMENT
?ModeAttakTarget@CDarkSpirit@@QAEXXZ PROC		; CDarkSpirit::ModeAttakTarget, COMDAT
; _this$ = ecx

; 317  : 	LPOBJ lpObj = &gObj[this->m_iMasterIndex];

  00000	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00006	56		 push	 esi
  00007	8b f1		 mov	 esi, ecx
  00009	57		 push	 edi
  0000a	69 7e 1c 40 27
	00 00		 imul	 edi, DWORD PTR [esi+28], 10048

; 318  : 	int count = 0;
; 319  : 	int dis;
; 320  : 
; 321  : 	if ( this->m_iTargetIndex == -1 )

  00011	8b 4e 20	 mov	 ecx, DWORD PTR [esi+32]
  00014	03 fa		 add	 edi, edx
  00016	83 f9 ff	 cmp	 ecx, -1
  00019	74 51		 je	 SHORT $LN5@ModeAttakT

; 322  : 	{
; 323  : 		return;
; 324  : 	}
; 325  : 
; 326  : 	if ( lpObj->MapNumber == gObj[this->m_iTargetIndex].MapNumber )

  0001b	69 c1 40 27 00
	00		 imul	 eax, ecx, 10048
  00021	03 d0		 add	 edx, eax
  00023	8a 87 23 01 00
	00		 mov	 al, BYTE PTR [edi+291]
  00029	3a 82 23 01 00
	00		 cmp	 al, BYTE PTR [edx+291]
  0002f	75 3b		 jne	 SHORT $LN5@ModeAttakT

; 327  : 	{
; 328  : 		if ( gObj[this->m_iTargetIndex].Life > 0.0f )

  00031	f3 0f 10 82 d8
	00 00 00	 movss	 xmm0, DWORD PTR [edx+216]
  00039	0f 2f 05 00 00
	00 00		 comiss	 xmm0, DWORD PTR __real@00000000
  00040	76 22		 jbe	 SHORT $LN4@ModeAttakT

; 329  : 		{
; 330  : 			dis = gObjCalDistance(lpObj, &gObj[this->m_iTargetIndex]);

  00042	52		 push	 edx
  00043	57		 push	 edi
  00044	e8 00 00 00 00	 call	 ?gObjCalDistance@@YAHPAUOBJECTSTRUCT@@0@Z ; gObjCalDistance
  00049	83 c4 08	 add	 esp, 8

; 331  : 
; 332  : 			if ( dis < RAVEN_ATTACK_DISTANCE )

  0004c	83 f8 07	 cmp	 eax, 7
  0004f	7d 1b		 jge	 SHORT $LN5@ModeAttakT

; 333  : 			{
; 334  : 				int criticaldamage = TRUE;
; 335  : 				int msg = 1;	// Attack with picada
; 336  : 
; 337  : 				if ( criticaldamage != FALSE )
; 338  : 				{
; 339  : 					this->SendAttackMsg(lpObj->m_Index, this->m_iTargetIndex, criticaldamage, msg);

  00051	6a 01		 push	 1
  00053	6a 01		 push	 1
  00055	ff 76 20	 push	 DWORD PTR [esi+32]
  00058	8b ce		 mov	 ecx, esi
  0005a	ff 37		 push	 DWORD PTR [edi]
  0005c	e8 00 00 00 00	 call	 ?SendAttackMsg@CDarkSpirit@@QAEXHHHH@Z ; CDarkSpirit::SendAttackMsg
  00061	5f		 pop	 edi
  00062	5e		 pop	 esi

; 350  : 		}
; 351  : 	}
; 352  : }

  00063	c3		 ret	 0
$LN4@ModeAttakT:

; 340  : 				}
; 341  : 				else
; 342  : 				{
; 343  : 					this->RangeAttack(lpObj->m_Index, this->m_iTargetIndex);
; 344  : 				}
; 345  : 			}
; 346  : 		}
; 347  : 		else
; 348  : 		{
; 349  : 			this->ReSetTarget(this->m_iTargetIndex);

  00064	51		 push	 ecx
  00065	8b ce		 mov	 ecx, esi
  00067	e8 00 00 00 00	 call	 ?ReSetTarget@CDarkSpirit@@QAEXH@Z ; CDarkSpirit::ReSetTarget
$LN5@ModeAttakT:

; 350  : 		}
; 351  : 	}
; 352  : }

  0006c	5f		 pop	 edi
  0006d	5e		 pop	 esi
  0006e	c3		 ret	 0
?ModeAttakTarget@CDarkSpirit@@QAEXXZ ENDP		; CDarkSpirit::ModeAttakTarget
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
;	COMDAT ?ModeAttackWithMaster@CDarkSpirit@@QAEXXZ
_TEXT	SEGMENT
_iActionType$1$ = -4					; size = 4
?ModeAttackWithMaster@CDarkSpirit@@QAEXXZ PROC		; CDarkSpirit::ModeAttackWithMaster, COMDAT
; _this$ = ecx

; 260  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx

; 261  : 	LPOBJ lpObj = &gObj[this->m_iMasterIndex];

  00004	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0000a	56		 push	 esi
  0000b	8b f1		 mov	 esi, ecx
  0000d	57		 push	 edi
  0000e	69 7e 1c 40 27
	00 00		 imul	 edi, DWORD PTR [esi+28], 10048

; 262  : 	int count = 0;
; 263  : 	int dis;
; 264  : 
; 265  : 	if ( this->m_iTargetIndex == -1 )

  00015	8b 4e 20	 mov	 ecx, DWORD PTR [esi+32]
  00018	03 fa		 add	 edi, edx
  0001a	83 f9 ff	 cmp	 ecx, -1
  0001d	0f 84 b8 00 00
	00		 je	 $LN5@ModeAttack

; 266  : 	{
; 267  : 		return;
; 268  : 	}
; 269  : 
; 270  : 	if ( lpObj->MapNumber == gObj[this->m_iTargetIndex].MapNumber )

  00023	69 c1 40 27 00
	00		 imul	 eax, ecx, 10048
  00029	03 d0		 add	 edx, eax
  0002b	8a 87 23 01 00
	00		 mov	 al, BYTE PTR [edi+291]
  00031	3a 82 23 01 00
	00		 cmp	 al, BYTE PTR [edx+291]
  00037	0f 85 9e 00 00
	00		 jne	 $LN5@ModeAttack

; 271  : 	{
; 272  : 		if ( gObj[this->m_iTargetIndex].Life > 0.0f )

  0003d	f3 0f 10 82 d8
	00 00 00	 movss	 xmm0, DWORD PTR [edx+216]
  00045	0f 2f 05 00 00
	00 00		 comiss	 xmm0, DWORD PTR __real@00000000
  0004c	0f 86 a2 00 00
	00		 jbe	 $LN4@ModeAttack

; 273  : 		{
; 274  : 			dis = gObjCalDistance(lpObj, &gObj[this->m_iTargetIndex]);

  00052	52		 push	 edx
  00053	57		 push	 edi
  00054	e8 00 00 00 00	 call	 ?gObjCalDistance@@YAHPAUOBJECTSTRUCT@@0@Z ; gObjCalDistance
  00059	83 c4 08	 add	 esp, 8

; 275  : 
; 276  : 			if ( dis < RAVEN_ATTACK_DISTANCE )

  0005c	83 f8 07	 cmp	 eax, 7
  0005f	7d 7a		 jge	 SHORT $LN5@ModeAttack

; 277  : 			{
; 278  : 				int criticaldamage = 0;
; 279  : 				int iActionType = 0;

  00061	33 c0		 xor	 eax, eax
  00063	53		 push	 ebx
  00064	33 db		 xor	 ebx, ebx
  00066	89 45 fc	 mov	 DWORD PTR _iActionType$1$[ebp], eax

; 280  : 
; 281  : 				if ( (rand()%100) < (this->m_iCriticalSuccessRate+lpObj->m_MPSkillOpt.MpsDarkSpiritStr2) )

  00069	e8 00 00 00 00	 call	 _rand
  0006e	99		 cdq
  0006f	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  00074	f7 f9		 idiv	 ecx
  00076	f3 0f 10 87 ac
	07 00 00	 movss	 xmm0, DWORD PTR [edi+1964]
  0007e	f3 0f 58 46 14	 addss	 xmm0, DWORD PTR [esi+20]
  00083	66 0f 6e ca	 movd	 xmm1, edx
  00087	0f 5b c9	 cvtdq2ps xmm1, xmm1
  0008a	0f 2f c1	 comiss	 xmm0, xmm1
  0008d	76 08		 jbe	 SHORT $LN7@ModeAttack

; 282  : 				{
; 283  : 					criticaldamage = 1;

  0008f	bb 01 00 00 00	 mov	 ebx, 1

; 284  : 					iActionType = 1;

  00094	89 5d fc	 mov	 DWORD PTR _iActionType$1$[ebp], ebx
$LN7@ModeAttack:

; 285  : 				}
; 286  : 
; 287  : 				if( (rand()%100) < (this->m_iExcelentSuccessRate+lpObj->m_MPSkillOpt.MpsDarkSpiritStr3) )

  00097	e8 00 00 00 00	 call	 _rand
  0009c	99		 cdq
  0009d	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  000a2	f7 f9		 idiv	 ecx
  000a4	f3 0f 10 87 b0
	07 00 00	 movss	 xmm0, DWORD PTR [edi+1968]
  000ac	f3 0f 58 46 18	 addss	 xmm0, DWORD PTR [esi+24]
  000b1	66 0f 6e ca	 movd	 xmm1, edx
  000b5	0f 5b c9	 cvtdq2ps xmm1, xmm1
  000b8	0f 2f c1	 comiss	 xmm0, xmm1
  000bb	76 08		 jbe	 SHORT $LN8@ModeAttack

; 288  : 				{
; 289  : 					criticaldamage = 2;

  000bd	8d 59 9e	 lea	 ebx, DWORD PTR [ecx-98]

; 290  : 					iActionType = 1;

  000c0	8d 41 9d	 lea	 eax, DWORD PTR [ecx-99]

; 291  : 				}
; 292  : 
; 293  : 				if ( criticaldamage != FALSE )

  000c3	eb 07		 jmp	 SHORT $LN12@ModeAttack
$LN8@ModeAttack:
  000c5	85 db		 test	 ebx, ebx
  000c7	74 18		 je	 SHORT $LN9@ModeAttack
  000c9	8b 45 fc	 mov	 eax, DWORD PTR _iActionType$1$[ebp]
$LN12@ModeAttack:

; 294  : 				{
; 295  : 					this->SendAttackMsg(lpObj->m_Index, this->m_iTargetIndex, criticaldamage, iActionType);

  000cc	50		 push	 eax
  000cd	53		 push	 ebx
  000ce	ff 76 20	 push	 DWORD PTR [esi+32]
  000d1	8b ce		 mov	 ecx, esi
  000d3	ff 37		 push	 DWORD PTR [edi]
  000d5	e8 00 00 00 00	 call	 ?SendAttackMsg@CDarkSpirit@@QAEXHHHH@Z ; CDarkSpirit::SendAttackMsg
  000da	5b		 pop	 ebx
$LN5@ModeAttack:
  000db	5f		 pop	 edi
  000dc	5e		 pop	 esi

; 306  : 		}
; 307  : 	}
; 308  : }

  000dd	8b e5		 mov	 esp, ebp
  000df	5d		 pop	 ebp
  000e0	c3		 ret	 0
$LN9@ModeAttack:

; 296  : 				}
; 297  : 				else
; 298  : 				{
; 299  : 					this->RangeAttack(lpObj->m_Index, this->m_iTargetIndex);

  000e1	ff 76 20	 push	 DWORD PTR [esi+32]
  000e4	8b ce		 mov	 ecx, esi
  000e6	ff 37		 push	 DWORD PTR [edi]
  000e8	e8 00 00 00 00	 call	 ?RangeAttack@CDarkSpirit@@QAEXHH@Z ; CDarkSpirit::RangeAttack
  000ed	5b		 pop	 ebx
  000ee	5f		 pop	 edi
  000ef	5e		 pop	 esi

; 306  : 		}
; 307  : 	}
; 308  : }

  000f0	8b e5		 mov	 esp, ebp
  000f2	5d		 pop	 ebp
  000f3	c3		 ret	 0
$LN4@ModeAttack:

; 300  : 				}
; 301  : 			}
; 302  : 		}
; 303  : 		else
; 304  : 		{
; 305  : 			this->ReSetTarget(this->m_iTargetIndex);

  000f4	51		 push	 ecx
  000f5	8b ce		 mov	 ecx, esi
  000f7	e8 00 00 00 00	 call	 ?ReSetTarget@CDarkSpirit@@QAEXH@Z ; CDarkSpirit::ReSetTarget
  000fc	5f		 pop	 edi
  000fd	5e		 pop	 esi

; 306  : 		}
; 307  : 	}
; 308  : }

  000fe	8b e5		 mov	 esp, ebp
  00100	5d		 pop	 ebp
  00101	c3		 ret	 0
?ModeAttackWithMaster@CDarkSpirit@@QAEXXZ ENDP		; CDarkSpirit::ModeAttackWithMaster
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
;	COMDAT ?ModeAttackRandom@CDarkSpirit@@QAEXXZ
_TEXT	SEGMENT
_EnableAttack$2$ = -336					; size = 4
_DuelIndex$1$ = -332					; size = 4
_this$GSCopy$1$ = -328					; size = 4
_iActionType$1$ = -324					; size = 4
_criticaldamage$1$ = -320				; size = 4
_lpObj$1$ = -316					; size = 4
tv534 = -312						; size = 4
_FindObjCount$1$ = -308					; size = 4
_FindObj$ = -304					; size = 300
__$ArrayPad$ = -4					; size = 4
?ModeAttackRandom@CDarkSpirit@@QAEXXZ PROC		; CDarkSpirit::ModeAttackRandom, COMDAT
; _this$ = ecx

; 137  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 50 01 00
	00		 sub	 esp, 336		; 00000150H
  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000e	33 c5		 xor	 eax, ebp
  00010	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00013	53		 push	 ebx
  00014	56		 push	 esi
  00015	57		 push	 edi
  00016	8b f9		 mov	 edi, ecx

; 138  : 	LPOBJ lpObj = &gObj[this->m_iMasterIndex];
; 139  : 	int tObjNum;
; 140  : 	int count = 0;
; 141  : 	int FindObj[MAX_VIEWPORT];
; 142  : 	int FindObjCount = 0;

  00018	33 f6		 xor	 esi, esi
  0001a	89 bd b8 fe ff
	ff		 mov	 DWORD PTR _this$GSCopy$1$[ebp], edi
  00020	89 b5 cc fe ff
	ff		 mov	 DWORD PTR _FindObjCount$1$[ebp], esi

; 143  : 	int dis;
; 144  : 	int DuelIndex = lpObj->m_iDuelUser;
; 145  : 	BOOL EnableAttack;
; 146  : 	int criticaldamage = 0;

  00026	89 b5 c0 fe ff
	ff		 mov	 DWORD PTR _criticaldamage$1$[ebp], esi
  0002c	69 5f 1c 40 27
	00 00		 imul	 ebx, DWORD PTR [edi+28], 10048

; 147  : 	int iActionType = 0;

  00033	89 b5 bc fe ff
	ff		 mov	 DWORD PTR _iActionType$1$[ebp], esi
  00039	03 1d 00 00 00
	00		 add	 ebx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0003f	89 9d c4 fe ff
	ff		 mov	 DWORD PTR _lpObj$1$[ebp], ebx
  00045	8b 83 50 12 00
	00		 mov	 eax, DWORD PTR [ebx+4688]
  0004b	89 85 b4 fe ff
	ff		 mov	 DWORD PTR _DuelIndex$1$[ebp], eax

; 148  : 
; 149  : 	if ( (rand()%100) < (this->m_iCriticalSuccessRate+lpObj->m_MPSkillOpt.MpsDarkSpiritStr2) )

  00051	e8 00 00 00 00	 call	 _rand
  00056	99		 cdq
  00057	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  0005c	f7 f9		 idiv	 ecx
  0005e	f3 0f 10 83 ac
	07 00 00	 movss	 xmm0, DWORD PTR [ebx+1964]
  00066	f3 0f 58 47 14	 addss	 xmm0, DWORD PTR [edi+20]
  0006b	66 0f 6e ca	 movd	 xmm1, edx
  0006f	0f 5b c9	 cvtdq2ps xmm1, xmm1
  00072	0f 2f c1	 comiss	 xmm0, xmm1
  00075	76 14		 jbe	 SHORT $LN4@ModeAttack

; 150  : 	{
; 151  : 		criticaldamage = 1;

  00077	c7 85 c0 fe ff
	ff 01 00 00 00	 mov	 DWORD PTR _criticaldamage$1$[ebp], 1

; 152  : 		iActionType = 1;

  00081	c7 85 bc fe ff
	ff 01 00 00 00	 mov	 DWORD PTR _iActionType$1$[ebp], 1
$LN4@ModeAttack:

; 153  : 	}
; 154  : 
; 155  : 	if( (rand()%100) < (this->m_iExcelentSuccessRate+lpObj->m_MPSkillOpt.MpsDarkSpiritStr3) )

  0008b	e8 00 00 00 00	 call	 _rand
  00090	99		 cdq
  00091	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  00096	f7 f9		 idiv	 ecx
  00098	f3 0f 10 83 b0
	07 00 00	 movss	 xmm0, DWORD PTR [ebx+1968]
  000a0	f3 0f 58 47 18	 addss	 xmm0, DWORD PTR [edi+24]
  000a5	66 0f 6e ca	 movd	 xmm1, edx
  000a9	0f 5b c9	 cvtdq2ps xmm1, xmm1
  000ac	0f 2f c1	 comiss	 xmm0, xmm1
  000af	76 14		 jbe	 SHORT $LN40@ModeAttack

; 156  : 	{
; 157  : 		criticaldamage = 2;

  000b1	c7 85 c0 fe ff
	ff 02 00 00 00	 mov	 DWORD PTR _criticaldamage$1$[ebp], 2

; 158  : 		iActionType = 1;

  000bb	c7 85 bc fe ff
	ff 01 00 00 00	 mov	 DWORD PTR _iActionType$1$[ebp], 1
$LN40@ModeAttack:

; 159  : 	}
; 160  : 
; 161  : 	while ( true )
; 162  : 	{
; 163  : 		if ( lpObj->VpPlayer2[count].state != 0 )

  000c5	ba 4b 00 00 00	 mov	 edx, 75			; 0000004bH
  000ca	8d bb 4c 0c 00
	00		 lea	 edi, DWORD PTR [ebx+3148]
  000d0	89 95 c8 fe ff
	ff		 mov	 DWORD PTR tv534[ebp], edx
  000d6	0f 57 c9	 xorps	 xmm1, xmm1
  000d9	0f 1f 80 00 00
	00 00		 npad	 7
$LL2@ModeAttack:
  000e0	80 7f fc 00	 cmp	 BYTE PTR [edi-4], 0
  000e4	0f 84 40 01 00
	00		 je	 $LN42@ModeAttack

; 164  : 		{
; 165  : 			if ( lpObj->VpPlayer2[count].type == OBJ_MONSTER )

  000ea	80 3f 02	 cmp	 BYTE PTR [edi], 2
  000ed	0f 85 37 01 00
	00		 jne	 $LN42@ModeAttack

; 166  : 			{
; 167  : 				tObjNum = lpObj->VpPlayer2[count].number;

  000f3	0f bf 5f fe	 movsx	 ebx, WORD PTR [edi-2]

; 168  : 
; 169  : 				if ( tObjNum >= 0 )

  000f7	85 db		 test	 ebx, ebx
  000f9	0f 88 2b 01 00
	00		 js	 $LN42@ModeAttack

; 170  : 				{
; 171  : 					EnableAttack = FALSE;
; 172  : 
; 173  : 					if ( gObj[tObjNum].Life > 0.0f && (gObj[tObjNum].Class < 100 || gObj[tObjNum].Class  > 110 ) )

  000ff	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00104	69 f3 40 27 00
	00		 imul	 esi, ebx, 10048
  0010a	c7 85 b0 fe ff
	ff 00 00 00 00	 mov	 DWORD PTR _EnableAttack$2$[ebp], 0
  00114	f3 0f 10 84 06
	d8 00 00 00	 movss	 xmm0, DWORD PTR [esi+eax+216]
  0011d	0f 2f c1	 comiss	 xmm0, xmm1
  00120	0f 86 fe 00 00
	00		 jbe	 $LN44@ModeAttack
  00126	0f b7 8c 06 90
	00 00 00	 movzx	 ecx, WORD PTR [esi+eax+144]
  0012e	83 f9 64	 cmp	 ecx, 100		; 00000064H
  00131	72 09		 jb	 SHORT $LN10@ModeAttack
  00133	83 f9 6e	 cmp	 ecx, 110		; 0000006eH
  00136	0f 86 e8 00 00
	00		 jbe	 $LN44@ModeAttack
$LN10@ModeAttack:

; 174  : 					{
; 175  : 						if ( lpObj->VpPlayer2[count].type == OBJ_MONSTER && gObj[tObjNum].m_RecallMon < 0)

  0013c	8b 8c 06 30 06
	00 00		 mov	 ecx, DWORD PTR [esi+eax+1584]
  00143	85 c9		 test	 ecx, ecx
  00145	0f 88 8c 00 00
	00		 js	 $LN39@ModeAttack

; 176  : 						{
; 177  : 							EnableAttack = TRUE;
; 178  : 						}
; 179  : 						else if ( DuelIndex == tObjNum )

  0014b	39 9d b4 fe ff
	ff		 cmp	 DWORD PTR _DuelIndex$1$[ebp], ebx
  00151	0f 84 80 00 00
	00		 je	 $LN39@ModeAttack

; 180  : 						{
; 181  : 							EnableAttack = TRUE;
; 182  : 						}
; 183  : 						else
; 184  : 						{
; 185  : 							int lc85 = gObj[tObjNum].m_Index;
; 186  : 
; 187  : 							if ( gObj[tObjNum].Type == OBJ_MONSTER )

  00157	80 7c 06 50 02	 cmp	 BYTE PTR [esi+eax+80], 2
  0015c	8b 14 06	 mov	 edx, DWORD PTR [esi+eax]
  0015f	75 12		 jne	 SHORT $LN16@ModeAttack

; 188  : 							{
; 189  : 								if ( gObj[tObjNum].m_RecallMon >= 0 )

  00161	85 c9		 test	 ecx, ecx
  00163	78 0e		 js	 SHORT $LN16@ModeAttack

; 190  : 								{
; 191  : 									lc85 = gObj[gObj[tObjNum].m_RecallMon].m_Index; 

  00165	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0016a	69 c9 40 27 00
	00		 imul	 ecx, ecx, 10048
  00170	8b 14 01	 mov	 edx, DWORD PTR [ecx+eax]
$LN16@ModeAttack:

; 192  : 								}
; 193  : 							}
; 194  : 
; 195  : 							if ( gObjTargetGuildWarCheck(lpObj, &gObj[lc85]) == TRUE )

  00173	69 c2 40 27 00
	00		 imul	 eax, edx, 10048
  00179	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0017f	50		 push	 eax
  00180	ff b5 c4 fe ff
	ff		 push	 DWORD PTR _lpObj$1$[ebp]
  00186	e8 00 00 00 00	 call	 ?gObjTargetGuildWarCheck@@YAHPAUOBJECTSTRUCT@@0@Z ; gObjTargetGuildWarCheck

; 196  : 							{
; 197  : 								EnableAttack = TRUE;
; 198  : 							}
; 199  : 
; 200  : 							if ( IF_MAP_RANGE(gObj[tObjNum].MapNumber) )

  0018b	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00191	83 c4 08	 add	 esp, 8
  00194	8b 95 b0 fe ff
	ff		 mov	 edx, DWORD PTR _EnableAttack$2$[ebp]
  0019a	83 f8 01	 cmp	 eax, 1
  0019d	b8 01 00 00 00	 mov	 eax, 1
  001a2	0f 44 d0	 cmove	 edx, eax
  001a5	8a 84 0e 23 01
	00 00		 mov	 al, BYTE PTR [esi+ecx+291]
  001ac	3c 45		 cmp	 al, 69			; 00000045H
  001ae	72 23		 jb	 SHORT $LN20@ModeAttack
  001b0	b4 48		 mov	 ah, 72			; 00000048H
  001b2	3a e0		 cmp	 ah, al
  001b4	1b c0		 sbb	 eax, eax
  001b6	83 c0 01	 add	 eax, 1
  001b9	74 18		 je	 SHORT $LN20@ModeAttack

; 201  : 							{
; 202  : 								if( gObj[tObjNum].Live && g_ImperialGuardian.IsAttackAbleMonster(gObj[tObjNum].m_Index) )

  001bb	80 7c 0e 51 00	 cmp	 BYTE PTR [esi+ecx+81], 0
  001c0	74 5c		 je	 SHORT $LN48@ModeAttack
  001c2	ff 34 0e	 push	 DWORD PTR [esi+ecx]
  001c5	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_ImperialGuardian@@3VCImperialGuardian@@A ; g_ImperialGuardian
  001ca	e8 00 00 00 00	 call	 ?IsAttackAbleMonster@CImperialGuardian@@QAE_NH@Z ; CImperialGuardian::IsAttackAbleMonster
  001cf	84 c0		 test	 al, al
  001d1	eb 02		 jmp	 SHORT $LN51@ModeAttack
$LN20@ModeAttack:

; 203  : 								{
; 204  : 									EnableAttack = TRUE;
; 205  : 								}
; 206  : 								else
; 207  : 								{
; 208  : 									EnableAttack = FALSE;
; 209  : 								}
; 210  : 							}
; 211  : 						}
; 212  : 
; 213  : 						if ( EnableAttack != FALSE )

  001d3	85 d2		 test	 edx, edx
$LN51@ModeAttack:
  001d5	74 47		 je	 SHORT $LN48@ModeAttack
$LN39@ModeAttack:

; 214  : 						{
; 215  : 							if ( lpObj->MapNumber == gObj[tObjNum].MapNumber )

  001d7	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  001dd	8b 95 c4 fe ff
	ff		 mov	 edx, DWORD PTR _lpObj$1$[ebp]
  001e3	03 ce		 add	 ecx, esi
  001e5	8a 82 23 01 00
	00		 mov	 al, BYTE PTR [edx+291]
  001eb	3a 81 23 01 00
	00		 cmp	 al, BYTE PTR [ecx+291]
  001f1	75 2b		 jne	 SHORT $LN48@ModeAttack

; 216  : 							{
; 217  : 								dis = gObjCalDistance(lpObj, &gObj[tObjNum]);

  001f3	51		 push	 ecx
  001f4	52		 push	 edx
  001f5	e8 00 00 00 00	 call	 ?gObjCalDistance@@YAHPAUOBJECTSTRUCT@@0@Z ; gObjCalDistance

; 218  : 
; 219  : 								if ( dis < RAVEN_ATTACK_DISTANCE-2 )
; 220  : 								{
; 221  : 									FindObj[FindObjCount] = tObjNum;

  001fa	8b b5 cc fe ff
	ff		 mov	 esi, DWORD PTR _FindObjCount$1$[ebp]
  00200	83 c4 08	 add	 esp, 8

; 222  : 									FindObjCount++;

  00203	8b 95 c8 fe ff
	ff		 mov	 edx, DWORD PTR tv534[ebp]
  00209	83 f8 05	 cmp	 eax, 5
  0020c	7d 1c		 jge	 SHORT $LN42@ModeAttack
  0020e	89 9c b5 d0 fe
	ff ff		 mov	 DWORD PTR _FindObj$[ebp+esi*4], ebx
  00215	46		 inc	 esi
  00216	89 b5 cc fe ff
	ff		 mov	 DWORD PTR _FindObjCount$1$[ebp], esi
  0021c	eb 0c		 jmp	 SHORT $LN42@ModeAttack
$LN48@ModeAttack:
  0021e	8b 95 c8 fe ff
	ff		 mov	 edx, DWORD PTR tv534[ebp]
$LN44@ModeAttack:
  00224	8b b5 cc fe ff
	ff		 mov	 esi, DWORD PTR _FindObjCount$1$[ebp]
$LN42@ModeAttack:

; 223  : 								}
; 224  : 							}
; 225  : 						}
; 226  : 					}
; 227  : 				}
; 228  : 			}
; 229  : 		}
; 230  : 
; 231  : 		count++;

  0022a	83 c7 0c	 add	 edi, 12			; 0000000cH
  0022d	0f 57 c9	 xorps	 xmm1, xmm1

; 232  : 
; 233  : 		if ( count > MAX_VIEWPORT-1 )

  00230	83 ea 01	 sub	 edx, 1
  00233	89 95 c8 fe ff
	ff		 mov	 DWORD PTR tv534[ebp], edx
  00239	0f 85 a1 fe ff
	ff		 jne	 $LL2@ModeAttack

; 234  : 		{
; 235  : 			break;
; 236  : 		}
; 237  : 	}
; 238  : 
; 239  : 	if ( FindObjCount != 0 )

  0023f	85 f6		 test	 esi, esi
  00241	74 53		 je	 SHORT $LN27@ModeAttack

; 240  : 	{
; 241  : 		if ( criticaldamage != 0 )

  00243	8b bd c0 fe ff
	ff		 mov	 edi, DWORD PTR _criticaldamage$1$[ebp]

; 242  : 		{
; 243  : 			int target = FindObj[rand()%FindObjCount];

  00249	e8 00 00 00 00	 call	 _rand
  0024e	99		 cdq
  0024f	f7 fe		 idiv	 esi

; 244  : 			this->SendAttackMsg( lpObj->m_Index, target, criticaldamage, iActionType);

  00251	8b 8d b8 fe ff
	ff		 mov	 ecx, DWORD PTR _this$GSCopy$1$[ebp]
  00257	8b 84 95 d0 fe
	ff ff		 mov	 eax, DWORD PTR _FindObj$[ebp+edx*4]
  0025e	85 ff		 test	 edi, edi
  00260	74 26		 je	 SHORT $LN26@ModeAttack
  00262	ff b5 bc fe ff
	ff		 push	 DWORD PTR _iActionType$1$[ebp]
  00268	57		 push	 edi
  00269	50		 push	 eax
  0026a	8b 85 c4 fe ff
	ff		 mov	 eax, DWORD PTR _lpObj$1$[ebp]
  00270	ff 30		 push	 DWORD PTR [eax]
  00272	e8 00 00 00 00	 call	 ?SendAttackMsg@CDarkSpirit@@QAEXHHHH@Z ; CDarkSpirit::SendAttackMsg
  00277	5f		 pop	 edi
  00278	5e		 pop	 esi
  00279	5b		 pop	 ebx

; 250  : 		}
; 251  : 	}
; 252  : }

  0027a	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  0027d	33 cd		 xor	 ecx, ebp
  0027f	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00284	8b e5		 mov	 esp, ebp
  00286	5d		 pop	 ebp
  00287	c3		 ret	 0
$LN26@ModeAttack:

; 245  : 		}
; 246  : 		else
; 247  : 		{
; 248  : 			int target = FindObj[rand()%FindObjCount];
; 249  : 			this->RangeAttack( lpObj->m_Index, target);

  00288	50		 push	 eax
  00289	8b 85 c4 fe ff
	ff		 mov	 eax, DWORD PTR _lpObj$1$[ebp]
  0028f	ff 30		 push	 DWORD PTR [eax]
  00291	e8 00 00 00 00	 call	 ?RangeAttack@CDarkSpirit@@QAEXHH@Z ; CDarkSpirit::RangeAttack
$LN27@ModeAttack:

; 250  : 		}
; 251  : 	}
; 252  : }

  00296	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  00299	5f		 pop	 edi
  0029a	5e		 pop	 esi
  0029b	33 cd		 xor	 ecx, ebp
  0029d	5b		 pop	 ebx
  0029e	e8 00 00 00 00	 call	 @__security_check_cookie@4
  002a3	8b e5		 mov	 esp, ebp
  002a5	5d		 pop	 ebp
  002a6	c3		 ret	 0
?ModeAttackRandom@CDarkSpirit@@QAEXXZ ENDP		; CDarkSpirit::ModeAttackRandom
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
;	COMDAT ?ModeNormal@CDarkSpirit@@QAEXXZ
_TEXT	SEGMENT
?ModeNormal@CDarkSpirit@@QAEXXZ PROC			; CDarkSpirit::ModeNormal, COMDAT
; _this$ = ecx

; 130  : 	LPOBJ lpObj = &gObj[this->m_iMasterIndex];
; 131  : }

  00000	c3		 ret	 0
?ModeNormal@CDarkSpirit@@QAEXXZ ENDP			; CDarkSpirit::ModeNormal
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
;	COMDAT ?Run@CDarkSpirit@@QAEXXZ
_TEXT	SEGMENT
?Run@CDarkSpirit@@QAEXXZ PROC				; CDarkSpirit::Run, COMDAT
; _this$ = ecx

; 67   : {

  00000	56		 push	 esi
  00001	8b f1		 mov	 esi, ecx

; 68   : 	if ( this->m_iMasterIndex == -1 )

  00003	8b 46 1c	 mov	 eax, DWORD PTR [esi+28]
  00006	83 f8 ff	 cmp	 eax, -1
  00009	0f 84 9f 00 00
	00		 je	 $LN2@Run

; 69   : 	{
; 70   : 		return;
; 71   : 	}
; 72   : 
; 73   : 	LPOBJ lpObj = &gObj[this->m_iMasterIndex];

  0000f	69 c8 40 27 00
	00		 imul	 ecx, eax, 10048
  00015	03 0d 00 00 00
	00		 add	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj

; 74   : 
; 75   : 	if ( lpObj->Class != 4 ) // dl

  0001b	66 83 b9 90 00
	00 00 04	 cmp	 WORD PTR [ecx+144], 4
  00023	0f 85 85 00 00
	00		 jne	 $LN2@Run

; 76   : 	{
; 77   : 		return;
; 78   : 	}
; 79   : 
; 80   : 	if ( this->m_pPetItem == NULL )

  00029	8b 46 2c	 mov	 eax, DWORD PTR [esi+44]
  0002c	85 c0		 test	 eax, eax
  0002e	74 7e		 je	 SHORT $LN2@Run

; 81   : 	{
; 82   : 		return;
; 83   : 	}
; 84   : 
; 85   : 	if ( this->m_pPetItem->m_Durability <= 0.0f )

  00030	0f 57 c0	 xorps	 xmm0, xmm0
  00033	0f 2f 40 24	 comiss	 xmm0, DWORD PTR [eax+36]
  00037	73 75		 jae	 SHORT $LN2@Run

; 86   : 	{
; 87   : 		return;
; 88   : 	}
; 89   : 
; 90   : 	BYTE attr = MapC[lpObj->MapNumber].GetAttr(lpObj->X, lpObj->Y);

  00039	0f b6 81 21 01
	00 00		 movzx	 eax, BYTE PTR [ecx+289]
  00040	50		 push	 eax
  00041	0f b6 81 20 01
	00 00		 movzx	 eax, BYTE PTR [ecx+288]
  00048	50		 push	 eax
  00049	0f b6 81 23 01
	00 00		 movzx	 eax, BYTE PTR [ecx+291]
  00050	69 c8 28 38 05
	00		 imul	 ecx, eax, 342056
  00056	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?MapC@@3PAVMapClass@@A ; MapC
  0005c	e8 00 00 00 00	 call	 ?GetAttr@MapClass@@QAEEHH@Z ; MapClass::GetAttr

; 91   : 
; 92   : 	if ( (attr&1) != 0 )

  00061	a8 01		 test	 al, 1
  00063	75 49		 jne	 SHORT $LN2@Run

; 93   : 	{
; 94   : 		return;
; 95   : 	}
; 96   : 
; 97   : 	if ( this->m_dwLastAttackTime > GetTickCount() )

  00065	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetTickCount@0
  0006b	39 46 24	 cmp	 DWORD PTR [esi+36], eax
  0006e	77 3e		 ja	 SHORT $LN2@Run

; 98   : 	{
; 99   : 		return;
; 100  : 	}
; 101  : 
; 102  : 	this->m_dwLastAttackTime = ( GetTickCount() + 1500 ) - ( this->m_AttackSpeed * 10 );

  00070	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetTickCount@0
  00076	b9 96 00 00 00	 mov	 ecx, 150		; 00000096H
  0007b	2b 4e 0c	 sub	 ecx, DWORD PTR [esi+12]
  0007e	8d 0c 89	 lea	 ecx, DWORD PTR [ecx+ecx*4]
  00081	8d 04 48	 lea	 eax, DWORD PTR [eax+ecx*2]
  00084	89 46 24	 mov	 DWORD PTR [esi+36], eax

; 103  : 
; 104  : 	switch ( this->m_ActionMode )

  00087	8b 46 28	 mov	 eax, DWORD PTR [esi+40]
  0008a	83 f8 03	 cmp	 eax, 3
  0008d	77 1f		 ja	 SHORT $LN2@Run
  0008f	ff 24 85 00 00
	00 00		 jmp	 DWORD PTR $LN18@Run[eax*4]
$LN11@Run:

; 105  : 	{
; 106  : 		case PetItem_Mode_Normal:
; 107  : 			this->ModeNormal();
; 108  : 			break;
; 109  : 
; 110  : 		case PetItem_Mode_Attack_Random:
; 111  : 			this->ModeAttackRandom();

  00096	8b ce		 mov	 ecx, esi
  00098	5e		 pop	 esi
  00099	e9 00 00 00 00	 jmp	 ?ModeAttackRandom@CDarkSpirit@@QAEXXZ ; CDarkSpirit::ModeAttackRandom
$LN12@Run:

; 112  : 			break;
; 113  : 
; 114  : 		case PetItem_Mode_Attack_WithMaster:
; 115  : 			this->ModeAttackWithMaster();

  0009e	8b ce		 mov	 ecx, esi
  000a0	5e		 pop	 esi
  000a1	e9 00 00 00 00	 jmp	 ?ModeAttackWithMaster@CDarkSpirit@@QAEXXZ ; CDarkSpirit::ModeAttackWithMaster
$LN13@Run:

; 116  : 			break;
; 117  : 
; 118  : 		case PetItem_Mode_Attack_Target:
; 119  : 			this->ModeAttakTarget();

  000a6	8b ce		 mov	 ecx, esi
  000a8	5e		 pop	 esi
  000a9	e9 00 00 00 00	 jmp	 ?ModeAttakTarget@CDarkSpirit@@QAEXXZ ; CDarkSpirit::ModeAttakTarget
$LN2@Run:
  000ae	5e		 pop	 esi

; 120  : 			break;
; 121  : 	}
; 122  : }

  000af	c3		 ret	 0
$LN18@Run:
  000b0	00 00 00 00	 DD	 $LN2@Run
  000b4	00 00 00 00	 DD	 $LN11@Run
  000b8	00 00 00 00	 DD	 $LN12@Run
  000bc	00 00 00 00	 DD	 $LN13@Run
?Run@CDarkSpirit@@QAEXXZ ENDP				; CDarkSpirit::Run
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
;	COMDAT ?Init@CDarkSpirit@@QAEXXZ
_TEXT	SEGMENT
?Init@CDarkSpirit@@QAEXXZ PROC				; CDarkSpirit::Init, COMDAT
; _this$ = ecx

; 52   : 	this->m_AttackDamageMin = 0;

  00000	c7 41 04 00 00
	00 00		 mov	 DWORD PTR [ecx+4], 0

; 53   : 	this->m_AttackDamageMax = 0;

  00007	c7 41 08 00 00
	00 00		 mov	 DWORD PTR [ecx+8], 0

; 54   : 	this->m_AttackSpeed = 0;

  0000e	c7 41 0c 00 00
	00 00		 mov	 DWORD PTR [ecx+12], 0

; 55   : 	this->m_SuccessAttackRate = 0;

  00015	c7 41 10 00 00
	00 00		 mov	 DWORD PTR [ecx+16], 0

; 56   : 	this->m_dwLastAttackTime = 0;

  0001c	c7 41 24 00 00
	00 00		 mov	 DWORD PTR [ecx+36], 0

; 57   : 	this->m_iMasterIndex = -1;

  00023	c7 41 1c ff ff
	ff ff		 mov	 DWORD PTR [ecx+28], -1

; 58   : 	this->m_iTargetIndex = -1;

  0002a	c7 41 20 ff ff
	ff ff		 mov	 DWORD PTR [ecx+32], -1

; 59   : 	this->m_pPetItem = NULL;

  00031	c7 41 2c 00 00
	00 00		 mov	 DWORD PTR [ecx+44], 0

; 60   : }

  00038	c3		 ret	 0
?Init@CDarkSpirit@@QAEXXZ ENDP				; CDarkSpirit::Init
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
;	COMDAT ??1CDarkSpirit@@UAE@XZ
_TEXT	SEGMENT
??1CDarkSpirit@@UAE@XZ PROC				; CDarkSpirit::~CDarkSpirit, COMDAT
; _this$ = ecx

; 42   : {

  00000	c7 01 00 00 00
	00		 mov	 DWORD PTR [ecx], OFFSET ??_7CDarkSpirit@@6B@

; 43   : 	return;
; 44   : }

  00006	e9 00 00 00 00	 jmp	 ??1CObjBaseAttack@@UAE@XZ ; CObjBaseAttack::~CObjBaseAttack
??1CDarkSpirit@@UAE@XZ ENDP				; CDarkSpirit::~CDarkSpirit
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
;	COMDAT ??0CDarkSpirit@@QAE@XZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
??0CDarkSpirit@@QAE@XZ PROC				; CDarkSpirit::CDarkSpirit, COMDAT
; _this$ = ecx

; 33   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	56		 push	 esi
  00005	8b f1		 mov	 esi, ecx
  00007	89 75 fc	 mov	 DWORD PTR _this$[ebp], esi
  0000a	e8 00 00 00 00	 call	 ??0CObjBaseAttack@@QAE@XZ ; CObjBaseAttack::CObjBaseAttack

; 34   : 	this->Init();

  0000f	8b ce		 mov	 ecx, esi
  00011	c7 06 00 00 00
	00		 mov	 DWORD PTR [esi], OFFSET ??_7CDarkSpirit@@6B@
  00017	c7 46 28 00 00
	00 00		 mov	 DWORD PTR [esi+40], 0
  0001e	e8 00 00 00 00	 call	 ?Init@CDarkSpirit@@QAEXXZ ; CDarkSpirit::Init

; 35   : }

  00023	8b c6		 mov	 eax, esi
  00025	5e		 pop	 esi
  00026	8b e5		 mov	 esp, ebp
  00028	5d		 pop	 ebp
  00029	c3		 ret	 0
??0CDarkSpirit@@QAE@XZ ENDP				; CDarkSpirit::CDarkSpirit
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\include\prodef.h
;	COMDAT ?set@PBMSG_HEAD@@QAEXPAEEE@Z
_TEXT	SEGMENT
_lpBuf$ = 8						; size = 4
_head$ = 12						; size = 1
_size$ = 16						; size = 1
?set@PBMSG_HEAD@@QAEXPAEEE@Z PROC			; PBMSG_HEAD::set, COMDAT
; _this$ = ecx

; 85   : 	{

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 86   : 		lpBuf[0] = 0xC1;

  00003	8b 4d 08	 mov	 ecx, DWORD PTR _lpBuf$[ebp]

; 87   : 		lpBuf[1] = size;

  00006	8a 45 10	 mov	 al, BYTE PTR _size$[ebp]
  00009	88 41 01	 mov	 BYTE PTR [ecx+1], al

; 88   : 		lpBuf[2] = head;

  0000c	8a 45 0c	 mov	 al, BYTE PTR _head$[ebp]
  0000f	c6 01 c1	 mov	 BYTE PTR [ecx], 193	; 000000c1H
  00012	88 41 02	 mov	 BYTE PTR [ecx+2], al

; 89   : 	};	// line : 22

  00015	5d		 pop	 ebp
  00016	c2 0c 00	 ret	 12			; 0000000cH
?set@PBMSG_HEAD@@QAEXPAEEE@Z ENDP			; PBMSG_HEAD::set
_TEXT	ENDS
; Function compile flags: /Ogtp
;	COMDAT ??_EOBJECTSTRUCT@@QAEPAXI@Z
_TEXT	SEGMENT
__$EHRec$ = -12						; size = 12
___flags$ = 8						; size = 4
??_EOBJECTSTRUCT@@QAEPAXI@Z PROC			; OBJECTSTRUCT::`vector deleting destructor', COMDAT
; _this$ = ecx
  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	6a ff		 push	 -1
  00005	68 00 00 00 00	 push	 __ehhandler$??_EOBJECTSTRUCT@@QAEPAXI@Z
  0000a	64 a1 00 00 00
	00		 mov	 eax, DWORD PTR fs:0
  00010	50		 push	 eax
  00011	53		 push	 ebx
  00012	56		 push	 esi
  00013	57		 push	 edi
  00014	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  00019	33 c5		 xor	 eax, ebp
  0001b	50		 push	 eax
  0001c	8d 45 f4	 lea	 eax, DWORD PTR __$EHRec$[ebp]
  0001f	64 a3 00 00 00
	00		 mov	 DWORD PTR fs:0, eax
  00025	8b f1		 mov	 esi, ecx
  00027	8b 5d 08	 mov	 ebx, DWORD PTR ___flags$[ebp]
  0002a	f6 c3 02	 test	 bl, 2
  0002d	74 44		 je	 SHORT $LN2@vector
  0002f	68 00 00 00 00	 push	 OFFSET ??1OBJECTSTRUCT@@QAE@XZ
  00034	ff 76 fc	 push	 DWORD PTR [esi-4]
  00037	8d 7e fc	 lea	 edi, DWORD PTR [esi-4]
  0003a	68 40 27 00 00	 push	 10048			; 00002740H
  0003f	56		 push	 esi
  00040	e8 00 00 00 00	 call	 ??_M@YGXPAXIIP6EX0@Z@Z
  00045	f6 c3 01	 test	 bl, 1
  00048	74 13		 je	 SHORT $LN3@vector
  0004a	69 0f 40 27 00
	00		 imul	 ecx, DWORD PTR [edi], 10048
  00050	83 c1 04	 add	 ecx, 4
  00053	51		 push	 ecx
  00054	57		 push	 edi
  00055	e8 00 00 00 00	 call	 ??_V@YAXPAXI@Z		; operator delete[]
  0005a	83 c4 08	 add	 esp, 8
$LN3@vector:
  0005d	8b c7		 mov	 eax, edi
  0005f	8b 4d f4	 mov	 ecx, DWORD PTR __$EHRec$[ebp]
  00062	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  00069	59		 pop	 ecx
  0006a	5f		 pop	 edi
  0006b	5e		 pop	 esi
  0006c	5b		 pop	 ebx
  0006d	8b e5		 mov	 esp, ebp
  0006f	5d		 pop	 ebp
  00070	c2 04 00	 ret	 4
$LN2@vector:
  00073	8d 8e ec 20 00
	00		 lea	 ecx, DWORD PTR [esi+8428]
  00079	e8 00 00 00 00	 call	 ??1TMonsterAIAgro@@UAE@XZ ; TMonsterAIAgro::~TMonsterAIAgro
  0007e	8d 8e 0c 16 00
	00		 lea	 ecx, DWORD PTR [esi+5644]
  00084	e8 00 00 00 00	 call	 ??1CSkillDelay@@UAE@XZ	; CSkillDelay::~CSkillDelay
  00089	f6 c3 01	 test	 bl, 1
  0008c	74 0e		 je	 SHORT $LN4@vector
  0008e	68 40 27 00 00	 push	 10048			; 00002740H
  00093	56		 push	 esi
  00094	e8 00 00 00 00	 call	 ??3@YAXPAXI@Z		; operator delete
  00099	83 c4 08	 add	 esp, 8
$LN4@vector:
  0009c	8b c6		 mov	 eax, esi
  0009e	8b 4d f4	 mov	 ecx, DWORD PTR __$EHRec$[ebp]
  000a1	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  000a8	59		 pop	 ecx
  000a9	5f		 pop	 edi
  000aa	5e		 pop	 esi
  000ab	5b		 pop	 ebx
  000ac	8b e5		 mov	 esp, ebp
  000ae	5d		 pop	 ebp
  000af	c2 04 00	 ret	 4
_TEXT	ENDS
;	COMDAT text$x
text$x	SEGMENT
__ehhandler$??_EOBJECTSTRUCT@@QAEPAXI@Z:
  00000	8b 54 24 08	 mov	 edx, DWORD PTR [esp+8]
  00004	8d 42 0c	 lea	 eax, DWORD PTR [edx+12]
  00007	8b 4a f0	 mov	 ecx, DWORD PTR [edx-16]
  0000a	33 c8		 xor	 ecx, eax
  0000c	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00011	b8 00 00 00 00	 mov	 eax, OFFSET __ehfuncinfo$??_EOBJECTSTRUCT@@QAEPAXI@Z
  00016	e9 00 00 00 00	 jmp	 ___CxxFrameHandler3
text$x	ENDS
??_EOBJECTSTRUCT@@QAEPAXI@Z ENDP			; OBJECTSTRUCT::`vector deleting destructor'
; Function compile flags: /Ogtp
;	COMDAT ??1OBJECTSTRUCT@@QAE@XZ
_TEXT	SEGMENT
??1OBJECTSTRUCT@@QAE@XZ PROC				; OBJECTSTRUCT::~OBJECTSTRUCT, COMDAT
; _this$ = ecx
  00000	56		 push	 esi
  00001	8b f1		 mov	 esi, ecx
  00003	8d 8e ec 20 00
	00		 lea	 ecx, DWORD PTR [esi+8428]
  00009	e8 00 00 00 00	 call	 ??1TMonsterAIAgro@@UAE@XZ ; TMonsterAIAgro::~TMonsterAIAgro
  0000e	8d 8e 0c 16 00
	00		 lea	 ecx, DWORD PTR [esi+5644]
  00014	5e		 pop	 esi
  00015	e9 00 00 00 00	 jmp	 ??1CSkillDelay@@UAE@XZ	; CSkillDelay::~CSkillDelay
??1OBJECTSTRUCT@@QAE@XZ ENDP				; OBJECTSTRUCT::~OBJECTSTRUCT
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\guildclass.h
;	COMDAT ?GetFriendlyFire@CGensSystem@@QAEHXZ
_TEXT	SEGMENT
?GetFriendlyFire@CGensSystem@@QAEHXZ PROC		; CGensSystem::GetFriendlyFire, COMDAT
; _this$ = ecx

; 276  : 	int GetFriendlyFire(){ return this->m_FriendlyFire; };

  00000	0f b6 41 38	 movzx	 eax, BYTE PTR [ecx+56]
  00004	c3		 ret	 0
?GetFriendlyFire@CGensSystem@@QAEHXZ ENDP		; CGensSystem::GetFriendlyFire
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
;	COMDAT ?__empty_global_delete@@YAXPAXI@Z
_TEXT	SEGMENT
___formal$ = 8						; size = 4
___formal$ = 12						; size = 4
?__empty_global_delete@@YAXPAXI@Z PROC			; __empty_global_delete, COMDAT

  00000	c3		 ret	 0
?__empty_global_delete@@YAXPAXI@Z ENDP			; __empty_global_delete
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\michel\desktop\source\gameserver\source\darkspirit.cpp
;	COMDAT ?__empty_global_delete@@YAXPAX@Z
_TEXT	SEGMENT
___formal$ = 8						; size = 4
?__empty_global_delete@@YAXPAX@Z PROC			; __empty_global_delete, COMDAT

  00000	c3		 ret	 0
?__empty_global_delete@@YAXPAX@Z ENDP			; __empty_global_delete
_TEXT	ENDS
; Function compile flags: /Ogtp
;	COMDAT ??_H@YGXPAXIIP6EPAX0@Z@Z
_TEXT	SEGMENT
___t$ = 8						; size = 4
___s$ = 12						; size = 4
___n$ = 16						; size = 4
___f$ = 20						; size = 4
??_H@YGXPAXIIP6EPAX0@Z@Z PROC				; `vector constructor iterator', COMDAT
  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	56		 push	 esi
  00004	8b 75 10	 mov	 esi, DWORD PTR ___n$[ebp]
  00007	85 f6		 test	 esi, esi
  00009	74 16		 je	 SHORT $LN6@vector
  0000b	53		 push	 ebx
  0000c	8b 5d 14	 mov	 ebx, DWORD PTR ___f$[ebp]
  0000f	57		 push	 edi
  00010	8b 7d 08	 mov	 edi, DWORD PTR ___t$[ebp]
$LL2@vector:
  00013	8b cf		 mov	 ecx, edi
  00015	ff d3		 call	 ebx
  00017	03 7d 0c	 add	 edi, DWORD PTR ___s$[ebp]
  0001a	83 ee 01	 sub	 esi, 1
  0001d	75 f4		 jne	 SHORT $LL2@vector
  0001f	5f		 pop	 edi
  00020	5b		 pop	 ebx
$LN6@vector:
  00021	5e		 pop	 esi
  00022	5d		 pop	 ebp
  00023	c2 10 00	 ret	 16			; 00000010H
??_H@YGXPAXIIP6EPAX0@Z@Z ENDP				; `vector constructor iterator'
_TEXT	ENDS
END
